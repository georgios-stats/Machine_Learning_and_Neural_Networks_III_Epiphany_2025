<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta name="generator" content="LyX 2.4.1" />
<title>LyX Document</title>
<style>
/* Layout-provided Styles */
div.standard {
text-align: left;

}
div.plain_layout {
text-align: left;

}
h3.subsection_ {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ol.enumi   { list-style-type: decimal; }
ol.enumii  { list-style-type: lower-latin; }
ol.enumiii { list-style-type: lower-roman; }
ol.enumiv  { list-style-type: upper-latin; }
h2.section {
font-weight: normal;
font-style: normal;
font-variant: small-caps;
font-size: medium;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.theorem {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.theorem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.note {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.note_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.problem {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.problem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.algorithm {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.algorithm_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
h4.subsubsection_ {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.4ex;
text-align: left;

}
div.condition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.condition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.Shadowbox { border: solid gray medium; border-bottom: solid black 1ex; border-right: solid black 1ex; padding: 0.5ex; }
div.Boxed {
	border: solid thick black;
	padding: 0.5ex;
}
div.marginal {
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
	background-color: #F0F0F0;
	float:right;
	font-size: small;
	font-weight: normal;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
span.foot_label {
	vertical-align: super;
	font-size: smaller;
	font-weight: bold;
	text-decoration: underline;
}
div.foot {
	display: inline;
	font-size: small;
	font-weight: normal;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
div.foot_inner { display: none; }
div.foot:hover div.foot_inner {
	display: block;
	border: 1px double black;
	margin: 0em 1em;
	padding: 1em;
}
span.flex_url {
font-family: monospace;
}
div.float {
	border: 2px solid black;
	text-align: center;
}
div.float-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}


</style>
</head>
<body dir="auto">
<div class='standard' id='magicparlabel-1'><div class='Shadowbox'>

<div class='plain_layout' id='magicparlabel-10'>Machine Learning and Neural Networks (MATH3431)&#xA0;&#xA0;
Epiphany term, 2024<div style='height:3ex'></div></div>

<div class='plain_layout' style='text-align: center;' id='magicparlabel-11'> Handout <a href="#enu_Handout___Bayesian">enu:Handout-:-Bayesian</a>: Bayesian Learning via 
<br />
Stochastic gradient and 
<br />
Stochastic gradient Langevin dynamics <div style='height:3ex'></div></div>

<div class='plain_layout' id='magicparlabel-20'>Lecturer &amp; author: Georgios P. Karagiannis 
<a href="mailto:georgios.karagiannis@durham.ac.uk">georgios.karagiannis@durham.ac.uk</a></div>

<div class='plain_layout' id='magicparlabel-21'><hr />
<div style='height:3ex'></div></div>
<h3 class='subsection_' id='magicparlabel-22'>Aim</h3>
<div class='plain_layout' id='magicparlabel-23'>To introduce the Bayesian Learning, and Stochastic gradient Langevin dynamics (description, heuristics, and implementation). Stochastic gradient descent will be implemented in the Bayesian learning too. </div>

<div class='plain_layout' id='magicparlabel-24'><hr />
<div style='height:3ex'></div></div>
<h3 class='subsection_' id='magicparlabel-25'>Reading list &amp; references:</h3>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-26'><a id="enu_Welling__M_____" /> Welling, M., &amp; Teh, Y. W. (2011). Bayesian learning via stochastic gradient Langevin dynamics. In Proceedings of the 28th international conference on machine learning (ICML-11) (pp. 681-688).</li>
<li class="enumerate_item" id='magicparlabel-27'><a id="enu_Bottou__L___2012__" /> Bottou, L. (2012). Stochastic gradient descent tricks. In Neural networks: Tricks of the trade (pp. 421-436). Springer, Berlin, Heidelberg.</li>
<li class="enumerate_item" id='magicparlabel-41'><a id="enu_Sato__I____" /> Sato, I., &amp; Nakagawa, H. (2014). Approximation analysis of stochastic gradient Langevin dynamics by using Fokker-Planck equation and Ito process. In International Conference on Machine Learning (pp. 982-990). PMLR. </li>
<li class="enumerate_item" id='magicparlabel-42'><a id="enu_Teh__Y__W__" /> Teh, Y. W., Thiery, A. H., &amp; Vollmer, S. J. (2016). Consistency and fluctuations for stochastic gradient Langevin dynamics. Journal of Machine Learning Research, 17.</li>
<li class="enumerate_item" id='magicparlabel-43'><a id="enu_Vollmer__S__J__" /> Vollmer, S. J., Zygalakis, K. C., &amp; Teh, Y. W. (2016). Exploration of the (non-) asymptotic bias and variance of stochastic gradient Langevin dynamics. The Journal of Machine Learning Research, 17(1), 5504-5548. –&gt;further reading for theory</li>
<li class="enumerate_item" id='magicparlabel-44'><a id="enu_Nemeth__C____" /> Nemeth, C., &amp; Fearnhead, P. (2021). Stochastic gradient Markov chain Monte Carlo. Journal of the American Statistical Association, 116(533), 433-450.</li>
</ol>
</div></div>
<section>
<h2 class='section' id='magicparlabel-57'><span class="section_label">1</span> Bayesian learning and motivations</h2>
<div class='note'>
<div class="note_item" id='magicparlabel-58'><span class="note_label">Note 1.</span>
Bayesian methods are appealing in their ability to capture uncertainty in learned parameters and avoid overﬁtting. Arguably with large datasets there will be little overﬁtting. Alternatively, as we have access to larger datasets and more computational resources, we become interested in building more complex models (eg from a logistic regression to a deep neural network), so that there will always be a need to quantify the amount of parameter uncertainty.</div>
</div>
<div class='standard' id='magicparlabel-59'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-60'><span class="note_label">Note 2.</span>
<a id="note_Consider_a_Bayesian" /> Consider a Bayesian statistical model with sampling distribution (statistical model) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>z</mi>
   <mo stretchy='false'>|</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 labeled by an unknown parameter <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo>&#x2208;</mo>
 <mi>&#x398;</mi>
 <mo>&#x2286;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
</mrow>
</math>
 that follows a prior distribution <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. Assume a dataset <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mstyle mathvariant='script'>
   <mi>S</mi>
  </mstyle>
  <mi>n</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <mi>n</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 of size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>n</mi>
</math>
 containing independently drawn examples. Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>L</mi>
  <mi>n</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mrow>
     <mn>1</mn>
     <mo stretchy='false'>:</mo>
     <mi>n</mi>
    </mrow>
   </msub>
   <mo stretchy='false'>|</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 denote the likelihood of the observables <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo>&#x2208;</mo>
   <mstyle mathvariant='script'>
    <mi>Z</mi>
   </mstyle>
  </mrow>
  <mo>}</mo>
 </mrow>
 <mrow>
  <mi>i</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
 </mrow>
 <mi>n</mi>
</msubsup>
</math>
 give parameter <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
. The Bayesian model is denoted as<a id="eq_" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
   <mtable>
    <mtr>
     <mtd>
      <mrow>
       <msub>
        <mi>z</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy='false'>|</mo>
       <mi>w</mi>
      </mrow>
     </mtd>
     <mtd>
      <mrow>
       <mover accent='false'>
        <mo>&#x223C;</mo>
        <mtext>ind</mtext>
       </mover>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>z</mi>
          <mi>i</mi>
         </msub>
         <mo stretchy='false'>|</mo>
         <mi>w</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mo stretchy='false'>,</mo>
       <mspace width="6px"/>
       <mspace width="6px"/>
       <mi>i</mi>
       <mo stretchy='false'>=</mo>
       <mn>1</mn>
       <mo stretchy='false'>,</mo>
       <mn>...</mn>
       <mo stretchy='false'>,</mo>
       <mi>n</mi>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mi>w</mi>
     </mtd>
     <mtd>
      <mrow>
       <mo>&#x223C;</mo>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <mi>w</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
  </mtd>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mtext>(1.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-61'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-62'><span class="note_label">Note 3.</span>
With regards to the Bayesian model in Note <a href="#note_Consider_a_Bayesian">2</a>, we denote the likelihood of the observables <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo>&#x2208;</mo>
   <mstyle mathvariant='script'>
    <mi>Z</mi>
   </mstyle>
  </mrow>
  <mo>}</mo>
 </mrow>
 <mrow>
  <mi>i</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
 </mrow>
 <mi>n</mi>
</msubsup>
</math>
 given the parameter <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 as 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>L</mi>
  <mi>n</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mrow>
     <mn>1</mn>
     <mo stretchy='false'>:</mo>
     <mi>n</mi>
    </mrow>
   </msub>
   <mo stretchy='false'>|</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x220F;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>n</mi>
 </munderover>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-63'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-64'><span class="note_label">Note 4.</span>
<a id="rem_Bayesian_learning_heavily" /> Bayesian learning (inference) relies on the posterior distribution density <a id="eq__1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>|</mo>
      <msub>
       <mi>z</mi>
       <mrow>
        <mn>1</mn>
        <mo stretchy='false'>:</mo>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mrow>
      <msub>
       <mi>L</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo>&#x222B;</mo>
      <msub>
       <mi>L</mi>
       <mi>n</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
      <mtext>d</mtext>
      <mi>w</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(1.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 which quantifies the researcher&#8217;s belief (or uncertainty) about the unknown parameter <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 learned given examples <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo>&#x2208;</mo>
   <mstyle mathvariant='script'>
    <mi>Z</mi>
   </mstyle>
  </mrow>
  <mo>}</mo>
 </mrow>
 <mrow>
  <mi>i</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
 </mrow>
 <mi>n</mi>
</msubsup>
</math>
. It is often intractable; hence there is often a need to numerically compute it. (Section <a href="#sec_Full_Bayesian_learning">3</a>)</div>
</div>
<div class='standard' id='magicparlabel-65'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-66'><span class="note_label">Note 5.</span>
<a id="enu_a_posteriori_averaging" /> Point estimation of a function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>h</mi>
</math>
 of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 is often performed via computation of the posterior expectation <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 given the examples in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mstyle mathvariant='script'>
  <mi>S</mi>
 </mstyle>
 <mi>n</mi>
</msub>
</math>
<a id="eq__2" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <mi>f</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>h</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>|</mo>
      <msub>
       <mi>z</mi>
       <mrow>
        <mn>1</mn>
        <mo stretchy='false'>:</mo>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mo>&#x222B;</mo>
    <mi>h</mi>
    <mrow>
     <mo>(</mo>
     <mi>w</mi>
     <mo>)</mo>
    </mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>|</mo>
      <msub>
       <mi>z</mi>
       <mrow>
        <mn>1</mn>
        <mo stretchy='false'>:</mo>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mtext>d</mtext>
    <mi>w</mi>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(1.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
It is often intractable; hence there is often a need to numerically compute it. (Section <a href="#sec_Full_Bayesian_learning">3</a>)</div>
</div>
<div class='standard' id='magicparlabel-67'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-68'><span class="note_label">Note 6.</span>
Point estimation of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 can also be performed via maximum a-posteriori (MAP) estimator <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mo stretchy='false'>*</mo>
</msup>
</math>
 of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 that is the maximizer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mo stretchy='false'>*</mo>
</msup>
</math>
 of <a href="#eq__1">(1.2)</a> i.e.<a id="eq__5" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <msup>
    <mi>w</mi>
    <mo stretchy='false'>*</mo>
   </msup>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>max</mo>
     </mrow>
     <mrow>
      <mi>w</mi>
      <mo>&#x2208;</mo>
      <mi>&#x398;</mi>
     </mrow>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>|</mo>
        <msub>
         <mi>z</mi>
         <mrow>
          <mn>1</mn>
          <mo stretchy='false'>:</mo>
          <mi>n</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(1.4)</mtext>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>max</mo>
     </mrow>
     <mrow>
      <mi>w</mi>
      <mo>&#x2208;</mo>
      <mi>&#x398;</mi>
     </mrow>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munder accent='false'>
       <munder>
        <mrow>
         <mo>log</mo>
         <mrow>
          <mo>(</mo>
          <mrow>
           <msub>
            <mi>L</mi>
            <mi>n</mi>
           </msub>
           <mrow>
            <mo>(</mo>
            <mi>w</mi>
            <mo>)</mo>
           </mrow>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
        <mo stretchy='true'>&#x23DF;</mo>
       </munder>
       <mtext>
       <mrow>
        <mo stretchy='false'>(</mo>I
        <mo stretchy='false'>)</mo>
       </mrow></mtext>
      </munder>
      <mo stretchy='false'>+</mo>
      <munder accent='false'>
       <munder>
        <mrow>
         <mo>log</mo>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mi>f</mi>
           <mrow>
            <mo>(</mo>
            <mi>w</mi>
            <mo>)</mo>
           </mrow>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
        <mo stretchy='true'>&#x23DF;</mo>
       </munder>
       <mtext>
       <mrow>
        <mo stretchy='false'>(</mo>II
        <mo stretchy='false'>)</mo>
       </mrow></mtext>
      </munder>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(1.5)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
Note that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mtext>
<mrow>
 <mo stretchy='false'>(</mo>I
 <mo stretchy='false'>)</mo>
</mrow></mtext>
</math>
 may be interpreted as an empirical risk function, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mtext>
<mrow>
 <mo stretchy='false'>(</mo>II
 <mo stretchy='false'>)</mo>
</mrow></mtext>
</math>
 can be interpreted as a shrinkage term in terms of shrinkage methods (like LASSO, Ridge). It is often intractable; hence there is often a need to numerically compute it. (Section <a href="#sec_Maximum_A_Posteriori">2</a>)
<br />
</div>
</div>
<div class='standard' id='magicparlabel-69'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-70'><span class="note_label">Note 7.</span>
To describe the learning algorithms Gradient Descent (GD), Stochastic Gradient Descent (SGD), and Stochastic Gradient Langevin Dynamics (SGLD), we consider that the examples (data) in <a href="#eq_">(1.1)</a> are independent realizations from the sampling distribution i.e. <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>z</mi>
  <mi>i</mi>
 </msub>
 <mo stretchy='false'>|</mo>
 <mi>w</mi>
 <mo>&#x223C;</mo>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>&#x22C5;</mo>
   <mo stretchy='false'>|</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>n</mi>
</mrow>
</math>
 and that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 is continuous (not discrete). </div>
</div>
<div class='standard' id='magicparlabel-71'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-72'><span class="note_label">Note 8.</span>
In what follows, we first present the implementation of GD and SGD addressing MAP learning, and then we introduce the implementation of SGLD addressing posterior density and expectation learning. </div>
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-88'><span class="section_label">2</span> <a id="sec_Maximum_A_Posteriori" />Maximum A Posteriori (MAP) learning via GD and SGD</h2>
<div class='problem'>
<div class="problem_item" id='magicparlabel-89'><span class="problem_label">Problem 9.</span>
<a id="prob_Given_the_Bayesian" /> Given the Bayesian model <a href="#eq_">(1.1)</a>, and rearranging <a href="#eq__5">(1.4)</a>, MAP estimate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mo stretchy='false'>*</mo>
</msup>
</math>
 of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 can be computed as<a id="eq__5_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <msup>
    <mi>w</mi>
    <mo stretchy='false'>*</mo>
   </msup>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>max</mo>
     </mrow>
     <mrow>
      <mi>w</mi>
      <mo>&#x2208;</mo>
      <mi>&#x398;</mi>
     </mrow>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>L</mi>
         <mi>n</mi>
        </msub>
        <mrow>
         <mo>(</mo>
         <mi>w</mi>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>max</mo>
     </mrow>
     <mrow>
      <mi>w</mi>
      <mo>&#x2208;</mo>
      <mi>&#x398;</mi>
     </mrow>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>i</mi>
        <mo stretchy='false'>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>w</mi>
          <mo stretchy='false'>|</mo>
          <msub>
           <mi>z</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <mi>w</mi>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-90'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-91'><span class="note_label">Note 10.</span>
GD is particularly suitable to solve <a href="#eq__5_1">(2.1)</a> when <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 has high dimensionality.</div>
</div>
<div class='standard' id='magicparlabel-92'>
<br />
</div>

<div class='standard' id='magicparlabel-93'><div class='Boxed'><div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-97'><span class="algorithm_label">Algorithm 11.</span>
<a id="alg_Gradient_descent__Algorithm" /> Gradient descent (Algorithm <a href="#alg_Gradient_descent_algorithm">alg:Gradient-descent-algorithm</a> &#8220;Handout <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a>: Gradient descent &#8221;) with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>&#x2265;</mo>
 <mn>0</mn>
</mrow>
</math>
 can be used to address Problem <a href="#prob_Given_the_Bayesian">9</a> by using the update rule as</div>
<div class="algorithm_item" id='magicparlabel-98'><hr />
</div>
<div class='plain_layout' style='text-align: left;' id='magicparlabel-99'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate: </i></div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-100'><i>Compute<a id="eq__6" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>+</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>i</mi>
        <mo stretchy='false'>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <msub>
       <mi>&#x2207;</mi>
       <mi>w</mi>
      </msub>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>z</mi>
           <mi>j</mi>
          </msub>
          <mo stretchy='false'>|</mo>
          <msup>
           <mi>w</mi>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mi>t</mi>
            <mo stretchy='false'>)</mo>
           </mrow>
          </msup>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <msub>
       <mi>&#x2207;</mi>
       <mi>w</mi>
      </msub>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <msup>
          <mi>w</mi>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mi>t</mi>
           <mo stretchy='false'>)</mo>
          </mrow>
         </msup>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</i></li>
</ol>
</div>
</div></div>

<div class='standard' id='magicparlabel-101'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-102'><span class="note_label">Note 12.</span>
The implementation of other GD variants (eg <a href="#eq_sbGD_update_mechanism">eq:sbGD-update-mechanism</a> in Handout 2) is straightforward, based on Algorithm <a href="#alg_Gradient_descent__Algorithm">11</a>. </div>
</div>
<div class='standard' id='magicparlabel-103'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-104'><span class="note_label">Note 13.</span>
<a id="rem_SGD_is_particularly" /> SGD is particularly suitable to solve <a href="#eq__5_1">(2.1)</a> when <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 has high dimensionality, and in big-data problems since the repetitive computation of the sum in <a href="#eq__6">(2.2)</a> is prohibitively expensive. Yet consider the benefits of SGD against GD as discussed in (Remarks <a href="#rem_In_practice__using">rem:In-practice,-using</a> and <a href="#rem_In_practice__for">rem:In-practice,-for</a> of Handout 3). </div>
</div>
<div class='standard' id='magicparlabel-105'>
<br />
</div>

<div class='standard' id='magicparlabel-106'><div class='Boxed'><div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-110'><span class="algorithm_label">Algorithm 14.</span>
<a id="alg_Batch_Stochastic_Gradient" /> Batch Stochastic Gradient Descent (Algorithm <a href="#alg_batch_Stochastic_Gradient">alg:batch-Stochastic-Gradient</a> in &#8220;Handout <a href="#enu_Handout___Stochastic">enu:Handout-:-Stochastic</a>: Stochastic gradient descent&#8221;) with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>&#x2265;</mo>
 <mn>0</mn>
</mrow>
</math>
 and batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 can be used to address Problem <a href="#prob_Given_the_Bayesian">9</a> by using the update rule as</div>
<div class="algorithm_item" id='magicparlabel-111'><hr />
</div>
<div class='plain_layout' style='text-align: left;' id='magicparlabel-112'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate: </i></div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-113'><i>generate a random set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mstyle mathvariant='script'>
   <mi>J</mi>
  </mstyle>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>&#x2286;</mo>
 <msup>
  <mrow>
   <mo>{</mo>
   <mrow>
    <mn>1</mn>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <mi>n</mi>
   </mrow>
   <mo>}</mo>
  </mrow>
  <mi>m</mi>
 </msup>
</mrow>
</math>
 of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 indices from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
 to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>n</mi>
</math>
 with or without replacement, and set a <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mstyle mathvariant='script'>
    <mi>S</mi>
   </mstyle>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mi>m</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo>&#x2208;</mo>
   <msup>
    <mstyle mathvariant='script'>
     <mi>J</mi>
    </mstyle>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
. </i></li>
<li class="enumerate_item" id='magicparlabel-114'><i>compute <a id="eq__6_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>+</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mi>n</mi>
       <mi>m</mi>
      </mfrac>
      <munder>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>j</mi>
        <mo>&#x2208;</mo>
        <msup>
         <mstyle mathvariant='script'>
          <mi>J</mi>
         </mstyle>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
       </mrow>
      </munder>
      <msub>
       <mi>&#x2207;</mi>
       <mi>w</mi>
      </msub>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>z</mi>
           <mi>j</mi>
          </msub>
          <mo stretchy='false'>|</mo>
          <msup>
           <mi>w</mi>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mi>t</mi>
            <mo stretchy='false'>)</mo>
           </mrow>
          </msup>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <msub>
       <mi>&#x2207;</mi>
       <mi>w</mi>
      </msub>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <msup>
          <mi>w</mi>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mi>t</mi>
           <mo stretchy='false'>)</mo>
          </mrow>
         </msup>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</i></li>
</ol>
</div>
</div></div>

<div class='standard' id='magicparlabel-115'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-116'><span class="note_label">Note 15.</span>
Recursion <a href="#eq__6_1">(2.3)</a> is justified in terms of SGD theory as <a id="eq__10" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <mrow>
      <msup>
       <mstyle mathvariant='script'>
        <mi>J</mi>
       </mstyle>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mi>t</mi>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
      <mo>&#x223C;</mo>
      <mtext>simple-random-sampling</mtext>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mi>n</mi>
       <mi>m</mi>
      </mfrac>
      <munder>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>j</mi>
        <mo>&#x2208;</mo>
        <msup>
         <mstyle mathvariant='script'>
          <mi>J</mi>
         </mstyle>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
       </mrow>
      </munder>
      <msub>
       <mi>&#x2207;</mi>
       <mi>w</mi>
      </msub>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>z</mi>
           <mi>j</mi>
          </msub>
          <mo stretchy='false'>|</mo>
          <msup>
           <mi>w</mi>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mi>t</mi>
            <mo stretchy='false'>)</mo>
           </mrow>
          </msup>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>|</mo>
        <msup>
         <mi>w</mi>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.4)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 see Exercise <a href="#exer____2_1_1_1_1">exer:()-2-1-1-1-1</a> from the Exercise sheet. </div>
</div>
<div class='standard' id='magicparlabel-117'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-118'><span class="note_label">Note 16.</span>
The implementation of the SGD variants (Algorithms <a href="#alg_batch_Stochastic_Gradient">alg:batch-Stochastic-Gradient</a>, <a href="#alg_Stochastic_Variance_Reduced">alg:Stochastic-Variance-Reduced</a>, <a href="#alg_Stochastic_Gradient_descent_2">alg:Stochastic-Gradient-descent-2</a>, <a href="#def_Adaptive_Stochastic_Gradient">def:Adaptive-Stochastic-Gradient</a> in Handout 3)) is straightforward based on Algorithm <a href="#alg_Batch_Stochastic_Gradient">14</a> and <a href="#eq__10">(2.4)</a>. </div>
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-119'><span class="section_label">3</span> <a id="sec_Full_Bayesian_learning" /> Fully Bayesian learning via SGLD</h2>
<div class='standard' id='magicparlabel-120'>
<br />
</div>
<div class='problem'>
<div class="problem_item" id='magicparlabel-121'><span class="problem_label">Problem 17.</span>
Fully Bayesian learning, computationally, is the problem of recovering the posterior distribution <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>|</mo>
   <msub>
    <mi>z</mi>
    <mrow>
     <mn>1</mn>
     <mo stretchy='false'>:</mo>
     <mi>n</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 given <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>z</mi>
 <mrow>
  <mn>1</mn>
  <mo stretchy='false'>:</mo>
  <mi>n</mi>
 </mrow>
</msub>
</math>
 that admits density <a href="#eq__1">(1.2)</a>. For a given Bayesian model <a href="#eq_">(1.1)</a>, the Bayesian estimator of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <mi>h</mi>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 id often computed as the posterior expectation of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 given the data <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mstyle mathvariant='script'>
  <mi>S</mi>
 </mstyle>
 <mi>n</mi>
</msub>
</math>
 </div>
</div>
<div class='standard' id='magicparlabel-130'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-131'><span class="note_label">Note 18.</span>
<a id="rem_Monte_Carlo_integration" /> Monte Carlo integration aims at approximating <a href="#eq__2">(1.3)</a> when intractable, by using Central Limit Theorem or Law of Large Numbers arguments as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mi>h</mi>
   <mo stretchy='true'>&#x02C6;</mo>
  </mover>
  <mi>T</mi>
 </msub>
 <mo>&#x2248;</mo>
 <msub>
  <mtext>E</mtext>
  <mi>f</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo>(</mo>
    <mi>w</mi>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>|</mo>
   <msub>
    <mi>z</mi>
    <mrow>
     <mn>1</mn>
     <mo stretchy='false'>:</mo>
     <mi>n</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 where<a id="eq__11" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mover>
      <mi>h</mi>
      <mo stretchy='true'>&#x02C6;</mo>
     </mover>
     <mi>T</mi>
    </msub>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mn>1</mn>
     <mi>T</mi>
    </mfrac>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>T</mi>
    </munderover>
    <mi>h</mi>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>w</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
 are <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>T</mi>
</math>
 simulations drawn (approximately) from the posterior distribution <a href="#eq__1">(1.2)</a>. This theory is subject to conditions we skip. </div>
</div>
<div class='standard' id='magicparlabel-137'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-138'><span class="note_label">Note 19.</span>
Stochastic gradient Langevin dynamics (SGLD) algorithm is able to generate a sample approximately distributed according to the posterior distribution <a href="#eq__1">(1.2)</a>. That allows to recover the whole posterior distribution <a href="#eq__1">(1.2)</a> (hence account for uncertainty in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mo stretchy='false'>=</mo>
 <mi>h</mi>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
) and approximate posterior expectations based on the Monte Carlo integration (Remark <a href="#rem_Monte_Carlo_integration">18</a>). </div>
</div>
<div class='standard' id='magicparlabel-146'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-147'><span class="note_label">Note 20.</span>
SGLD (see Algorithm <a href="#alg_Stochastic_Gradient_Langevin">21</a>), as output, generates a random chain <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
 that is approximately distributed according to a distribution that admits density such as <a id="eq__3" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>f</mi>
     <mi>&#x3C4;</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>|</mo>
      <msub>
       <mi>z</mi>
       <mrow>
        <mn>1</mn>
        <mo stretchy='false'>:</mo>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>&#x221D;</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>&#x3C4;</mi>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>log</mo>
        <msub>
         <mi>L</mi>
         <mi>n</mi>
        </msub>
        <mrow>
         <mo>(</mo>
         <mi>w</mi>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>+</mo>
        <mo>log</mo>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <mi>w</mi>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.2)</mtext>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo>&#x221D;</mo>
  </mtd>
  <mtd>
   <mrow>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>&#x3C4;</mi>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mrow>
        <munderover>
         <mo>&#x2211;</mo>
         <mrow>
          <mi>i</mi>
          <mo stretchy='false'>=</mo>
          <mn>1</mn>
         </mrow>
         <mi>n</mi>
        </munderover>
        <mo>log</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msub>
             <mi>z</mi>
             <mi>i</mi>
            </msub>
            <mo stretchy='false'>|</mo>
            <mi>w</mi>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>+</mo>
        <mo>log</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>f</mi>
          <mrow>
           <mo>(</mo>
           <mi>w</mi>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 for any <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C4;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 under regularity conditions. </div>
</div>
<div class='standard' id='magicparlabel-148'>
<br />
</div>



<div class='standard' id='magicparlabel-155'>
<br />
</div>

<div class='standard' id='magicparlabel-156'><div class='Boxed'><div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-160'><span class="algorithm_label">Algorithm 21.</span>
<a id="alg_Stochastic_Gradient_Langevin" /> Stochastic Gradient Langevin Dynamics (SGLD) with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
, batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
, and temperature <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C4;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 is </div>
<div class="algorithm_item" id='magicparlabel-161'><hr />
</div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-162'><i>Generate a random set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mstyle mathvariant='script'>
   <mi>J</mi>
  </mstyle>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>&#x2286;</mo>
 <msup>
  <mrow>
   <mo>{</mo>
   <mrow>
    <mn>1</mn>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <mi>n</mi>
   </mrow>
   <mo>}</mo>
  </mrow>
  <mi>m</mi>
 </msup>
</mrow>
</math>
 of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 indices from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
 to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>n</mi>
</math>
 with or without replacement, and set a <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mstyle mathvariant='script'>
    <mi>S</mi>
   </mstyle>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mi>m</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo>&#x2208;</mo>
   <msup>
    <mstyle mathvariant='script'>
     <mi>J</mi>
    </mstyle>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
. </i></li>
<li class="enumerate_item" id='magicparlabel-163'><i>Compute </i><a id="eq__7" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>+</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mi>n</mi>
       <mi>m</mi>
      </mfrac>
      <munder>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>i</mi>
        <mo>&#x2208;</mo>
        <msup>
         <mi>J</mi>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
       </mrow>
      </munder>
      <mi>&#x2207;</mi>
      <mo>log</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>|</mo>
        <msup>
         <mi>w</mi>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <mi>&#x2207;</mi>
      <mo>log</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <msub>
       <mi>&#x3B7;</mi>
       <mi>t</mi>
      </msub>
      <mi>&#x3C4;</mi>
     </mrow>
    </msqrt>
    <msub>
     <mi>&#x3F5;</mi>
     <mi>t</mi>
    </msub>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.4)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3F5;</mi>
  <mi>t</mi>
 </msub>
 <mover accent='false'>
  <mo>&#x223C;</mo>
  <mtext>iid</mtext>
 </mover>
 <mtext>N</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>I</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 .</li>
<li class="enumerate_item" id='magicparlabel-164'><i>Terminate if a termination criterion is satisfied; E.g., <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo>&#x2265;</mo>
 <msub>
  <mi>T</mi>
  <mtext>max&#0160;</mtext>
 </msub>
</mrow>
</math>
 for a prespecified <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>T</mi>
  <mtext>max&#0160;</mtext>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
.</i></li>
</ol>
</div>
</div><div class='marginal'><div class='plain_layout' id='magicparlabel-168'>Ref [<a href="#enu_Welling__M_____">1.</a>]</div>
</div>
<br />
</div>

<div class='standard' id='magicparlabel-169'>
<br />
</div>

<div class='standard' id='magicparlabel-170'>
<br />
</div>

<div class='standard' id='magicparlabel-171'>&#xA0;</div>
<h4 class='subsubsection_' id='magicparlabel-172'>About intuitions (why it works) ...</h4>
<div class='standard' id='magicparlabel-173'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-174'><span class="note_label">Note 22.</span>
SGLD relies on injecting the `right&#8217; amount of noise <a href="#eq__7">(3.4)</a> to a standard stochastic gradient optimization recursion <a href="#eq__6">(2.2)</a>, such that, as the stepsize <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 properly reduces, the produced chain <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
 converges to samples that could have been drawn from distribution with density <a href="#eq__3">(3.2)</a>.</div>
<div class="note_item" id='magicparlabel-183'></div>
</div>
<div class='standard' id='magicparlabel-189'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-190'><span class="note_label">Note 23.</span>
<a id="rem__Mathematically_speaking__The" /> (Mathematically speaking)<div class='marginal'><div class='plain_layout' id='magicparlabel-194'>Ref [<a href="#enu_Sato__I____">3.</a>]</div>
</div> The stochastic chain in <a href="#eq__7">(3.4)</a> can be viewed as a discretization of the continuous-time Langevin diffusion described by the stochastic differential equation<a id="eq__8" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mtext>d</mtext>
    <mi>W</mi>
    <mrow>
     <mo>(</mo>
     <mi>t</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mo>log</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>W</mi>
        <mrow>
         <mo>(</mo>
         <mi>t</mi>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>|</mo>
        <msub>
         <mi>z</mi>
         <mrow>
          <mn>1</mn>
          <mo stretchy='false'>:</mo>
          <mi>n</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
    <mtext>d</mtext>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <mi>&#x3C4;</mi>
     </mrow>
    </msqrt>
    <mtext>d</mtext>
    <mi>B</mi>
    <mrow>
     <mo>(</mo>
     <mi>t</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mi>t</mi>
    <mo>&#x2265;</mo>
    <mn>0</mn>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.5)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <mi>B</mi>
  <mrow>
   <mo>(</mo>
   <mi>t</mi>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 is a standard Brownian motion<div class='foot'><span class="foot_label">1</span><div class="foot_inner"><div class='plain_layout' id='magicparlabel-198'>A a continuous-time stochastic process: (1) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>B</mi>
 <mrow>
  <mo>(</mo>
  <mn>0</mn>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
 ; (2) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>B</mi>
 <mrow>
  <mo>(</mo>
  <mi>t</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is almost surely continuous ; (3) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>B</mi>
 <mrow>
  <mo>(</mo>
  <mi>t</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 has independent increaments ; (4) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>B</mi>
 <mrow>
  <mo>(</mo>
  <mi>t</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>-</mo>
 <mi>B</mi>
 <mrow>
  <mo>(</mo>
  <mi>s</mi>
  <mo>)</mo>
 </mrow>
 <mo>&#x223C;</mo>
 <mtext>N</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>t</mi>
   <mo stretchy='false'>-</mo>
   <mi>s</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mn>0</mn>
 <mo>&#x2264;</mo>
 <mi>s</mi>
 <mo>&#x2264;</mo>
 <mi>t</mi>
</mrow>
</math>
.</div>
</div></div> in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
 <mi>d</mi>
</msup>
</math>
 (i.e.). Under suitable assumptions on <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>f</mi>
</math>
, it can be shown that a Gibbs distribution with PDF such as <a id="eq__9" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>f</mi>
     <mo stretchy='false'>*</mo>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>|</mo>
      <msub>
       <mi>z</mi>
       <mrow>
        <mn>1</mn>
        <mo stretchy='false'>;</mo>
        <mi>n</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>&#x221D;</mo>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mn>1</mn>
       <mi>&#x3C4;</mi>
      </mfrac>
      <mrow>
       <mo>[</mo>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mo>log</mo>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>w</mi>
          <mo stretchy='false'>|</mo>
          <msub>
           <mi>z</mi>
           <mrow>
            <mn>1</mn>
            <mo stretchy='false'>:</mo>
            <mi>n</mi>
           </mrow>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>]</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.6)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 is the unique invariant distribution of <a href="#eq__8">(3.5)</a>, and that the distributions of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>W</mi>
 <mrow>
  <mo>(</mo>
  <mi>t</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 converge rapidly to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>f</mi>
 <mo stretchy='false'>*</mo>
</msup>
</math>
 as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo>&#x2192;</mo>
 <mi>&#x221E;</mi>
</mrow>
</math>
. </div>
</div>


<div class='standard' id='magicparlabel-204'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-205'><span class="note_label">Note 24.</span>
(Heuristically speaking) In the initial phase of running, the stochastic gradient noise will dominate the injected noise <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3F5;</mi>
 <mi>t</mi>
</msub>
</math>
 and the algorithm will imitate an efficient SGD Algorithm <a href="#alg_Gradient_descent__Algorithm">11</a> -but this is until <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 or <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2207;</mi>
 <mo>log</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>L</mi>
    <mi>n</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>w</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 become small enough. In the later phase of running, the injected noise <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3F5;</mi>
 <mi>t</mi>
</msub>
</math>
 will dominate the stochastic gradient noise, so the SGLD will imitate a Langevin dynamics for the target distribution <a href="#eq__1">(1.2)</a>. The aim is for to the algorithm to transition smoothly between the two phases. Whether the algorithm is in the stochastic optimization phase or Langevin dynamics phase depends on the variance of the injected noise versus that of the stochastic gradient. </div>
</div>
<div class='standard' id='magicparlabel-206'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-207'><span class="note_label">Note 25.</span>
One can argue that, the output of SGLD is also an &#8220;almost&#8221; minimizer of the empirical risk for large enough <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
. A draw from the Gibbs distribution <a href="#eq__9">(3.6)</a> is approximately a minimizer of <a href="#eq__5_1">(2.1)</a>. Also one can show that the SGLD recursion tracks the Langevin diffusion <a href="#eq__8">(3.5)</a> in a suitable sense. Hence, both imply that the distributions of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>W</mi>
 <mrow>
  <mo>(</mo>
  <mi>t</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 will be close to the Gibbs distribution <a href="#eq__9">(3.6)</a> for all sufficiently large <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-208'>
<br />
</div>
<h4 class='subsubsection_' id='magicparlabel-209'>About the learning rate alg. parameter...</h4>
<div class='standard' id='magicparlabel-210'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-211'><span class="note_label">Note 26.</span>
To guarantee the algorithm to work it is important for the step sizes <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 to decrease to zero, so that the mixing rate of the algorithm will slow down with increasing number of iterations <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
. Then, we can keep the step size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 constant once it has decreased below a critical level.</div>
</div>
<div class='standard' id='magicparlabel-212'>
<br />
</div>
<div class='condition'>
<div class="condition_item" id='magicparlabel-213'><span class="condition_label">Condition 27.</span>
<a id="cond_Regarding_the_learning" />Regarding the learning rate (or gain) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 should satisfy the following conditions in order for SGLD Algorithm <a href="#alg_Stochastic_Gradient_Langevin">21</a> to generate an output <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
 approximately distributed according to <a href="#eq__3">(3.2)</a></div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-214'><a id="enu__" /><math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>&#x2265;</mo>
 <mn>0</mn>
</mrow>
</math>
, </li>
<li class="enumerate_item" id='magicparlabel-215'><a id="enu_" /><math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>&#x221E;</mi>
 </munderover>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mi>&#x221E;</mi>
</mrow>
</math>
</li>
<li class="enumerate_item" id='magicparlabel-216'><a id="enu__1" /><math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>&#x221E;</mi>
 </munderover>
 <msubsup>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
  <mn>2</mn>
 </msubsup>
 <mo stretchy='false'>&lt;</mo>
 <mi>&#x221E;</mi>
</mrow>
</math>
</li>
</ol>
</div>
<h4 class='subsubsection_' id='magicparlabel-217'>About the temperature alg. parameter...</h4>
<div class='standard' id='magicparlabel-218'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-219'><span class="note_label">Note 28.</span>
The popular learning rates <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 in Note <a href="#rem_The_parameter_">rem:The-parameter-</a> in &#8220;Handout <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a>: Gradient descent &#8221; satisfy Condition <a href="#cond_Regarding_the_learning">27</a> and hence can be used in SGD too. Once parametrized, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 can be tuned based on pilot runs using a reasonably small number of data.</div>
</div>
<div class='standard' id='magicparlabel-220'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-221'><span class="note_label">Note 29.</span>
The temperature parameter <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C4;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 is user specified and aims at controlling (eg; inflating) the variance of the produced chain for instance with practical purpose to escape from local modes (otherwise energy barriers) in non-convex problems. </div>
</div>
<div class='standard' id='magicparlabel-222'>
<br />
</div>

<div class='standard' id='magicparlabel-223'>
<br />
</div>
<h4 class='subsubsection_' id='magicparlabel-224'>About the output of the alg...</h4>
<div class='note'>
<div class="note_item" id='magicparlabel-225'><span class="note_label">Note 30.</span>
The first few iterations of SGLD (Algorithm <a href="#alg_Stochastic_Gradient_Langevin">21</a>) involve values generated at the beginning of the running algorithm while the chain have not yet converged to (or reached) an area of substantial posterior mass. Hence they are discarded from the output of the SGLD. These values are called burn-in. </div>
</div>
<div class='standard' id='magicparlabel-226'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-227'><span class="note_label">Note 31.</span>
The output of SGLD (Algorithm <a href="#alg_Stochastic_Gradient_Langevin">21</a>) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
 includes the generated values of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 produced during the last few iterations of the running algorithm and after discarding the burn-in generated values. </div>
</div>
<div class='standard' id='magicparlabel-233'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-234'><span class="note_label">Note 32.</span>
SGLD for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C4;</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
 approximately simulates from the posterior <a href="#eq__1">(1.2)</a>. </div>
</div>
<h4 class='subsubsection_' id='magicparlabel-235'>About facilitating inference...</h4>
<div class='standard' id='magicparlabel-236'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-237'><span class="note_label">Note 33.</span>
Expectation <a href="#eq__2">(1.3)</a>,  can be estimated as an arithmetic average<a id="eq__4" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mover>
     <mrow>
      <msub>
       <mi>h</mi>
       <mi>T</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo stretchy='true'>&#x005E;</mo>
    </mover>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mn>1</mn>
     <mi>T</mi>
    </mfrac>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>T</mi>
    </munderover>
    <mi>h</mi>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>w</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.7)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mover>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>T</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>w</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo stretchy='true'>&#x005E;</mo>
 </mover>
 <mo>&#x2192;</mo>
 <msub>
  <mtext>E</mtext>
  <mi>f</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo>(</mo>
    <mi>w</mi>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>|</mo>
   <msub>
    <mi>z</mi>
    <mrow>
     <mn>1</mn>
     <mo stretchy='false'>:</mo>
     <mi>n</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 based on LLN arguments.</div>
</div>
<div class='standard' id='magicparlabel-242'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-243'><span class="note_label">Note 34.</span>
Another more efficient estimator for the expectation <a href="#eq__2">(1.3)</a> is the weighted arithmetic average<a id="eq__4_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mover>
     <mrow>
      <msub>
       <mover>
        <mi>h</mi>
        <mo stretchy='true'>&#x02C6;</mo>
       </mover>
       <mi>T</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo stretchy='true'>&#x005E;</mo>
    </mover>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>=</mo>
      <msub>
       <mi>T</mi>
       <mn>0</mn>
      </msub>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
     <mi>T</mi>
    </munderover>
    <mfrac>
     <msub>
      <mi>&#x3B7;</mi>
      <mi>t</mi>
     </msub>
     <mrow>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>=</mo>
        <msub>
         <mi>T</mi>
         <mn>0</mn>
        </msub>
        <mo stretchy='false'>+</mo>
        <mn>1</mn>
       </mrow>
       <mi>T</mi>
      </munderover>
      <msub>
       <mi>&#x3B7;</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>'</mo>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <mi>h</mi>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>w</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.8)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-244'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-245'><span class="note_label">Note 35.</span>
Estimator <a href="#eq__4_1">(3.8)</a> has a smaller standard error than estimator <a href="#eq__4">(3.7)</a>. As the step size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 decreases, the mixing rate of the chain <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
 decreases as well and the simple sample average <a href="#eq__4">(3.7)</a> overemphasizes in the tail end of the sequence where there is higher correlation among the samples resulting in higher variance in the estimator. </div>
</div>

<h3 class='subsection_' id='magicparlabel-252'>Preconditioned SGLD...</h3>
<div class='standard' id='magicparlabel-253'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-254'><span class="note_label">Note 36.</span>
Certain dimensions may have a vastly larger curvature leading to much bigger gradients. In this case a symmetric preconditioning matrix <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>P</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 can transform all dimensions to the same scale; this is similar to the SGD case in &#8220;Handout <a href="#enu_Handout___Stochastic">enu:Handout-:-Stochastic</a>: Stochastic gradient descent&#8221;. Hence the update <a href="#eq__7">(3.4)</a> becomes<a id="eq__7_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>+</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <msub>
     <mi>P</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mi>n</mi>
       <mi>m</mi>
      </mfrac>
      <munder>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>i</mi>
        <mo>&#x2208;</mo>
        <msup>
         <mi>J</mi>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
       </mrow>
      </munder>
      <mi>&#x2207;</mi>
      <mo>log</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>|</mo>
        <mi>w</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <mi>&#x2207;</mi>
      <mo>log</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <msub>
       <mi>&#x3B7;</mi>
       <mi>t</mi>
      </msub>
      <mi>&#x3C4;</mi>
     </mrow>
    </msqrt>
    <msubsup>
     <mi>P</mi>
     <mi>t</mi>
     <mfrac>
      <mn>1</mn>
      <mn>2</mn>
     </mfrac>
    </msubsup>
    <msub>
     <mi>&#x3F5;</mi>
     <mi>t</mi>
    </msub>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.9)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mi>P</mi>
 <mi>t</mi>
 <mfrac>
  <mn>1</mn>
  <mn>2</mn>
 </mfrac>
</msubsup>
</math>
 is such that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msubsup>
  <mi>P</mi>
  <mi>t</mi>
  <mfrac>
   <mn>1</mn>
   <mn>2</mn>
  </mfrac>
 </msubsup>
 <msup>
  <mrow>
   <mo>(</mo>
   <msubsup>
    <mi>P</mi>
    <mi>t</mi>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
   </msubsup>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>P</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
. </div>
</div>


<div class='standard' id='magicparlabel-260'>
<br />
</div>
<h3 class='subsection_' id='magicparlabel-261'>About the exploding gradient phenomenon...</h3>
<div class='note'>
<div class="note_item" id='magicparlabel-262'><span class="note_label">Note 37.</span>
`Exploding gradients&#8217; is the practical phenomenon in which large updates to weights during training can cause a numerical overflow or underflow due to the machine error of the computer.</div>
</div>
<div class='standard' id='magicparlabel-271'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-272'><span class="note_label">Note 38.</span>
Practical solutions to `Exploding gradient&#8217; involve, at each iteration <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
, checking the magnitude of the gradient <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
, (e.g., Euclidean norm <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>&#x2225;</mo>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo>&#x2225;</mo>
</mrow>
</math>
), and instantly changing it (e.g., gradient scaling or clipping) if it is gonna result an overflow. </div>
</div>
<div class='standard' id='magicparlabel-273'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-274'><span class="note_label">Note 39.</span>
<a id="note_Gradient_scaling_involves" /> Gradient scaling involves normalizing the gradient vector such that vector norm (magnitude) equals a user-specified value. More formally, given a gradient <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
, gradient clipping can be used in a standard recursion 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>+</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
as 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>+</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mtext>clip</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy='false'>,</mo>
   <mi>c</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 where 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mtext>clip</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>v</mi>
   <mo stretchy='false'>,</mo>
   <mi>c</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>v</mi>
 <mo>min</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mfrac>
    <mi>c</mi>
    <mrow>
     <mo>&#x2225;</mo>
     <mi>v</mi>
     <mo>&#x2225;</mo>
    </mrow>
   </mfrac>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>c</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 is a clipping threshold impaling that clipping will take place at iteration <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
 if <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>&#x2225;</mo>
  <msub>
   <mi>v</mi>
   <mi>t</mi>
  </msub>
  <mo>&#x2225;</mo>
 </mrow>
 <mo stretchy='false'>&gt;</mo>
 <mi>c</mi>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-275'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-276'><span class="note_label">Note 40.</span>
Gradient&#xA0;clipping involves forcing the gradient values (element-wise) to a specific minimum or maximum value if the gradient exceeded an expected range.</div>
</div>
<div class='standard' id='magicparlabel-277'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-278'><span class="note_label">Note 41.</span>
Unreasonably frequent scaling or clipping may introduce significant bias and hence it should not be applied carelessly.</div>
</div>
<div class='standard' id='magicparlabel-279'>
<br />
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-280'><span class="section_label">4</span> <a id="sec_Examples" />Examples <div class='foot'><span class="foot_label">2</span><div class="foot_inner"><div class='plain_layout' id='magicparlabel-284'>Code is available from <span class='flex_url'>https://github.com/georgios-stats/Machine_Learning_and_Neural_Networks_III_Epiphany_2024/tree/main/Lecture_handouts/code/06.Stochastic_gradient_Langevine_dynamics</span></div>
</div></div></h2>
<div class='standard' id='magicparlabel-289'>We continue the Example <a href="#exa_Consider_the_simple">exa:Consider-the-simple</a> in <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a>: Gradient descent. </div>
<h3 class='subsection_' id='magicparlabel-290'>Specifying the Bayesian model</h3>
<div class='standard' id='magicparlabel-291'>Consider the Bayesian Normal linear regression model
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
<mtable>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>|</mo>
    <mi>&#x3B2;</mi>
    <mo stretchy='false'>,</mo>
    <msup>
     <mi>&#x3C3;</mi>
     <mn>2</mn>
    </msup>
    <mo>&#x223C;</mo>
    <mtext>N</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msubsup>
       <mi>x</mi>
       <mi>i</mi>
       <mi>&#x22A4;</mi>
      </msubsup>
      <mi>&#x3B2;</mi>
      <mo stretchy='false'>,</mo>
      <msup>
       <mi>&#x3C3;</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mtext>sampling&#0160;distribution</mtext>
    <mspace width="6px"/>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>|</mo>
      <mi>&#x3B2;</mi>
      <mo stretchy='false'>,</mo>
      <msup>
       <mi>&#x3C3;</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x3B2;</mi>
    <mo stretchy='false'>|</mo>
    <msup>
     <mi>&#x3C3;</mi>
     <mn>2</mn>
    </msup>
    <mo>&#x223C;</mo>
    <mtext>N</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3BC;</mi>
      <mo stretchy='false'>,</mo>
      <msup>
       <mi>&#x3C3;</mi>
       <mn>2</mn>
      </msup>
      <mi>V</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mtext>prior</mtext>
    <mspace width="6px"/>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3B2;</mi>
      <mo stretchy='false'>|</mo>
      <msup>
       <mi>&#x3C3;</mi>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>&#x3C3;</mi>
     <mn>2</mn>
    </msup>
    <mo>&#x223C;</mo>
    <mtext>IG</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3D5;</mi>
      <mo stretchy='false'>,</mo>
      <mi>&#x3C8;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mtext>prior</mtext>
    <mspace width="6px"/>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>&#x3C3;</mi>
      <mn>2</mn>
     </msup>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x3B2;</mi>
   <mo stretchy='false'>,</mo>
   <msup>
    <mi>&#x3C3;</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x3B2;</mi>
   <mo stretchy='false'>|</mo>
   <msup>
    <mi>&#x3C3;</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>&#x3C3;</mi>
   <mn>2</mn>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B2;</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
</mrow>
</math>
, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mi>&#x3C3;</mi>
  <mn>2</mn>
 </msup>
 <mo>&#x2208;</mo>
 <msub>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mo stretchy='false'>+</mo>
 </msub>
</mrow>
</math>
. Note given densities
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mtext>N</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>x</mi>
      <mo stretchy='false'>|</mo>
      <mi>&#x3BC;</mi>
      <mo stretchy='false'>,</mo>
      <mi>&#x3A3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mfrac>
       <mn>1</mn>
       <mrow>
        <mn>2</mn>
        <mi>&#x3C0;</mi>
       </mrow>
      </mfrac>
      <mo>)</mo>
     </mrow>
     <mi>d</mi>
    </msup>
    <mfrac>
     <mn>1</mn>
     <mrow>
      <mo>|</mo>
      <mi>&#x3A3;</mi>
      <mo>|</mo>
     </mrow>
    </mfrac>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>x</mi>
         <mo stretchy='false'>-</mo>
         <mi>&#x3BC;</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mi>&#x22A4;</mi>
      </msup>
      <msup>
       <mi>&#x3A3;</mi>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>x</mi>
        <mo stretchy='false'>-</mo>
        <mi>&#x3BC;</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mtext>IG</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>x</mi>
      <mo stretchy='false'>|</mo>
      <mi>a</mi>
      <mo stretchy='false'>,</mo>
      <mi>b</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <msup>
      <mi>b</mi>
      <mi>a</mi>
     </msup>
     <mrow>
      <mi>&#x393;</mi>
      <mrow>
       <mo>(</mo>
       <mi>a</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <msup>
     <mi>x</mi>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>a</mi>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mi>b</mi>
       <mi>x</mi>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mtext>
    <mn>1</mn></mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>x</mi>
      <mo>&#x2265;</mo>
      <mn>0</mn>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
<h3 class='subsection_' id='magicparlabel-296'>Performing computationally convenient transformations</h3>
<div class='standard' id='magicparlabel-297'>Because SGD (Algorithm <a href="#alg_Batch_Stochastic_Gradient">14</a>) and SGLD (Algorithm <a href="#alg_Stochastic_Gradient_Langevin">21</a>) can handle cases where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
</mrow>
</math>
 in a straightforward manner than what they do when <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x3B2;</mi>
   <mo stretchy='false'>,</mo>
   <msup>
    <mi>&#x3C3;</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x00D7;</mo>
 <msub>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mo stretchy='false'>+</mo>
 </msub>
</mrow>
</math>
 which requires an additional projection step; we consider a transformation <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x3B2;</mi>
   <mo stretchy='false'>,</mo>
   <mi>&#x3B3;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x00D7;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B3;</mi>
 <mo stretchy='false'>=</mo>
 <mo>log</mo>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>&#x3C3;</mi>
   <mn>2</mn>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. Hence, the Bayesian model becomes 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
<mtable>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>|</mo>
    <mi>&#x3B2;</mi>
    <mo stretchy='false'>,</mo>
    <msup>
     <mi>&#x3C3;</mi>
     <mn>2</mn>
    </msup>
    <mo>&#x223C;</mo>
    <mtext>N</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msubsup>
       <mi>x</mi>
       <mi>i</mi>
       <mi>&#x22A4;</mi>
      </msubsup>
      <mi>&#x3B2;</mi>
      <mo stretchy='false'>,</mo>
      <mo>exp</mo>
      <mrow>
       <mo>(</mo>
       <mi>&#x3B3;</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mtext>sampling&#0160;distribution</mtext>
    <mspace width="6px"/>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>|</mo>
      <mi>&#x3B2;</mi>
      <mo stretchy='false'>,</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x3B2;</mi>
    <mo stretchy='false'>|</mo>
    <msup>
     <mi>&#x3C3;</mi>
     <mn>2</mn>
    </msup>
    <mo>&#x223C;</mo>
    <mtext>N</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3BC;</mi>
      <mo stretchy='false'>=</mo>
      <mn>0</mn>
      <mo stretchy='false'>,</mo>
      <mo>exp</mo>
      <mrow>
       <mo>(</mo>
       <mi>&#x3B3;</mi>
       <mo>)</mo>
      </mrow>
      <mi>V</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mtext>prior</mtext>
    <mspace width="6px"/>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3B2;</mi>
      <mo stretchy='false'>|</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x3B3;</mi>
    <mo>&#x223C;</mo>
    <msub>
     <mi>f</mi>
     <mi>&#x3B3;</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>&#x3B3;</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mtext>prior</mtext>
    <mspace width="6px"/>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mi>&#x3B3;</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>f</mi>
  <mi>&#x3B3;</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B3;</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is computed according to the method of bijective transformation of random variables; i.e. 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>f</mi>
  <mi>&#x3B3;</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B3;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mtext>IG</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mi>&#x3B3;</mi>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>|</mo>
   <mi>&#x3D5;</mi>
   <mo stretchy='false'>,</mo>
   <mi>&#x3C8;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mrow>
  <mo>|</mo>
  <mrow>
   <mfrac>
    <mtext>d</mtext>
    <mrow>
     <mtext>d</mtext>
     <mi>&#x3B3;</mi>
    </mrow>
   </mfrac>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mi>&#x3B3;</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>|</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mtext>IG</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mi>&#x3B3;</mi>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>|</mo>
   <mi>&#x3D5;</mi>
   <mo stretchy='false'>,</mo>
   <mi>&#x3C8;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>exp</mo>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B3;</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</div>
<h3 class='subsection_' id='magicparlabel-298'>Computing the require quantities for SGLD</h3>
<div class='standard' id='magicparlabel-299'>Then we can compute the required gradients in order to run the SGD, and SGLD with respect to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x3B2;</mi>
   <mo stretchy='false'>,</mo>
   <mi>&#x3B3;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B3;</mi>
 <mo stretchy='false'>=</mo>
 <mo>log</mo>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>&#x3C3;</mi>
   <mn>2</mn>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>=</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo stretchy='false'>,</mo>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>|</mo>
        <mi>w</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>2</mn>
      <mi>&#x3C0;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mi>&#x3B3;</mi>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>j</mi>
       </msub>
       <mo stretchy='false'>-</mo>
       <msubsup>
        <mi>x</mi>
        <mi>i</mi>
        <mi>&#x22A4;</mi>
       </msubsup>
       <mi>&#x3B2;</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>=</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>&#x3B2;</mi>
          <mo stretchy='false'>,</mo>
          <mi>&#x3B3;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>&#x3B2;</mi>
        <mo stretchy='false'>|</mo>
        <mi>&#x3B3;</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>&#x3B3;</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>&#x3B2;</mi>
        <mo stretchy='false'>|</mo>
        <mi>&#x3B3;</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mi>d</mi>
     <mn>2</mn>
    </mfrac>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>2</mn>
      <mi>&#x3C0;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mi>d</mi>
     <mn>2</mn>
    </mfrac>
    <mi>&#x3B3;</mi>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mrow>
     <mo>|</mo>
     <mi>V</mi>
     <mo>|</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>&#x3B2;</mi>
       <mo stretchy='false'>-</mo>
       <mi>&#x3BC;</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>&#x22A4;</mi>
    </msup>
    <msup>
     <mi>V</mi>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3B2;</mi>
      <mo stretchy='false'>-</mo>
      <mi>&#x3BC;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>&#x3B3;</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mi>&#x3C8;</mi>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mi>&#x3D5;</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x393;</mi>
      <mrow>
       <mo>(</mo>
       <mi>&#x3D5;</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3D5;</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>&#x3B3;</mi>
    <mo stretchy='false'>-</mo>
    <mi>&#x3C8;</mi>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <mi>&#x3B3;</mi>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
Hence for the log sampling PDF we have
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>|</mo>
        <mi>w</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mfrac>
      <mtext>d</mtext>
      <mrow>
       <mtext>d</mtext>
       <mi>&#x3B2;</mi>
      </mrow>
     </mfrac>
     <mo>log</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>z</mi>
          <mi>i</mi>
         </msub>
         <mo stretchy='false'>|</mo>
         <mi>w</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mspace width="6px"/>
     <mo stretchy='false'>;</mo>
     <mspace width="6px"/>
     <mfrac>
      <mtext>d</mtext>
      <mrow>
       <mtext>d</mtext>
       <mi>&#x3B3;</mi>
      </mrow>
     </mfrac>
     <mo>log</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>z</mi>
          <mi>i</mi>
         </msub>
         <mo stretchy='false'>|</mo>
         <mi>w</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mfrac>
     <mtext>d</mtext>
     <mrow>
      <mtext>d</mtext>
      <mi>&#x3B2;</mi>
     </mrow>
    </mfrac>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>|</mo>
        <mi>w</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>-</mo>
      <msubsup>
       <mi>x</mi>
       <mi>i</mi>
       <mi>&#x22A4;</mi>
      </msubsup>
      <mi>&#x3B2;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mfrac>
     <mtext>d</mtext>
     <mrow>
      <mtext>d</mtext>
      <mi>&#x3B3;</mi>
     </mrow>
    </mfrac>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>|</mo>
        <mi>w</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mo stretchy='false'>+</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>y</mi>
        <mi>j</mi>
       </msub>
       <mo stretchy='false'>-</mo>
       <msubsup>
        <mi>x</mi>
        <mi>i</mi>
        <mi>&#x22A4;</mi>
       </msubsup>
       <mi>&#x3B2;</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 ...so<a id="eq__12" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>|</mo>
        <mi>w</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
          <mo stretchy='false'>-</mo>
          <msubsup>
           <mi>x</mi>
           <mi>i</mi>
           <mi>&#x22A4;</mi>
          </msubsup>
          <mi>&#x3B2;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>exp</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mi>&#x3B3;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <mo stretchy='false'>+</mo>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <msup>
         <mrow>
          <mo>(</mo>
          <mrow>
           <msub>
            <mi>y</mi>
            <mi>j</mi>
           </msub>
           <mo stretchy='false'>-</mo>
           <msubsup>
            <mi>x</mi>
            <mi>i</mi>
            <mi>&#x22A4;</mi>
           </msubsup>
           <mi>&#x3B2;</mi>
          </mrow>
          <mo>)</mo>
         </mrow>
         <mn>2</mn>
        </msup>
        <mo>exp</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mi>&#x3B3;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(4.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
Hence for the log a priori PDF we have
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mfrac>
      <mtext>d</mtext>
      <mrow>
       <mtext>d</mtext>
       <mi>&#x3B2;</mi>
      </mrow>
     </mfrac>
     <mo>log</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <mi>w</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mspace width="6px"/>
     <mo stretchy='false'>;</mo>
     <mspace width="6px"/>
     <mfrac>
      <mtext>d</mtext>
      <mrow>
       <mtext>d</mtext>
       <mi>&#x3B3;</mi>
      </mrow>
     </mfrac>
     <mo>log</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>f</mi>
       <mrow>
        <mo>(</mo>
        <mi>w</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mfrac>
     <mtext>d</mtext>
     <mrow>
      <mtext>d</mtext>
      <mi>&#x3B2;</mi>
     </mrow>
    </mfrac>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msup>
     <mi>V</mi>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3B2;</mi>
      <mo stretchy='false'>-</mo>
      <mi>&#x3BC;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mfrac>
     <mtext>d</mtext>
     <mrow>
      <mtext>d</mtext>
      <mi>&#x3B3;</mi>
     </mrow>
    </mfrac>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mi>d</mi>
     <mn>2</mn>
    </mfrac>
    <mo stretchy='false'>+</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>&#x3B2;</mi>
       <mo stretchy='false'>-</mo>
       <mi>&#x3BC;</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>&#x22A4;</mi>
    </msup>
    <msup>
     <mi>V</mi>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3B2;</mi>
      <mo stretchy='false'>-</mo>
      <mi>&#x3BC;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x3D5;</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <mi>&#x3C8;</mi>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x3B3;</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 ...so<a id="eq__13" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mo>exp</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mi>&#x3B3;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <msup>
         <mi>V</mi>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>&#x3B2;</mi>
          <mo stretchy='false'>-</mo>
          <mi>&#x3BC;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow>
        <mfrac>
         <mi>d</mi>
         <mn>2</mn>
        </mfrac>
        <mo stretchy='false'>+</mo>
        <mfrac>
         <mn>1</mn>
         <mn>2</mn>
        </mfrac>
        <mo>exp</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mi>&#x3B3;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <msup>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mi>&#x3B2;</mi>
           <mo stretchy='false'>-</mo>
           <mi>&#x3BC;</mi>
          </mrow>
          <mo>)</mo>
         </mrow>
         <mi>&#x22A4;</mi>
        </msup>
        <msup>
         <mi>V</mi>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>&#x3B2;</mi>
          <mo stretchy='false'>-</mo>
          <mi>&#x3BC;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>-</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>&#x3D5;</mi>
          <mo stretchy='false'>+</mo>
          <mn>1</mn>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>+</mo>
        <mi>&#x3C8;</mi>
        <mo>exp</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mi>&#x3B3;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>+</mo>
        <mn>1</mn>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(4.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 </div>
<h3 class='subsection_' id='magicparlabel-317'>Implementation of SGLD</h3>
<div class='standard' id='magicparlabel-318'>We consider <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3BC;</mi>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3D5;</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C8;</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>V</mi>
 <mo stretchy='false'>=</mo>
 <mn>100</mn>
 <msub>
  <mi>I</mi>
  <mi>d</mi>
 </msub>
</mrow>
</math>
, for our simulations below. </div>

<div class='standard' id='magicparlabel-319'>To implement SGD (Algorithm <a href="#alg_Batch_Stochastic_Gradient">14</a>) and SGLD (Algorithm <a href="#alg_Stochastic_Gradient_Langevin">21</a>) , we just need to plug in the computed gradients <a href="#eq__12">(4.1)</a> and <a href="#eq__13">(4.2)</a> for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x3B2;</mi>
   <mo stretchy='false'>,</mo>
   <mi>&#x3B3;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x00D7;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B3;</mi>
 <mo stretchy='false'>=</mo>
 <mo>log</mo>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>&#x3C3;</mi>
   <mn>2</mn>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. After running SGD and SGLD with the computed gradients with respect to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x3B2;</mi>
   <mo stretchy='false'>,</mo>
   <mi>&#x3B3;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x00D7;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B3;</mi>
 <mo stretchy='false'>=</mo>
 <mo>log</mo>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>&#x3C3;</mi>
   <mn>2</mn>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
, and obtaining chains <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msup>
      <mi>&#x3B2;</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
     <mo stretchy='false'>,</mo>
     <msup>
      <mi>&#x3B3;</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>}</mo>
 </mrow>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
 </mrow>
 <mi>T</mi>
</msubsup>
</math>
, we can just perform transformation <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msup>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>&#x3C3;</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
     <mo>)</mo>
    </mrow>
    <mn>2</mn>
   </msup>
   <mo stretchy='false'>=</mo>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <msup>
     <mi>&#x3B3;</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>}</mo>
 </mrow>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
 </mrow>
 <mi>T</mi>
</msubsup>
</math>
 if we are interested in learning <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mi>&#x3B2;</mi>
  <mo stretchy='false'>,</mo>
  <msup>
   <mi>&#x3C3;</mi>
   <mn>2</mn>
  </msup>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
.</div>

<div class='standard' id='magicparlabel-320'>In Figures <a href="#fig_">4.1</a>, we ran the SGD for different batch sizes <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 and compared it against the exact MLE. We observe that SGD trace converges to the exact MLE. The oscillations are due to the stochastic gradient (ie, noise in the gradient). </div>

<div class='standard' id='magicparlabel-321'>In Figures <a href="#fig__2">4.2</a>, we ran the SGLD for different batch sizes <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 but the same temperature <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C4;</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
 and compared it against the exact posterior densities. We observe that the histograms of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
 produced from SGLD are closer to the curves representing the exact posteriors when the batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 is bigger. As we said this is not a panacea; if the landscape of the exact psterior density was multimodal (aka not convex but with had several maxima), then the SGLD using smaller batch sizes could have performed better, in the sense that the inflated noise from the stochastic gradient could accidentally make the generated chain to pass the low mass barrier and visit a different mode, unlike the one with larger batch-size and hence smaller variation.</div>

<div class='standard' id='magicparlabel-322'>In Figures <a href="#fig__2_1">4.3</a>, we ran the SGLD for different temperatures <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C4;</mi>
</math>
 but the same batch sizes <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>m</mi>
 <mo stretchy='false'>=</mo>
 <mn>100</mn>
</mrow>
</math>
 and compared it against the exact posterior densities. We observe that increasing the temperature <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C4;</mi>
</math>
 may increase the variation of the produced chain. We can use a large <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C4;</mi>
</math>
 at the beginning of the run of the algorithm to perform an exploration of the space (this is particularly useful for non-convex/multimodal densities as it allows visiting different modes), and later on we can use a smaller temperature such as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C4;</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
. </div>

<div class='standard' id='magicparlabel-323'>
<br />
</div>


<div class='float-figure'>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-332'><img style='width:33%;' src='e_2285ee8d776d_SGD_w1_batch_size=10.png' alt='image: e_2285ee8d776d_SGD_w1_batch_size=10.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure a:  <a id="fig__1" /> </span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-340'><img style='width:33%;' src='e_cdc3ee3cb84d_SGD_w1_batch_size=100.png' alt='image: e_cdc3ee3cb84d_SGD_w1_batch_size=100.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure b:  <a id="fig__1_1" /> </span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-348'><img style='width:33%;' src='e_220d825b55fd_SGD_w1_batch_size=1000.png' alt='image: e_220d825b55fd_SGD_w1_batch_size=1000.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure c:  <a id="fig__1_2" /> </span></div>
</div>



<div class='float-figure'><div class='plain_layout' id='magicparlabel-357'><img style='width:33%;' src='e_2fa86f7f2d52_SGD_w2_batch_size=10.png' alt='image: e_2fa86f7f2d52_SGD_w2_batch_size=10.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure d:  <a id="fig__1_3" /> </span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-365'><img style='width:33%;' src='e_17b086aa5f8f_SGD_w2_batch_size=100.png' alt='image: e_17b086aa5f8f_SGD_w2_batch_size=100.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure e:  <a id="fig__1_1_1" /> </span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-373'><img style='width:33%;' src='e_535e72c2d724_SGD_w2_batch_size=1000.png' alt='image: e_535e72c2d724_SGD_w2_batch_size=1000.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure f:  <a id="fig__1_2_1" /> </span></div>
</div>



<div class='float-figure'><div class='plain_layout' id='magicparlabel-382'><img style='width:33%;' src='e_a61b4e675a36_SGD_w3_batch_size=10.png' alt='image: e_a61b4e675a36_SGD_w3_batch_size=10.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure g:  <a id="fig__1_3_1" /> </span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-390'><img style='width:33%;' src='e_9fd9d5e48959_SGD_w3_batch_size=100.png' alt='image: e_9fd9d5e48959_SGD_w3_batch_size=100.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure h:  <a id="fig__1_1_1_1" /> </span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-398'><img style='width:33%;' src='e_b61840ebe059_SGD_w3_batch_size=1000.png' alt='image: e_b61840ebe059_SGD_w3_batch_size=1000.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure i:  <a id="fig__1_2_1_1" /> </span></div>
</div>


<div class='plain_layout' id='magicparlabel-403'><span class='float-caption-Standard float-caption float-caption-standard'>Figure 4.1:  <a id="fig_" /> Bayesian learning via SGD (SGD vs (exact)MLE) Study on batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
. </span></div>


</div>



<div class='float-figure'>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-417'><img style='width:33%;' src='e_6aa72f77081f_SGLD_w1_batch_size=10.png' alt='image: e_6aa72f77081f_SGLD_w1_batch_size=10.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure a:  <a id="fig__1_4" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-425'><img style='width:33%;' src='e_0a26a4067b3e_SGLD_w1_batch_size=100.png' alt='image: e_0a26a4067b3e_SGLD_w1_batch_size=100.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure b:  <a id="fig__1_1_2" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-433'><img style='width:33%;' src='e_5f635b61869c_SGLD_w1_batch_size=1000.png' alt='image: e_5f635b61869c_SGLD_w1_batch_size=1000.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure c:  <a id="fig__1_2_2" /></span></div>
</div>



<div class='float-figure'><div class='plain_layout' id='magicparlabel-442'><img style='width:33%;' src='e_1e44e05c7d45_SGLD_w2_batch_size=10.png' alt='image: e_1e44e05c7d45_SGLD_w2_batch_size=10.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure d:  <a id="fig__1_3_2" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-450'><img style='width:33%;' src='e_9f74e373ff3e_SGLD_w2_batch_size=100.png' alt='image: e_9f74e373ff3e_SGLD_w2_batch_size=100.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure e:  <a id="fig__1_1_1_2" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-458'><img style='width:33%;' src='e_ecf5c9cb11aa_SGLD_w2_batch_size=1000.png' alt='image: e_ecf5c9cb11aa_SGLD_w2_batch_size=1000.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure f:  <a id="fig__1_2_1_2" /></span></div>
</div>



<div class='float-figure'><div class='plain_layout' id='magicparlabel-467'><img style='width:33%;' src='e_aac2622999cb_SGLD_w3_batch_size=10.png' alt='image: e_aac2622999cb_SGLD_w3_batch_size=10.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure g:  <a id="fig__1_3_1_1" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-475'><img style='width:33%;' src='e_90c48ad71e21_SGLD_w3_batch_size=100.png' alt='image: e_90c48ad71e21_SGLD_w3_batch_size=100.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure h:  <a id="fig__1_1_1_1_1" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-483'><img style='width:33%;' src='e_1486e42323a7_SGLD_w3_batch_size=1000.png' alt='image: e_1486e42323a7_SGLD_w3_batch_size=1000.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure i:  <a id="fig__1_2_1_1_1" /></span></div>
</div>


<div class='plain_layout' id='magicparlabel-488'><span class='float-caption-Standard float-caption float-caption-standard'>Figure 4.2:  <a id="fig__2" /> Bayesian learning: SGLD vs exact posterior (in red). Temperature <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C4;</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
. Study on batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
</span></div>
</div>



<div class='float-figure'>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-501'><img style='width:33%;' src='e_f78bb51116ad_SGLD_w1_tau=0_01.png' alt='image: e_f78bb51116ad_SGLD_w1_tau=0_01.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure a:  <a id="fig__1_4_1" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-509'><img style='width:33%;' src='e_49c5dc08da75_SGLD_w1_tau=1.png' alt='image: e_49c5dc08da75_SGLD_w1_tau=1.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure b:  <a id="fig__1_1_2_1" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-517'><img style='width:33%;' src='e_a1f7fdea66e8_SGLD_w1_tau=10.png' alt='image: e_a1f7fdea66e8_SGLD_w1_tau=10.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure c:  <a id="fig__1_2_2_1" /></span></div>
</div>



<div class='float-figure'><div class='plain_layout' id='magicparlabel-526'><img style='width:33%;' src='e_c51498d05283_SGLD_w2_tau=0_01.png' alt='image: e_c51498d05283_SGLD_w2_tau=0_01.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure d:  <a id="fig__1_3_2_1" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-534'><img style='width:33%;' src='e_92593a19fe1e_SGLD_w2_tau=1.png' alt='image: e_92593a19fe1e_SGLD_w2_tau=1.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure e:  <a id="fig__1_1_1_2_1" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-542'><img style='width:33%;' src='e_2b1c76ae3413_SGLD_w2_tau=10.png' alt='image: e_2b1c76ae3413_SGLD_w2_tau=10.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure f:  <a id="fig__1_2_1_2_1" /></span></div>
</div>



<div class='float-figure'><div class='plain_layout' id='magicparlabel-551'><img style='width:33%;' src='e_9276c4abda79_SGLD_w3_tau=0_01.png' alt='image: e_9276c4abda79_SGLD_w3_tau=0_01.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure g:  <a id="fig__1_3_1_1_1" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-559'><img style='width:33%;' src='e_a8b2fa2b4d95_SGLD_w3_tau=1.png' alt='image: e_a8b2fa2b4d95_SGLD_w3_tau=1.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure h:  <a id="fig__1_1_1_1_1_1" /></span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-567'><img style='width:33%;' src='e_00c87d4046bb_SGLD_w3_tau=10.png' alt='image: e_00c87d4046bb_SGLD_w3_tau=10.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure i:  <a id="fig__1_2_1_1_1_1" /></span></div>
</div>


<div class='plain_layout' id='magicparlabel-572'><span class='float-caption-Standard float-caption float-caption-standard'>Figure 4.3:  <a id="fig__2_1" /> Bayesian learning: SGLD vs exact posterior (in red). Batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo stretchy='false'>=</mo>
 <mn>100</mn>
</mrow>
</math>
. Study on <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C4;</mi>
</math>
</span></div>
</div>

</section>
</body>
</html>
