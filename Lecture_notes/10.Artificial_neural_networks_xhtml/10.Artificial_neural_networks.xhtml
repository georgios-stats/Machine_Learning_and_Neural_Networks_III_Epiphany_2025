<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta name="generator" content="LyX 2.4.2.1" />
<title>LyX Document</title>
<style>
/* LyX Provided Styles */
mstyle.math { font-style: italic; }

/* Layout-provided Styles */
div.standard {
text-align: left;

}
div.plain_layout {
text-align: left;

}
h3.subsection_ {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ol.enumi   { list-style-type: decimal; }
ol.enumii  { list-style-type: lower-latin; }
ol.enumiii { list-style-type: lower-roman; }
ol.enumiv  { list-style-type: upper-latin; }
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h2.section {
font-weight: normal;
font-style: normal;
font-variant: small-caps;
font-size: medium;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.theorem {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.theorem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.note {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.note_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.example {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.example_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.algorithm {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.algorithm_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
dl.description dt { font-weight: bold; }
div.notation {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.notation_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.definition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.definition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
h3.subsection {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
span.subsection_label {
font-weight: normal;
font-size: medium;

}
div.problem {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.problem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.solution_ {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.solution__label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
h4.subsubsection {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.4ex;
text-align: left;

}
div.remark {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.remark_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.Shadowbox { border: solid gray medium; border-bottom: solid black 1ex; border-right: solid black 1ex; padding: 0.5ex; }
span.foot_label {
	vertical-align: super;
	font-size: smaller;
	font-weight: bold;
	text-decoration: underline;
}
div.foot {
	display: inline;
	font-size: small;
	font-weight: normal;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
div.foot_inner { display: none; }
div.foot:hover div.foot_inner {
	display: block;
	border: 1px double black;
	margin: 0em 1em;
	padding: 1em;
}
div.marginal {
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
	background-color: #F0F0F0;
	float:right;
	font-size: small;
	font-weight: normal;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
div.float {
	border: 2px solid black;
	text-align: center;
}
div.float-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}
div.Boxed {
	border: solid thick black;
	padding: 0.5ex;
}


</style>
</head>
<body dir="auto">
<div class='standard' id='magicparlabel-1'><div class='Shadowbox'>

<div class='plain_layout' id='magicparlabel-10'>Machine Learning and Neural Networks (MATH3431)&#xA0;&#xA0;
Epiphany term, 2025<div style='height:3ex'></div></div>

<div class='plain_layout' style='text-align: center;' id='magicparlabel-11'> Lecture notes <a href="#enu_Handout___Artificial">enu:Handout-:-Artificial</a>: Artificial neural networks <div style='height:3ex'></div></div>

<div class='plain_layout' id='magicparlabel-28'>Lecturer &amp; author: Georgios P. Karagiannis 
<a href="mailto:georgios.karagiannis@durham.ac.uk">georgios.karagiannis@durham.ac.uk</a></div>

<div class='plain_layout' id='magicparlabel-29'><hr />
<div style='height:3ex'></div></div>
<h3 class='subsection_' id='magicparlabel-30'>Aim</h3>
<div class='plain_layout' id='magicparlabel-31'>To introduce the Artificial neural network as a model and procedure in classical and Bayesian framework. Motivation, set-up, description, computation, implementation, tricks. We focus on the Feedforward network.</div>

<div class='plain_layout' id='magicparlabel-32'><hr />
<div style='height:3ex'></div></div>
<h3 class='subsection_' id='magicparlabel-33'>Reading list &amp; references:</h3>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-34'><a id="enu_Bishop__C__M__" /> Bishop, C. M., &amp; Bishop, H. (2024). Deep learning: foundations and concepts. New York: Springer. <div class='foot'><span class="foot_label">1</span><div class="foot_inner"><div class='plain_layout' id='magicparlabel-38'>As alternative &amp; more compact see Ch. 5 Neural Networks from &#8220;Bishop, C. M. (2006). Pattern recognition and machine learning (Vol. 4, No. 4, p. 738). New York: Springer.&#8221;</div>
</div></div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-39'>Ch. 5, 6, 8, 9</li>
</ul>
</li><li class="enumerate_item" id='magicparlabel-58'>Bishop, C. M. (1995). Neural networks for pattern recognition. Oxford university press.
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-59'>Ch. 4 The multi-layer perceptron </li>
</ul>
</li><li class="enumerate_item" id='magicparlabel-60'><a id="enu_LeCun__Y___Bottou_" /> LeCun, Y., Bottou, L., Orr, G. B., &amp; MÃ¼ller, K. R. (2002). Efficient backprop. In Neural networks: Tricks of the trade (pp. 9-50). Berlin, Heidelberg: Springer Berlin Heidelberg.</li>
</ol>
</div></div>
<section>
<h2 class='section' id='magicparlabel-65'><span class="section_label">1</span> Intro and motivation </h2>
<div class='note'>
<div class="note_item" id='magicparlabel-74'><span class="note_label">Note 1.</span>
Artificial Neural Networks (NN) are statistical models which have mostly been developed from the algorithmic perspective of machine learning. They were originally created as an attempt to model the act of thinking by modeling neurons in a brain. In ML, NN are used as global approximators. </div>
</div>
<div class='standard' id='magicparlabel-80'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-81'><span class="example_label">Example 2.</span>
<a id="exa_Consider_a_regression" /> Consider a regression problem with predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x2192;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>q</mi>
 </msup>
</mrow>
</math>
, suitable for cases where the examples (data) consist of input <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>x</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
</mrow>
</math>
, and output targets <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>y</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>q</mi>
 </msup>
</mrow>
</math>
. An example of a <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>2</mn>
</math>
 layer artificial neural network formulating the predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>h</mi>
</math>
 is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>k</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mn>2</mn>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>w</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
     <mo stretchy='false'>,</mo>
     <mn>0</mn>
    </mrow>
   </msub>
   <mo stretchy='false'>+</mo>
   <munder>
    <mo>&#x2211;</mo>
    <mi>j</mi>
   </munder>
   <msub>
    <mi>w</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <msub>
    <mi>&#x3C3;</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>w</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>,</mo>
       <mi>j</mi>
       <mo stretchy='false'>,</mo>
       <mn>0</mn>
      </mrow>
     </msub>
     <mo stretchy='false'>+</mo>
     <munder>
      <mo>&#x2211;</mo>
      <mi>i</mi>
     </munder>
     <msub>
      <mi>w</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>,</mo>
       <mi>j</mi>
       <mo stretchy='false'>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>,</mo>
 <mspace width="6px"/>
 <mtext>for</mtext>
 <mspace width="6px"/>
 <mi>k</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>q</mi>
</mrow>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msub>
   <mi>&#x3C3;</mi>
   <mi>j</mi>
  </msub>
  <mrow>
   <mo>(</mo>
   <mo>&#x22C5;</mo>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 are known functions and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>w</mi>
  <mrow>
   <mo>&#x22C5;</mo>
   <mo stretchy='false'>,</mo>
   <mo>&#x22C5;</mo>
   <mo stretchy='false'>,</mo>
   <mo>&#x22C5;</mo>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 are unknown weights/coefficients. E.g., one may choose with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mn>2</mn>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>&#x3B1;</mi>
</mrow>
</math>
, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mn>1</mn>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>/</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>+</mo>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo stretchy='false'>-</mo>
     <mi>&#x3B1;</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. </div>
</div>


<div class='standard' id='magicparlabel-92'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-93'><span class="note_label">Note 3.</span>
<a id="rem_The_original_biological" /> The original biological motivation for feed-forward NN stems from McCulloch &amp; Pitts (1943) who published a seminal model of a NN as a binary thresholding device in discrete time, i.e. 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>n</mi>
  <mi>j</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>t</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mrow>
  <mo>(</mo>
  <mrow>
   <munder>
    <mo>&#x2211;</mo>
    <mrow>
     <mi>&#x2200;</mi>
     <mi>i</mi>
     <mo>&#x2192;</mo>
     <mi>j</mi>
    </mrow>
   </munder>
   <msub>
    <mi>w</mi>
    <mrow>
     <mi>j</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
   <msub>
    <mi>n</mi>
    <mi>i</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>-</mo>
     <mn>1</mn>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>&gt;</mo>
   <msub>
    <mi>&#x3B8;</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 where the sum is over neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
 connected to neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>j</mi>
</math>
; <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>n</mi>
  <mi>j</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>t</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is the output of neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
 at time <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mn>0</mn>
 <mo stretchy='false'>&lt;</mo>
 <msub>
  <mi>w</mi>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>&lt;</mo>
 <mn>1</mn>
</mrow>
</math>
 are attenuation weights. Thus the effect is to threshold a weighted sum of the inputs at value <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B8;</mi>
 <mi>i</mi>
</msub>
</math>
. Perhaps, such a mathematical model involving compositions of interconnected non-linear functions could be able to mimic human&#8217;s learning mechanism and be implemented in a computing environment (with faster computational abilities) with purpose to discover patters, make predictions, cluster, classify, etc...</div>
</div>


<div class='standard' id='magicparlabel-107'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-108'><span class="note_label">Note 4.</span>
<a id="rem_Mathematically__NN_are" /> Mathematically, NN are rooted in the classical theorem by Kolmogorov stating (informally) that every continuous function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 on <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mrow>
  <mo>[</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mn>1</mn>
  </mrow>
  <mo>]</mo>
 </mrow>
 <mi>d</mi>
</msup>
</math>
 can be written as <div class='marginal'><div class='plain_layout' id='magicparlabel-112'>no need 
<br />
to 
<br />
memorize 
<br />
the
<br />
formula <a href="#eq_FGADFGADRG">(1.1)</a></div>
</div> <a id="eq_FGADFGADRG" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mi>h</mi>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mrow>
      <mn>2</mn>
      <mi>d</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
    </munderover>
    <msub>
     <mi>F</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>j</mi>
        <mo stretchy='false'>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>d</mi>
      </munderover>
      <msub>
       <mi>G</mi>
       <mrow>
        <mi>i</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>x</mi>
        <mi>j</mi>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(1.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>G</mi>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>F</mi>
  <mi>i</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 are continuous functions whose form depends on <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>f</mi>
</math>
. Perhaps, one may speculate that functions <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>G</mi>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>F</mi>
  <mi>i</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 can be approximated by sigmoids or threshold functions of the form <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C3;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mi>&#x22A4;</mi>
   </msup>
   <mi>x</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 allowing the number of the tunable coefficients <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 to be high enough such that they can represent any function -hence the property of NN as global approximators.</div>
</div>
<div class='standard' id='magicparlabel-113'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-114'><span class="example_label">Example 5.</span>
<a id="exa_Recall_soft_SVM_in" /> Recall soft-SVM in (Example <a href="#exa_Consider_the_Soft_SVM">exa:Consider-the-Soft-SVM</a> in Handout <a href="#enu_Handout___Kernel">enu:Handout-:-Kernel</a>: Kernel methods); the predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>h</mi>
 <mi>&#x3C8;</mi>
</msup>
</math>
 had a formula <a id="eq__20" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>h</mi>
     <mi>&#x3C8;</mi>
    </msup>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mtext>sign</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>b</mi>
      <mo stretchy='false'>+</mo>
      <mrow>
       <mo>&#x27E8;</mo>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>,</mo>
        <mi>&#x3C8;</mi>
        <mrow>
         <mo>(</mo>
         <mi>x</mi>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>&#x27E9;</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mtext>sign</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>b</mi>
      <mo stretchy='false'>+</mo>
      <munder>
       <mo>&#x2211;</mo>
       <mi>j</mi>
      </munder>
      <msub>
       <mi>w</mi>
       <mi>j</mi>
      </msub>
      <msub>
       <mi>&#x3C8;</mi>
       <mi>j</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(1.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
with some embedding <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C8;</mi>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>&#x3C8;</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>&#x3C8;</mi>
     <mn>2</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mn>...</mn>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
 and unknown coefficients <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>w</mi>
  <mi>j</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
. Assume there is no prior info about how to specify the formula of the &#8220;ideal&#8221; embedding <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C8;</mi>
</math>
; then the scientist could try to parameterize <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C8;</mi>
</math>
 such as <a id="eq__19" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3C8;</mi>
     <mi>j</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mi>&#x3B6;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>&#x3C9;</mi>
       <mrow>
        <mi>j</mi>
        <mo stretchy='false'>,</mo>
        <mn>0</mn>
       </mrow>
      </msub>
      <mo stretchy='false'>+</mo>
      <munder>
       <mo>&#x2211;</mo>
       <mi>i</mi>
      </munder>
      <msub>
       <mi>&#x3C9;</mi>
       <mrow>
        <mi>j</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(1.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 for some chosen function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B6;</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and unknown coefficients <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>&#x3C9;</mi>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
, hopping that the unknown coefficients <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>&#x3C9;</mi>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 can be successfully tuned during the learning procedure against the dataset and hence result in an adaptive semi-parametric way to construct the the embedding <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C8;</mi>
</math>
 from the training data without his/her interference. Based on Note <a href="#rem_Mathematically__NN_are">4</a>, and assuming that a linear combination of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <mi>&#x3B6;</mi>
  <mrow>
   <mo>(</mo>
   <mo>&#x22C5;</mo>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
, specified as sigmoids, could acceptably enough represent the fluctuations of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msub>
   <mi>&#x3C8;</mi>
   <mi>j</mi>
  </msub>
  <mrow>
   <mo>(</mo>
   <mi>x</mi>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 in <a href="#eq__20">(1.2)</a>, such an attempt to &#8220;adaptively construct the embedding <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C8;</mi>
</math>
&#8221; might be successful. </div>
</div>
<div class='standard' id='magicparlabel-127'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-128'><span class="example_label">Example 6.</span>
(Cont Example <a href="#exa_Recall_soft_SVM_in">5</a> ) Having this in the mind, and while wanting to improve expressiveness, the scientist could become even more greedy, and consider the use of another embedding in <a href="#eq__19">(1.3)</a> as 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3C8;</mi>
     <mi>j</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mi>&#x3B6;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>&#x3C9;</mi>
       <mrow>
        <mi>j</mi>
        <mo stretchy='false'>,</mo>
        <mn>0</mn>
       </mrow>
      </msub>
      <mo stretchy='false'>+</mo>
      <munder>
       <mo>&#x2211;</mo>
       <mi>i</mi>
      </munder>
      <msub>
       <mi>&#x3C9;</mi>
       <mrow>
        <mi>j</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
      <msub>
       <mi>&#x3D5;</mi>
       <mi>i</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 whose bases <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3D5;</mi>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>&#x3D5;</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>&#x3D5;</mi>
     <mn>2</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mn>...</mn>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
 were parameterised as 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3D5;</mi>
     <mi>i</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mi>&#x3BE;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>&#x3D6;</mi>
       <mrow>
        <mi>i</mi>
        <mo stretchy='false'>,</mo>
        <mn>0</mn>
       </mrow>
      </msub>
      <mo stretchy='false'>+</mo>
      <munder>
       <mo>&#x2211;</mo>
       <mi>s</mi>
      </munder>
      <msub>
       <mi>&#x3D6;</mi>
       <mrow>
        <mi>i</mi>
        <mo stretchy='false'>,</mo>
        <mi>s</mi>
       </mrow>
      </msub>
      <msub>
       <mi>x</mi>
       <mi>s</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
for some chosen sigmoid <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3BE;</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and unknown coefficients <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>&#x3D6;</mi>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>s</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
. This recursive basis function composition creates a deep hierarchical structure which may improve approximation of the ideal embedding <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msub>
   <mi>&#x3C8;</mi>
   <mi>j</mi>
  </msub>
  <mrow>
   <mo>(</mo>
   <mi>x</mi>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
, and expressiveness of predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>h</mi>
 <mi>&#x3C8;</mi>
</msup>
</math>
 by sacrificing &#8220;interpretability&#8221; and &#8220;parsimony&#8221; of the &#8220;model&#8221;. </div>
</div>
<div class='standard' id='magicparlabel-129'>
<br />
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-130'><span class="section_label">2</span> Feedforward Neural Network (Mathematical set-up) </h2>
<div class='note'>
<div class="note_item" id='magicparlabel-131'><span class="note_label">Note 7.</span>
An (Artificial) Neural Network (NN) is an interconnection of several sigmoids or threshold functions associated and arranged in layers, such that the outputs of one layer form the input of the next layer. Formally the structure of these interconnections can be depicted as a directed graph <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>G</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 whose nodes <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>V</mi>
</mstyle>
</math>
 correspond to vertices/neurons and edges <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>E</mi>
</mstyle>
</math>
 correspond to links between them. </div>
</div>
<div class='standard' id='magicparlabel-145'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-146'><span class="note_label">Note 8.</span>
<a id="note_A_Feed_Forward_Neural" />A Feed-Forward Neural Network (FFNN) or else multi-layer perceptron is a special case of NN whose vertices can be numbered so that all connections go from a neuron (vertex) to one with a higher number. Hence, neurons (vertices) have one-way connections to other neurons such that the output of a lower numbered neuron feeds the input of the higher numbered neuron (in a forward manner). The neurons can be arranged in layers so that connections go from one layer to a later layer. FFNN can be depicted by a directed acyclic graph<div class='foot'><span class="foot_label">2</span><div class="foot_inner"><div class='plain_layout' id='magicparlabel-154'>(its vertices can be numbered so that all connections go from one vertex to another with a higher number)</div>
</div></div>, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>G</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. (See Figure <a href="#fig_Feed_forward_neural">2.1</a>). </div>
</div>

<div class='float-figure'><div class='plain_layout' id='magicparlabel-163'><img style='width:90%;' src='e_a2698e441c57_ffnn-pic.png' alt='image: e_a2698e441c57_ffnn-pic.png' /></div>

<div class='plain_layout' id='magicparlabel-164'><span class='float-caption-Standard float-caption float-caption-standard'>Figure 2.1:  <a id="fig_Feed_forward_neural" />Feed forward neural network (<math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
 hidden layer)</span></div>


</div>


<div class='standard' id='magicparlabel-170'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-171'><span class="note_label">Note 9.</span>
Here we restrict ourselves to FFNN only. </div>
</div>
<div class='standard' id='magicparlabel-176'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-177'><span class="note_label">Note 10.</span>
We assume that the network is organized in layers. The set of nodes is decomposed into a union of (nonempty) disjoint subsets 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>V</mi>
 <mo stretchy='false'>=</mo>
 <msubsup>
  <mo>&#x222A;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>0</mn>
  </mrow>
  <mi>T</mi>
 </msubsup>
 <msub>
  <mi>V</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
 such that every edge in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>E</mi>
</mstyle>
</math>
 connects a node from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mi>t</mi>
</msub>
</math>
 to a node from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>+</mo>
  <mn>1</mn>
 </mrow>
</msub>
</math>
, for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>T</mi>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-178'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-179'><span class="note_label">Note 11.</span>
The first layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mn>0</mn>
</msub>
</math>
 is called <b>input layer</b>. If <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>x</mi>
</math>
 has <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>d</mi>
</math>
 dimensions, then the first layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mn>0</mn>
</msub>
</math>
 contains <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>d</mi>
</math>
 nodes. </div>
</div>
<div class='standard' id='magicparlabel-180'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-181'><span class="note_label">Note 12.</span>
The last layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mi>T</mi>
</msub>
</math>
 is called <b>output layer</b>. If <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>y</mi>
</math>
 has <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>q</mi>
</math>
 dimensions, then the last layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mi>T</mi>
</msub>
</math>
 contains <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>q</mi>
</math>
 nodes. </div>
</div>
<div class='standard' id='magicparlabel-182'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-183'><span class="note_label">Note 13.</span>
The intermediate layers <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msub>
   <mi>V</mi>
   <mn>1</mn>
  </msub>
  <mo stretchy='false'>,</mo>
  <mn>...</mn>
  <mo stretchy='false'>,</mo>
  <msub>
   <mi>V</mi>
   <mrow>
    <mi>T</mi>
    <mo stretchy='false'>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 are called <b>hidden layers.</b> </div>
</div>
<div class='standard' id='magicparlabel-184'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-185'><span class="note_label">Note 14.</span>
In a neural network, the nodes of the graph <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>G</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 correspond to neurons. </div>
</div>
<div class='standard' id='magicparlabel-186'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-187'><span class="note_label">Note 15.</span>
The <b><math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
-th neuron of the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
-th layer </b>is denoted as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-188'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-189'><span class="note_label">Note 16.</span>
The output of neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
 in the input layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mn>0</mn>
</msub>
</math>
 is simply <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>x</mi>
 <mi>i</mi>
</msub>
</math>
 that is <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <mi>d</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-190'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-191'><span class="note_label">Note 17.</span>
Each edge in the graph <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <msub>
   <mi>v</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>,</mo>
    <mi>j</mi>
   </mrow>
  </msub>
  <mo stretchy='false'>,</mo>
  <msub>
   <mi>v</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
    <mo stretchy='false'>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 links the output of some neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>,</mo>
  <mi>j</mi>
 </mrow>
</msub>
</math>
 to the input of another neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>+</mo>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
; i.e. <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-192'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-193'><span class="note_label">Note 18.</span>
We define a <b>weight function</b> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo stretchy='false'>:</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 over the edges <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>E</mi>
</mstyle>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-194'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-195'><span class="note_label">Note 19.</span>
<b>Activation</b> of neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
 at hidden layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
 is the weighted sum of the outputs <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
</mrow>
</math>
 of the neurons in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mn>0</mn>
</msub>
</math>
 which are connected to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
 where weighting is according to function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
, that is<a id="eq_wrgrsdfgsdfgsdg_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <munder>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>&#x2200;</mi>
      <mi>j</mi>
      <mo stretchy='false'>:</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>v</mi>
         <mrow>
          <mn>0</mn>
          <mo stretchy='false'>,</mo>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>v</mi>
         <mrow>
          <mn>1</mn>
          <mo stretchy='false'>,</mo>
          <mi>i</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo>&#x2208;</mo>
      <mstyle mathvariant='script'>
       <mi>E</mi>
      </mstyle>
     </mrow>
    </munder>
    <mi>w</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>v</mi>
        <mrow>
         <mn>0</mn>
         <mo stretchy='false'>,</mo>
         <mi>j</mi>
        </mrow>
       </msub>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>v</mi>
        <mrow>
         <mn>1</mn>
         <mo stretchy='false'>,</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-196'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-197'><span class="note_label">Note 20.</span>
Each single neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
 is modeled as a simple scalar function, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>t</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>:</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
, called <b>activation function</b> at layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-198'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-199'><span class="note_label">Note 21.</span>
<b>The output of neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
</b> when the network is fed with the input <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>x</mi>
</math>
 is denoted as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>-</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-200'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-201'><span class="note_label">Note 22.</span>
Activation of neuron <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
 at layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
 is the weighted sum of the outputs <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 of the neurons in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>-</mo>
  <mn>1</mn>
 </mrow>
</msub>
</math>
 which are connected to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
 where weighting is according to function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
, that is<a id="eq_wrgrsdfgsdfgsdg" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <munder>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>&#x2200;</mi>
      <mi>j</mi>
      <mo stretchy='false'>:</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>v</mi>
         <mrow>
          <mi>t</mi>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
          <mo stretchy='false'>,</mo>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>v</mi>
         <mrow>
          <mi>t</mi>
          <mo stretchy='false'>,</mo>
          <mi>i</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo>&#x2208;</mo>
      <mstyle mathvariant='script'>
       <mi>E</mi>
      </mstyle>
     </mrow>
    </munder>
    <mi>w</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>-</mo>
         <mn>1</mn>
         <mo stretchy='false'>,</mo>
         <mi>j</mi>
        </mrow>
       </msub>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>,</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msub>
     <mi>o</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-202'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-203'><span class="note_label">Note 23.</span>
The input to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>+</mo>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
 is activation <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 namely a weighted sum of the outputs <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 of the neurons in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mi>t</mi>
</msub>
</math>
 which are connected to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>+</mo>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
, where weighting is according to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
. The output of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>+</mo>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
 is the application of the activation function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 on its input <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-209'>
<br />
</div>
<div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-210'><span class="algorithm_label">Algorithm 24.</span>
<a id="def_To_sum_up__The" /> The feed-forward NN formula in a layer by layer manner is performed (defined) according to the following recursion. </div>
<dl class='description'>
<dt class="description_label">At&#xA0;<math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
,</dt>
<dd class="description_item" id='magicparlabel-211'><i> for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mrow>
  <mo>|</mo>
  <msub>
   <mi>V</mi>
   <mn>0</mn>
  </msub>
  <mo>|</mo>
 </mrow>
</mrow>
</math>
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
</mrow>
</math>
</i></dd>
<dt class="description_label">At&#xA0;<math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>T</mi>
 <mo stretchy='false'>-</mo>
 <mn>1</mn>
</mrow>
</math>
,</dt>
<dd class="description_item" id='magicparlabel-212'><i> for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mrow>
  <mo>|</mo>
  <msub>
   <mi>V</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <mo>|</mo>
 </mrow>
</mrow>
</math>
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <munder>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>&#x2200;</mi>
      <mi>j</mi>
      <mo stretchy='false'>:</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>v</mi>
         <mrow>
          <mi>t</mi>
          <mo stretchy='false'>,</mo>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>v</mi>
         <mrow>
          <mi>t</mi>
          <mo stretchy='false'>+</mo>
          <mn>1</mn>
          <mo stretchy='false'>,</mo>
          <mi>i</mi>
         </mrow>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo>&#x2208;</mo>
      <mstyle mathvariant='script'>
       <mi>E</mi>
      </mstyle>
     </mrow>
    </munder>
    <mi>w</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>,</mo>
         <mi>j</mi>
        </mrow>
       </msub>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>+</mo>
         <mn>1</mn>
         <mo stretchy='false'>,</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msub>
     <mi>o</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>o</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3C3;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>+</mo>
        <mn>1</mn>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</i></dd>
</dl>
</div>
<div class='standard' id='magicparlabel-213'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-214'><span class="note_label">Note 25.</span>
<b>Depth</b> of the NN is the number of the layers excluding the input layer; i.e. <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>T</mi>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-215'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-216'><span class="note_label">Note 26.</span>
<b>Size</b> of the network is the number <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>|</mo>
 <mi>V</mi>
 <mo>|</mo>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-217'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-218'><span class="note_label">Note 27.</span>
<b>Width</b> of the NN is the number <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <munder>
  <mo>max</mo>
  <mrow>
   <mi>&#x2200;</mi>
   <mi>t</mi>
  </mrow>
 </munder>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>|</mo>
   <msub>
    <mi>V</mi>
    <mi>t</mi>
   </msub>
   <mo>|</mo>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-219'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-220'><span class="note_label">Note 28.</span>
The <b>architecture</b> of the neural network is defined by the triplet <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <msub>
   <mi>&#x3C3;</mi>
   <mi>t</mi>
  </msub>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-221'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-222'><span class="note_label">Note 29.</span>
The neural network can be fully specified by the quadruplet <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <msub>
   <mi>&#x3C3;</mi>
   <mi>t</mi>
  </msub>
  <mo stretchy='false'>,</mo>
  <mi>w</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-223'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-224'><span class="example_label">Example 30.</span>
Figure <a href="#fig_Feed_forward_neural">2.1</a> denotes a NN with depth 2, size 11, width 5. The neuron with no incoming edges has <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>5</mn>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mi>&#x3C3;</mi>
 <mrow>
  <mo>(</mo>
  <mn>0</mn>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-225'>
<br />
</div>
<div class='notation'>
<div class="notation_item" id='magicparlabel-226'><span class="notation_label">Notation 31.</span>
To easy the notation, we denote the weights as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>w</mi>
  <mrow>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy='false'>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <mi>w</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>v</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>v</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. Using this notation, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>w</mi>
  <mrow>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy='false'>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
 is equivalent in <a href="#eq_wrgrsdfgsdfgsdg">(2.2)</a> to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mrow>
  <mo>/</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
</mrow>
</math>
 and means that the link <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>v</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>&#x2192;</mo>
 <msub>
  <mi>v</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
</mrow>
</math>
 is not in the network. </div>
</div>
<div class='standard' id='magicparlabel-227'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-228'><span class="note_label">Note 32.</span>
Often a <b>constant neuron</b> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>,</mo>
  <mn>0</mn>
 </mrow>
</msub>
</math>
 (at each layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
) which outputs <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
; i.e. <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mn>0</mn>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mn>0</mn>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
. The corresponding weight <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mrow>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
  <mo stretchy='false'>,</mo>
  <mi>k</mi>
  <mo stretchy='false'>,</mo>
  <mn>0</mn>
 </mrow>
</msub>
</math>
 is called <b>bias</b>. This resembles to the constant term in the linear regression.</div>
</div>
<div class='standard' id='magicparlabel-229'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-230'><span class="example_label">Example 33.</span>
<a id="exa__Cont__Example___1" />(Cont. Example <a href="#exa_Consider_a_regression">2</a>) The <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>2</mn>
</math>
 layer neural network <a id="eq_" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>&#x3C3;</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mn>2</mn>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>w</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>2</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
        <mo stretchy='false'>,</mo>
        <mn>0</mn>
       </mrow>
      </msub>
      <mo stretchy='false'>+</mo>
      <munder>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>&#x2200;</mi>
        <mi>j</mi>
       </mrow>
      </munder>
      <msub>
       <mi>w</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>2</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
      <msub>
       <mi>&#x3C3;</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mn>1</mn>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>w</mi>
         <mrow>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mn>1</mn>
           <mo stretchy='false'>)</mo>
          </mrow>
          <mo stretchy='false'>,</mo>
          <mi>j</mi>
          <mo stretchy='false'>,</mo>
          <mn>0</mn>
         </mrow>
        </msub>
        <mo stretchy='false'>+</mo>
        <munder>
         <mo>&#x2211;</mo>
         <mrow>
          <mi>&#x2200;</mi>
          <mi>i</mi>
         </mrow>
        </munder>
        <msub>
         <mi>w</mi>
         <mrow>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mn>1</mn>
           <mo stretchy='false'>)</mo>
          </mrow>
          <mo stretchy='false'>,</mo>
          <mi>j</mi>
          <mo stretchy='false'>,</mo>
          <mi>i</mi>
         </mrow>
        </msub>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
can be written according to the recursion in Algorithm <a href="#def_To_sum_up__The">24</a> as</div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-231'>Input layer
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mn>0</mn>
    <mo stretchy='false'>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
 <mtable>
  <mtr>
   <mtd>
    <mn>1</mn>
   </mtd>
   <mtd>
    <mrow>
     <mi>i</mi>
     <mo stretchy='false'>=</mo>
     <mn>0</mn>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
   </mtd>
   <mtd>
    <mrow>
     <mi>i</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mn>...</mn>
     <mo stretchy='false'>,</mo>
     <mi>d</mi>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</mrow>
</math>
</li>
<li class="itemize_item" id='magicparlabel-232'>Hidden layer
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mn>1</mn>
       <mo stretchy='false'>)</mo>
      </mrow>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>w</mi>
     <mrow>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mn>1</mn>
       <mo stretchy='false'>)</mo>
      </mrow>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
      <mo stretchy='false'>,</mo>
      <mn>0</mn>
     </mrow>
    </msub>
    <mo stretchy='false'>+</mo>
    <munder>
     <mo>&#x2211;</mo>
     <mi>j</mi>
    </munder>
    <msub>
     <mi>w</mi>
     <mrow>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mn>1</mn>
       <mo stretchy='false'>)</mo>
      </mrow>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>o</mi>
     <mrow>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mn>1</mn>
       <mo stretchy='false'>)</mo>
      </mrow>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>&#x3C3;</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mn>1</mn>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>1</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>&#x3C3;</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mn>1</mn>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>w</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>1</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
        <mo stretchy='false'>,</mo>
        <mn>0</mn>
       </mrow>
      </msub>
      <mo stretchy='false'>+</mo>
      <munder>
       <mo>&#x2211;</mo>
       <mi>j</mi>
      </munder>
      <msub>
       <mi>w</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>1</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="itemize_item" id='magicparlabel-233'>Output layer
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mn>2</mn>
       <mo stretchy='false'>)</mo>
      </mrow>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>w</mi>
     <mrow>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mn>2</mn>
       <mo stretchy='false'>)</mo>
      </mrow>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
      <mo stretchy='false'>,</mo>
      <mn>0</mn>
     </mrow>
    </msub>
    <mo stretchy='false'>+</mo>
    <munder>
     <mo>&#x2211;</mo>
     <mi>j</mi>
    </munder>
    <msub>
     <mi>w</mi>
     <mrow>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mn>2</mn>
       <mo stretchy='false'>)</mo>
      </mrow>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <msub>
     <mi>o</mi>
     <mrow>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mn>1</mn>
       <mo stretchy='false'>)</mo>
      </mrow>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>o</mi>
     <mrow>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mn>2</mn>
       <mo stretchy='false'>)</mo>
      </mrow>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>&#x3C3;</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mn>2</mn>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>2</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>&#x3C3;</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mn>2</mn>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>w</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>2</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
        <mo stretchy='false'>,</mo>
        <mn>0</mn>
       </mrow>
      </msub>
      <mo stretchy='false'>+</mo>
      <munder>
       <mo>&#x2211;</mo>
       <mi>j</mi>
      </munder>
      <msub>
       <mi>w</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>2</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
      <msub>
       <mi>o</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>2</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
</ul>
<div class='standard' id='magicparlabel-234'>If <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>k</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 returns values in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='double-struck'>
 <mi>R</mi>
</mstyle>
</math>
, we can choose <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3C3;</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mn>2</mn>
  <mo stretchy='false'>)</mo>
 </mrow>
</msub>
</math>
 as the identity function i.e., <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mn>2</mn>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>&#x3B1;</mi>
</mrow>
</math>
. Note that <a href="#eq_">(2.3)</a> is also presented more compact<a id="eq_ergtgqert" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>&#x3C3;</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mn>2</mn>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munder>
       <mo>&#x2211;</mo>
       <mi>j</mi>
      </munder>
      <msub>
       <mi>w</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>2</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
      <msub>
       <mi>&#x3C3;</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mn>1</mn>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <munder>
         <mo>&#x2211;</mo>
         <mi>i</mi>
        </munder>
        <msub>
         <mi>w</mi>
         <mrow>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mn>1</mn>
           <mo stretchy='false'>)</mo>
          </mrow>
          <mo stretchy='false'>,</mo>
          <mi>j</mi>
          <mo stretchy='false'>,</mo>
          <mi>i</mi>
         </mrow>
        </msub>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.4)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 by considering the constant neuron associated with first <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>x</mi>
</math>
 which is set equal to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
, e.g <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>x</mi>
  <mn>1</mn>
 </msub>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
, similar to the linear regression models.</div>
</div>
<div class='standard' id='magicparlabel-235'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-236'><span class="note_label">Note 34.</span>
<a id="rem_Activation_functions_" />Activation functions <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3C3;</mi>
 <mi>t</mi>
</msub>
</math>
 are non-increasing functions often sigmoids or threshold functions. Their choice is problem-dependent. some examples </div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-237'>Identity function: <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C3;</mi>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>&#x3B1;</mi>
</mrow>
</math>
 cannot be used in hidden layers</li>
<li class="itemize_item" id='magicparlabel-238'>Threshold sigmoid: <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C3;</mi>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x3B1;</mi>
   <mo stretchy='false'>&gt;</mo>
   <mn>0</mn>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</li>
<li class="itemize_item" id='magicparlabel-239'>Logistic sigmoid: <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3C3;</mi>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>+</mo>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo stretchy='false'>-</mo>
     <mi>&#x3B1;</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mfrac>
</mrow>
</math>
</li>
<li class="itemize_item" id='magicparlabel-240'>Rectified linear unit: <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>RELU</mtext>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo>max</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x3B1;</mi>
   <mo stretchy='false'>,</mo>
   <mn>0</mn>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</li>
</ul>
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-250'><span class="example_label">Example 35.</span>
Examples on the choice of the activation function at the output layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>T</mi>
</math>
: </div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-251'>In the univariate regression problem with prediction rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
, and examples <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>z</mi>
  <mi>i</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x00D7;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
, we can choose <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>&#x3B1;</mi>
</mrow>
</math>
 to get <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>&#x3B1;</mi>
</mrow>
</math>
.</li>
<li class="itemize_item" id='magicparlabel-252'>In the binary logistic regression problem with prediction rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mrow>
  <mo>[</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mn>1</mn>
  </mrow>
  <mo>]</mo>
 </mrow>
</mrow>
</math>
 and examples <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>z</mi>
  <mi>i</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x00D7;</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mn>1</mn>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
, we can choose <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>+</mo>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo stretchy='false'>-</mo>
     <mi>&#x3B1;</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mfrac>
</mrow>
</math>
 to get <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>+</mo>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo stretchy='false'>-</mo>
     <mi>&#x3B1;</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mfrac>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mrow>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mi>&#x3B1;</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>+</mo>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mi>&#x3B1;</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mfrac>
</mrow>
</math>
.</li>
</ul>
</div>
<div class='standard' id='magicparlabel-253'>
<br />
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-254'><span class="section_label">3</span> <a id="sec_Learning_Neural_Networks" />Learning Neural Networks</h2>


<div class='standard' id='magicparlabel-263'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-264'><span class="note_label">Note 36.</span>
<a id="note_Assume_we_are" />Assume we are interested in a prediction rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mi>&#x3C3;</mi>
   <mo stretchy='false'>,</mo>
   <mi>w</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <msub>
    <mi>V</mi>
    <mn>0</mn>
   </msub>
   <mo>|</mo>
  </mrow>
 </msup>
 <mo>&#x2192;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <msub>
    <mi>V</mi>
    <mi>T</mi>
   </msub>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
 which is modeled as a feed-forward Neural Network with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x3C3;</mi>
  <mo stretchy='false'>,</mo>
  <mi>w</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
; that is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>h</mi>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mi>&#x3C3;</mi>
   <mo stretchy='false'>,</mo>
   <mi>w</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mi>T</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>o</mi>
     <mrow>
      <mi>T</mi>
      <mo stretchy='false'>,</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>o</mi>
     <mrow>
      <mi>T</mi>
      <mo stretchy='false'>,</mo>
      <mrow>
       <mo>|</mo>
       <msub>
        <mi>V</mi>
        <mi>T</mi>
       </msub>
       <mo>|</mo>
      </mrow>
     </mrow>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
 is according to the Algorithm <a href="#def_To_sum_up__The">24</a>.</div>
</div>
<div class='standard' id='magicparlabel-265'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-266'><span class="note_label">Note 37.</span>
Learning the architecture <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x3C3;</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 of a neural network is a model selection task (recall the variable selection in linear regression). </div>
</div>
<div class='standard' id='magicparlabel-267'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-268'><span class="note_label">Note 38.</span>
We assume that the architecture <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x3C3;</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 of the neural network <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x3C3;</mi>
  <mo stretchy='false'>,</mo>
  <mi>w</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 is fixed (given/known), and that there is interest in learning the weight function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo stretchy='false'>:</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 or equivalently in vector form the vector of weights <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>w</mi>
  <mrow>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy='false'>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>w</mi>
  <mrow>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
    </mrow>
    <mo stretchy='false'>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <mi>w</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>v</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>v</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-269'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-270'><span class="note_label">Note 39.</span>
The class of hypotheses is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mstyle mathvariant='script'>
   <mi>H</mi>
  </mstyle>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mi>&#x3C3;</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>h</mi>
    <mrow>
     <mstyle mathvariant='script'>
      <mi>V</mi>
     </mstyle>
     <mo stretchy='false'>,</mo>
     <mstyle mathvariant='script'>
      <mi>E</mi>
     </mstyle>
     <mo stretchy='false'>,</mo>
     <mi>&#x3C3;</mi>
     <mo stretchy='false'>,</mo>
     <mi>w</mi>
    </mrow>
   </msub>
   <mo stretchy='false'>:</mo>
   <mspace width="6px"/>
   <mtext>for&#0160;all</mtext>
   <mspace width="6px"/>
   <mi>w</mi>
   <mo stretchy='false'>:</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo>&#x2192;</mo>
   <mstyle mathvariant='double-struck'>
    <mi>R</mi>
   </mstyle>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 for given <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x3C3;</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 . </div>
</div>
<div class='standard' id='magicparlabel-271'>
<br />
</div>
<div class='notation'>
<div class="notation_item" id='magicparlabel-272'><span class="notation_label">Notation 40.</span>
To simplify notation we will use <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>h</mi>
 <mi>w</mi>
</msub>
</math>
 instead of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>h</mi>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x3C3;</mi>
  <mo stretchy='false'>,</mo>
  <mi>w</mi>
 </mrow>
</msub>
</math>
 as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>V</mi>
 </mstyle>
 <mo stretchy='false'>,</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
 <mo stretchy='false'>,</mo>
 <mi>&#x3C3;</mi>
</mrow>
</math>
 is fixed here. </div>
</div>
<div class='standard' id='magicparlabel-273'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-274'><span class="note_label">Note 41.</span>
Assume that there is available a training set of examples (data-set) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>S</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <mi>n</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>X</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <msub>
    <mi>V</mi>
    <mn>0</mn>
   </msub>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>y</mi>
  <mi>i</mi>
 </msub>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>Y</mi>
 </mstyle>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-275'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-276'><span class="note_label">Note 42.</span>
<a id="note_To_learn_the" /> To learn the unknown <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
, we need to specify a loss function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 at some value of weight vector <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
 and at some example <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>z</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>x</mi>
   <mo stretchy='false'>,</mo>
   <mi>y</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-292'>
<br />
</div>
<div class='definition'>
<div class="definition_item" id='magicparlabel-293'><span class="definition_label">Definition 43.</span>
<a id="def_Error_function_is" />Error function is a performance measure that can be defined as<a id="eq__3" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mtext>EF</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>|</mo>
      <mrow>
       <mo>{</mo>
       <msubsup>
        <mi>z</mi>
        <mi>i</mi>
        <mo stretchy='false'>*</mo>
       </msubsup>
       <mo>}</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <msubsup>
       <mi>z</mi>
       <mi>i</mi>
       <mo stretchy='false'>*</mo>
      </msubsup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <msup>
   <mi>S</mi>
   <mo stretchy='false'>*</mo>
  </msup>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msubsup>
    <mi>z</mi>
    <mi>i</mi>
    <mo stretchy='false'>*</mo>
   </msubsup>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msubsup>
      <mi>x</mi>
      <mi>i</mi>
      <mo stretchy='false'>*</mo>
     </msubsup>
     <mo stretchy='false'>,</mo>
     <msubsup>
      <mi>y</mi>
      <mi>i</mi>
      <mo stretchy='false'>*</mo>
     </msubsup>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <msup>
    <mi>n</mi>
    <mo stretchy='false'>*</mo>
   </msup>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 is a set of examples which does not necessarily need to be the training set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>S</mi>
</mstyle>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-299'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-300'><span class="example_label">Example 44.</span>
(Regression problem) Assume we wish to predict the mapping <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>x</mi>
 <mover accent='false'>
  <mo>&#x2192;</mo>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo>(</mo>
    <mo>&#x22C5;</mo>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mover>
 <mi>y</mi>
</mrow>
</math>
, where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>x</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>y</mi>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
. Consider a predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
 <mn>.</mn>
</mrow>
</math>
 Assume a training data-set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>}</mo>
 </mrow>
 <mn>.</mn>
</mrow>
</math>
 </div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-301'>The output activation function can be the identity function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>a</mi>
</mrow>
</math>
. This is because <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>&#x3B1;</mi>
    <mi>T</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 by Algorithm <a href="#def_To_sum_up__The">24</a> and Note <a href="#note_Assume_we_are">36</a>. Since <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>h</mi>
 <mi>w</mi>
</msub>
</math>
 returns in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='double-struck'>
 <mi>R</mi>
</mstyle>
</math>
 and the output activation <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 returns in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='double-struck'>
 <mi>R</mi>
</mstyle>
</math>
, then mapping <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>a</mi>
</mrow>
</math>
 suffices.</li>
<li class="itemize_item" id='magicparlabel-302'>A reasonable loss can be the Euclidean distance 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mn>2</mn>
 </mfrac>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mi>y</mi>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mn>2</mn>
 </msup>
</mrow>
</math>
</li>
<li class="itemize_item" id='magicparlabel-303'>The same loss results as the minus log-likehihood of a specified statistical model <a id="eq__9" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>|</mo>
    <mi>x</mi>
    <mo stretchy='false'>,</mo>
    <mi>w</mi>
    <mover accent='false'>
     <mo>&#x223C;</mo>
     <mtext>ind</mtext>
    </mover>
    <mtext>N</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mstyle class='math'>
       <msub>
        <mi>&#x3BC;</mi>
        <mi>i</mi>
       </msub>
      </mstyle>
      <mo stretchy='false'>,</mo>
      <msup>
       <mi>&#x3B2;</mi>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mtext>where</mtext>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <msub>
     <mi>&#x3BC;</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
for some fixed <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B2;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
, i.e. 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
      <mo stretchy='false'>=</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>x</mi>
        <mo stretchy='false'>,</mo>
        <mi>y</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mtext>N</mtext>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>y</mi>
        <mo stretchy='false'>|</mo>
        <msub>
         <mi>h</mi>
         <mi>w</mi>
        </msub>
        <mrow>
         <mo>(</mo>
         <mi>x</mi>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <msup>
         <mi>&#x3B2;</mi>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo stretchy='false'>=</mo>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>2</mn>
         <mi>&#x3C0;</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>&#x3B2;</mi>
        <mrow>
         <mo stretchy='false'>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mfrac>
       <msup>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>h</mi>
           <mi>w</mi>
          </msub>
          <mrow>
           <mo>(</mo>
           <mi>x</mi>
           <mo>)</mo>
          </mrow>
          <mo stretchy='false'>-</mo>
          <mi>y</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <msup>
        <mi>&#x3B2;</mi>
        <mrow>
         <mo stretchy='false'>-</mo>
         <mn>1</mn>
        </mrow>
       </msup>
      </mfrac>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo stretchy='false'>=</mo>
  </mtd>
  <mtd>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <mi>&#x3B2;</mi>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>h</mi>
        <mi>w</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
       </mrow>
       <mo stretchy='false'>-</mo>
       <mi>y</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo stretchy='false'>+</mo>
    <mtext>const</mtext>
    <mn>...</mn>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="itemize_item" id='magicparlabel-304'>The Error function is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mtext>EF</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>|</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>n</mi>
 </munderover>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mn>2</mn>
 </mfrac>
 <mi>&#x3B2;</mi>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>n</mi>
 </munderover>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mn>2</mn>
 </msup>
 <mo stretchy='false'>+</mo>
 <mtext>const</mtext>
 <mn>...</mn>
</mrow>
</math>
</li>
</ul>
</div>
<div class='standard' id='magicparlabel-305'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-306'><span class="example_label">Example 45.</span>
(Multi-output regression problem) Assume we wish to predict the mapping <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>x</mi>
 <mover accent='false'>
  <mo>&#x2192;</mo>
  <mrow>
   <mi>h</mi>
   <mrow>
    <mo>(</mo>
    <mo>&#x22C5;</mo>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mover>
 <mi>y</mi>
</mrow>
</math>
, where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>x</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>y</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>q</mi>
 </msup>
</mrow>
</math>
. Consider a predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x2192;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>q</mi>
 </msup>
 <mn>.</mn>
</mrow>
</math>
 Assume a training data-set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>}</mo>
 </mrow>
 <mn>.</mn>
</mrow>
</math>
 </div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-307'>The output activation function is the identity function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>a</mi>
</mrow>
</math>
. This is because <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>T</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>T</mi>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>k</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>q</mi>
</mrow>
</math>
 by Algorithm <a href="#def_To_sum_up__The">24</a> and Note <a href="#note_Assume_we_are">36</a>. Since <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>h</mi>
 <mi>w</mi>
</msub>
</math>
 returns in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
 <mi>q</mi>
</msup>
</math>
 and the output activation is <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='double-struck'>
 <mi>R</mi>
</mstyle>
</math>
, then mapping <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>a</mi>
</mrow>
</math>
 suffices.</li>
<li class="itemize_item" id='magicparlabel-308'>A reasonable loss can be an ellipsoidal norm
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mi>y</mi>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
 <mi>P</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>w</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>-</mo>
   <mi>y</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>,</mo>
 <mspace width="10px"/>
 <mtext>for&#0160;some</mtext>
 <mspace width="10px"/>
 <mi>P</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
</li>
<li class="itemize_item" id='magicparlabel-313'>The same loss results as the minus log-likehihood of a specified statistical model <a id="eq__10" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>|</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>,</mo>
    <mi>w</mi>
    <mover accent='false'>
     <mo>&#x223C;</mo>
     <mtext>ind</mtext>
    </mover>
    <mtext>N</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mstyle class='math'>
       <mi>&#x3BC;</mi>
      </mstyle>
      <mo stretchy='false'>,</mo>
      <msup>
       <mi>P</mi>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mtext>where</mtext>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <msub>
     <mi>&#x3BC;</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
for some fixed precision matrix <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>P</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
, i.e. 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
      <mo stretchy='false'>=</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>x</mi>
        <mo stretchy='false'>,</mo>
        <mi>y</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mtext>N</mtext>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>y</mi>
        <mo stretchy='false'>|</mo>
        <msub>
         <mi>h</mi>
         <mi>w</mi>
        </msub>
        <mrow>
         <mo>(</mo>
         <mi>x</mi>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <msup>
         <mi>P</mi>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo stretchy='false'>=</mo>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mi>q</mi>
       <mn>2</mn>
      </mfrac>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mfrac>
        <mn>1</mn>
        <mrow>
         <mn>2</mn>
         <mi>&#x3C0;</mi>
        </mrow>
       </mfrac>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mo>|</mo>
        <mi>P</mi>
        <mo>|</mo>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mn>1</mn>
       <mn>2</mn>
      </mfrac>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>h</mi>
          <mi>w</mi>
         </msub>
         <mrow>
          <mo>(</mo>
          <mi>x</mi>
          <mo>)</mo>
         </mrow>
         <mo stretchy='false'>-</mo>
         <mi>y</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mi>&#x22A4;</mi>
      </msup>
      <mi>P</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>h</mi>
         <mi>w</mi>
        </msub>
        <mrow>
         <mo>(</mo>
         <mi>x</mi>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>-</mo>
        <mi>y</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo stretchy='false'>=</mo>
  </mtd>
  <mtd>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>h</mi>
        <mi>w</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
       </mrow>
       <mo stretchy='false'>-</mo>
       <mi>y</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>&#x22A4;</mi>
    </msup>
    <mi>P</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>y</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <mtext>const</mtext>
    <mn>...</mn>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="itemize_item" id='magicparlabel-314'>The Error function is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mtext>EF</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>|</mo>
      <mi>z</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <msub>
       <mi>z</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>=</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>y</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mn>1</mn>
     <mn>2</mn>
    </mfrac>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>h</mi>
        <mrow>
         <mi>w</mi>
         <mo stretchy='false'>,</mo>
         <mi>k</mi>
        </mrow>
       </msub>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>)</mo>
       </mrow>
       <mo stretchy='false'>-</mo>
       <msub>
        <mi>y</mi>
        <mrow>
         <mi>k</mi>
         <mo stretchy='false'>,</mo>
         <mi>i</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>&#x22A4;</mi>
    </msup>
    <mi>P</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>h</mi>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <msub>
       <mi>y</mi>
       <mrow>
        <mi>k</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <mtext>const</mtext>
    <mn>...</mn>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>y</mi>
 <mrow>
  <mi>k</mi>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
 is the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>k</mi>
</math>
-th dimension of the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
-th example in the dataset.</li>
</ul>
</div>
<div class='standard' id='magicparlabel-315'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-316'><span class="example_label">Example 46.</span>
(Binary classification problem) Assume we wish to classify objects with features <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>x</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
</mrow>
</math>
 in 2 categories. Consider a predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x2192;</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mn>1</mn>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 as a classification probability i.e, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo>Pr</mo>
 <mrow>
  <mo>(</mo>
  <mstyle class='math'>
   <mi>x</mi>
  </mstyle>
  <mtext>&#0160;belongs&#0160;to&#0160;class&#0160;
  <mstyle class='math'>
   <mn>1</mn>
  </mstyle></mtext>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. Assume a training data-set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msub>
   <mi>z</mi>
   <mi>i</mi>
  </msub>
  <mo stretchy='false'>=</mo>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>y</mi>
  <mi>i</mi>
 </msub>
 <mo>&#x2208;</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <mi>q</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 labeling the class. </div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-317'>A suitable output activation function can be the logistic sigmoid 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>+</mo>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo stretchy='false'>-</mo>
     <mi>a</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mfrac>
</mrow>
</math>
 This is because <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>&#x3B1;</mi>
    <mi>T</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 by Algorithm <a href="#def_To_sum_up__The">24</a> and Note <a href="#note_Assume_we_are">36</a>. Since <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>h</mi>
 <mi>w</mi>
</msub>
</math>
 returns in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mn>0</mn>
  <mo stretchy='false'>,</mo>
  <mn>1</mn>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 and the output activation is <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='double-struck'>
 <mi>R</mi>
</mstyle>
</math>
, then the aforesaid mapping suffices.</li>
<li class="itemize_item" id='magicparlabel-318'>A reasonable loss (among others) can be the cross entropy 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
      <mo stretchy='false'>=</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>x</mi>
        <mo stretchy='false'>,</mo>
        <mi>y</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mi>y</mi>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <mi>y</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="itemize_item" id='magicparlabel-323'>The same loss results as the minus log-likehihood of a specified statistical model <a id="eq__11" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>|</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>,</mo>
    <mi>w</mi>
    <mover accent='false'>
     <mo>&#x223C;</mo>
     <mtext>ind</mtext>
    </mover>
    <mtext>Bernoulli</mtext>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>p</mi>
      <mi>i</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mtext>where</mtext>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <msub>
     <mi>p</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.4)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 with mass function 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>y</mi>
   <mo stretchy='false'>|</mo>
   <mi>x</mi>
   <mo stretchy='false'>,</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <msup>
  <mrow>
   <mo>(</mo>
   <mi>x</mi>
   <mo>)</mo>
  </mrow>
  <mi>y</mi>
 </msup>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <mn>1</mn>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>-</mo>
   <mi>y</mi>
  </mrow>
 </msup>
</mrow>
</math>
i.e. 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
      <mo stretchy='false'>=</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>x</mi>
        <mo stretchy='false'>,</mo>
        <mi>y</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>y</mi>
        <mo stretchy='false'>|</mo>
        <mi>x</mi>
        <mo stretchy='false'>,</mo>
        <mi>w</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo stretchy='false'>=</mo>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mi>y</mi>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <mi>y</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="itemize_item" id='magicparlabel-324'>The Error function given a set of examples <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msubsup>
   <mi>z</mi>
   <mi>i</mi>
   <mo stretchy='false'>*</mo>
  </msubsup>
  <mo stretchy='false'>=</mo>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msubsup>
     <mi>x</mi>
     <mi>i</mi>
     <mo stretchy='false'>*</mo>
    </msubsup>
    <mo stretchy='false'>,</mo>
    <msubsup>
     <mi>y</mi>
     <mi>i</mi>
     <mo stretchy='false'>*</mo>
    </msubsup>
   </mrow>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mtext>EF</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>|</mo>
      <msup>
       <mi>z</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <msubsup>
       <mi>z</mi>
       <mi>i</mi>
       <mo stretchy='false'>*</mo>
      </msubsup>
      <mo stretchy='false'>=</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msubsup>
         <mi>x</mi>
         <mi>i</mi>
         <mo stretchy='false'>*</mo>
        </msubsup>
        <mo stretchy='false'>,</mo>
        <msubsup>
         <mi>y</mi>
         <mi>i</mi>
         <mo stretchy='false'>*</mo>
        </msubsup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mo stretchy='false'>-</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msubsup>
     <mi>y</mi>
     <mi>i</mi>
     <mo stretchy='false'>*</mo>
    </msubsup>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <msubsup>
        <mi>x</mi>
        <mi>i</mi>
        <mo stretchy='false'>*</mo>
       </msubsup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <msubsup>
       <mi>y</mi>
       <mi>i</mi>
       <mo stretchy='false'>*</mo>
      </msubsup>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <msubsup>
        <mi>x</mi>
        <mi>i</mi>
        <mo stretchy='false'>*</mo>
       </msubsup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
</ul>
</div>
<div class='standard' id='magicparlabel-325'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-326'><span class="example_label">Example 47.</span>
(Multi-class classification problem) Assume we wish to classify objects with features <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>x</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
</mrow>
</math>
 in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>q</mi>
</math>
 categories. Consider a predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='script'>
  <mi>P</mi>
 </mstyle>
</mrow>
</math>
, with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>P</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mi>&#x3D6;</mi>
   <mo>&#x2208;</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>0</mn>
      <mo stretchy='false'>,</mo>
      <mn>1</mn>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>q</mi>
   </msup>
   <mo stretchy='false'>:</mo>
   <munderover>
    <mo>&#x2211;</mo>
    <mrow>
     <mi>j</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>q</mi>
   </munderover>
   <msub>
    <mi>&#x3D6;</mi>
    <mi>j</mi>
   </msub>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>h</mi>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>h</mi>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>q</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
, as a classification probability i.e, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo>Pr</mo>
 <mrow>
  <mo>(</mo>
  <mstyle class='math'>
   <mi>x</mi>
  </mstyle>
  <mtext>&#0160;belongs&#0160;to&#0160;class&#0160;
  <mstyle class='math'>
   <mi>k</mi>
  </mstyle></mtext>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. Assume a training data-set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msub>
   <mi>z</mi>
   <mi>i</mi>
  </msub>
  <mo stretchy='false'>=</mo>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>y</mi>
 <mi>i</mi>
</msub>
</math>
, with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>y</mi>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mo>&#x2208;</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mn>1</mn>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>k</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>q</mi>
 </munderover>
 <msub>
  <mi>y</mi>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
, labeling the class to which the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
-the example belongs. Then it is</div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-327'>A suitable output activation function can be the softmax function <a id="eq__1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3C3;</mi>
     <mi>T</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>a</mi>
      <mi>k</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mrow>
      <mo>exp</mo>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>a</mi>
        <mi>k</mi>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>k</mi>
        <mo stretchy='false'>'</mo>
        <mo stretchy='false'>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>q</mi>
      </munderover>
      <mo>exp</mo>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>a</mi>
        <mrow>
         <mi>k</mi>
         <mo stretchy='false'>'</mo>
        </mrow>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo stretchy='false'>,</mo>
    <mspace width="6px"/>
    <mtext>for</mtext>
    <mspace width="6px"/>
    <mi>k</mi>
    <mo stretchy='false'>=</mo>
    <mn>1</mn>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <mi>q</mi>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.5)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
This is because <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>T</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mrow>
   <mi>T</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>T</mi>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 by Algorithm  <a href="#def_To_sum_up__The">24</a> and Note <a href="#note_Assume_we_are">(36)</a>. Since <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>h</mi>
 <mi>w</mi>
</msub>
</math>
 is essentially a probability vector and the output activation is <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mrow>
   <mi>T</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='double-struck'>
 <mi>R</mi>
</mstyle>
</math>
 the aforesaid mapping suffices. Unfortunately, <a href="#eq__1">(3.5)</a> is invariant to additive transformations <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>a</mi>
 <mo>&#x2190;</mo>
 <mi>a</mi>
 <mo stretchy='false'>+</mo>
 <mi>c</mi>
</mrow>
</math>
 i.e, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>a</mi>
   <mi>k</mi>
  </msub>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>k</mi>
   </msub>
   <mo stretchy='false'>+</mo>
   <mtext>const</mtext>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</li>
<li class="itemize_item" id='magicparlabel-328'>Another suitable output activation function can be <a id="eq__2" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mover>
      <mi>&#x3C3;</mi>
      <mo stretchy='true'>&#x02DC;</mo>
     </mover>
     <mi>T</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>a</mi>
      <mi>k</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mrow>
      <mo>exp</mo>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>a</mi>
        <mi>k</mi>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>+</mo>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>k</mi>
        <mo stretchy='false'>'</mo>
        <mo stretchy='false'>=</mo>
        <mn>1</mn>
       </mrow>
       <mrow>
        <mi>q</mi>
        <mo stretchy='false'>-</mo>
        <mn>1</mn>
       </mrow>
      </munderover>
      <mo>exp</mo>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>a</mi>
        <mrow>
         <mi>k</mi>
         <mo stretchy='false'>'</mo>
        </mrow>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
    </mfrac>
    <mo stretchy='false'>,</mo>
    <mspace width="6px"/>
    <mtext>for</mtext>
    <mspace width="6px"/>
    <mi>k</mi>
    <mo stretchy='false'>=</mo>
    <mn>1</mn>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <mi>q</mi>
    <mo stretchy='false'>-</mo>
    <mn>1</mn>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.6)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
This is because <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>T</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mrow>
   <mi>T</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>T</mi>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 by Algorithm <a href="#def_To_sum_up__The">24</a> and Note <a href="#note_Assume_we_are">36</a>. Since <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>h</mi>
 <mi>w</mi>
</msub>
</math>
 is essentially a probability vector and the output activation is <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mrow>
   <mi>T</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='double-struck'>
 <mi>R</mi>
</mstyle>
</math>
 the aforesaid mapping suffices as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>T</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>k</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>q</mi>
 <mo stretchy='false'>-</mo>
 <mn>1</mn>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>q</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>-</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>k</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mrow>
   <mi>q</mi>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
  </mrow>
 </munderover>
 <msub>
  <mi>h</mi>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. The advantage of <a href="#eq__2">(3.6)</a> compared to <a href="#eq__1">(3.5)</a> is that the former uses one less output neurons (less unknown parameters to learn). Also <a href="#eq__2">(3.6)</a> is not invariant to additive transformations <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>a</mi>
 <mo>&#x2190;</mo>
 <mi>a</mi>
 <mo stretchy='false'>+</mo>
 <mi>c</mi>
</mrow>
</math>
 unlike <a href="#eq__1">(3.5)</a>i.e, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mi>&#x3C3;</mi>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>a</mi>
   <mi>k</mi>
  </msub>
  <mo>)</mo>
 </mrow>
 <mo>&#x2260;</mo>
 <msub>
  <mover>
   <mi>&#x3C3;</mi>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>a</mi>
    <mi>k</mi>
   </msub>
   <mo stretchy='false'>+</mo>
   <mtext>const</mtext>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</li>
<li class="itemize_item" id='magicparlabel-329'>A reasonable loss can be the cross entropy 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
      <mo stretchy='false'>=</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>x</mi>
        <mo stretchy='false'>,</mo>
        <mi>y</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>k</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>q</mi>
    </munderover>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>h</mi>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="itemize_item" id='magicparlabel-330'>The same loss results as the minus log-likehihood of a specified statistical model 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>y</mi>
  <mi>i</mi>
 </msub>
 <mo stretchy='false'>|</mo>
 <mi>x</mi>
 <mo stretchy='false'>,</mo>
 <mi>w</mi>
 <mo>&#x223C;</mo>
 <mtext>Multinomial</mtext>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>,</mo>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mtext>where</mtext>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <msub>
  <mi>p</mi>
  <mi>i</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 with mass function 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <mi>x</mi>
   <mo stretchy='false'>,</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x220F;</mo>
  <mrow>
   <mi>k</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>q</mi>
 </munderover>
 <msub>
  <mi>h</mi>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <msup>
  <mrow>
   <mo>(</mo>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo>)</mo>
  </mrow>
  <msub>
   <mi>y</mi>
   <mrow>
    <mi>i</mi>
    <mo stretchy='false'>,</mo>
    <mi>k</mi>
   </mrow>
  </msub>
 </msup>
</mrow>
</math>
i.e. 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
      <mo stretchy='false'>=</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>x</mi>
        <mo stretchy='false'>,</mo>
        <mi>y</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>y</mi>
        <mo stretchy='false'>|</mo>
        <mi>x</mi>
        <mo stretchy='false'>,</mo>
        <mi>w</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo stretchy='false'>=</mo>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>-</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>k</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>q</mi>
    </munderover>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>h</mi>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 which is the cross-entropy.</li>
<li class="itemize_item" id='magicparlabel-331'>The Error function given a set of examples <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msubsup>
   <mi>z</mi>
   <mi>i</mi>
   <mo stretchy='false'>*</mo>
  </msubsup>
  <mo stretchy='false'>=</mo>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msubsup>
     <mi>x</mi>
     <mi>i</mi>
     <mo stretchy='false'>*</mo>
    </msubsup>
    <mo stretchy='false'>,</mo>
    <msubsup>
     <mi>y</mi>
     <mi>i</mi>
     <mo stretchy='false'>*</mo>
    </msubsup>
   </mrow>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mtext>EF</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>|</mo>
      <msup>
       <mi>z</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <msubsup>
       <mi>z</mi>
       <mi>i</mi>
       <mo stretchy='false'>*</mo>
      </msubsup>
      <mo stretchy='false'>=</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msubsup>
         <mi>x</mi>
         <mi>i</mi>
         <mo stretchy='false'>*</mo>
        </msubsup>
        <mo stretchy='false'>,</mo>
        <msubsup>
         <mi>y</mi>
         <mi>i</mi>
         <mo stretchy='false'>*</mo>
        </msubsup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mo stretchy='false'>-</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>k</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>q</mi>
    </munderover>
    <msubsup>
     <mi>y</mi>
     <mrow>
      <mi>k</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
     <mo stretchy='false'>*</mo>
    </msubsup>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>h</mi>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <msubsup>
        <mi>x</mi>
        <mi>i</mi>
        <mo stretchy='false'>*</mo>
       </msubsup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>y</mi>
 <mrow>
  <mi>k</mi>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
 </mrow>
</msub>
</math>
 is the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>k</mi>
</math>
-th dimension of the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
-th example in the dataset.</li>
</ul>
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-332'><span class="section_label">4</span> Classical learning of Neural Network</h2>
<div class='note'>
<div class="note_item" id='magicparlabel-333'><span class="note_label">Note 48.</span>
Our purpose is to find optimal <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo>&#x2208;</mo>
 <msub>
  <mstyle mathvariant='script'>
   <mi>H</mi>
  </mstyle>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mi>&#x3C3;</mi>
  </mrow>
 </msub>
</mrow>
</math>
  under loss <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>&#x22C5;</mo>
   <mo stretchy='false'>,</mo>
   <mo>&#x22C5;</mo>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and against training data-set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>S</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <mi>n</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
.</div>
</div>
<section>
<h3 class='subsection' id='magicparlabel-338'><span class="subsection_label">4.1</span> Standard learning problem</h3>
<div class='note'>
<div class="note_item" id='magicparlabel-339'><span class="note_label">Note 49.</span>
Essentially, this is an optimization problem, where the objective is to minimize either the risk function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>R</mi>
  <mi>g</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 or the empirical risk function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mi>R</mi>
   <mo stretchy='true'>&#x02C6;</mo>
  </mover>
  <mi>S</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-340'>
<br />
</div>
<div class='problem'>
<div class="problem_item" id='magicparlabel-341'><span class="problem_label">Problem 50.</span>
<a id="prob_Find__" /> Compute optimal <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mi>w</mi>
  <mo stretchy='false'>*</mo>
 </msup>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
 by minimizing the risk function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>R</mi>
  <mi>g</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
<a id="eq_dsghadfhafdb" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mo stretchy='false'>*</mo>
    </msup>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>min</mo>
     </mrow>
     <mi>w</mi>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>R</mi>
       <mi>g</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>min</mo>
     </mrow>
     <mi>w</mi>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mtext>E</mtext>
       <mrow>
        <mi>z</mi>
        <mo>&#x223C;</mo>
        <mi>g</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>&#x2113;</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>w</mi>
          <mo stretchy='false'>,</mo>
          <mi>z</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(4.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-342'>
<br />
</div>
<div class='problem'>
<div class="problem_item" id='magicparlabel-343'><span class="problem_label">Problem 51.</span>
<a id="prob_Compute_optimal_" /> Compute optimal <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mi>w</mi>
  <mo stretchy='false'>*</mo>
 </msup>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
 by minimizing the empirical risk function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mi>R</mi>
   <mo stretchy='true'>&#x02C6;</mo>
  </mover>
  <mi>S</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
<a id="eq_afghadfhagf" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mo stretchy='false'>*</mo>
    </msup>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>min</mo>
     </mrow>
     <mi>w</mi>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mover>
        <mi>R</mi>
        <mo stretchy='true'>&#x02C6;</mo>
       </mover>
       <mi>S</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>min</mo>
     </mrow>
     <mi>w</mi>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>n</mi>
      </mfrac>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>i</mi>
        <mo stretchy='false'>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mi>&#x2113;</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(4.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-344'>
<br />
</div>
</section>
<section>
<h3 class='subsection' id='magicparlabel-345'><span class="subsection_label">4.2</span> <a id="subsec_Regularization" /> Regularized loss optimization </h3>
<div class='note'>
<div class="note_item" id='magicparlabel-346'><span class="note_label">Note 52.</span>
<a id="note_Often_neural_network" /> Often neural network models are over-parameterized, in the sense that the dimensionality of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
 is too large, with negative consequences in its predictability. This can be addressed by learning the architecture NN, precisely by learning which of the edges of the FFNN significantly contribute to the NN model and should be kept, and which do not contribute and may be removed (or be inactive). </div>
</div>
<div class='standard' id='magicparlabel-347'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-348'><span class="note_label">Note 53.</span>
To address Note <a href="#note_Often_neural_network">52</a>, one can resort to shrinkage methods e.g., LASSO, Ridge, which indirectly allow edge/weight selection/elimination by shrinking the values of the weights <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>w</mi>
  <mrow>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 towards zero, and setting some of them as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>w</mi>
  <mrow>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
 if their absolute value is small enough. This is based on the observation in <a href="#eq_wrgrsdfgsdfgsdg">(2.2)</a> i.e., <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>w</mi>
  <mrow>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
 is equivalent to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mrow>
  <mo>/</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
</mrow>
</math>
 which implies that the link <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>v</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>&#x2192;</mo>
 <msub>
  <mi>v</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
</mrow>
</math>
 is not active (essentially not in the neural network). </div>
</div>
<div class='standard' id='magicparlabel-349'>
<br />
</div>
<div class='problem'>
<div class="problem_item" id='magicparlabel-350'><span class="problem_label">Problem 54.</span>
<a id="prob_Often_neural_network" /> Compute <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo>&#x2208;</mo>
 <msub>
  <mstyle mathvariant='script'>
   <mi>H</mi>
  </mstyle>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mi>&#x3C3;</mi>
  </mrow>
 </msub>
</mrow>
</math>
  (essentially compute <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
) under loss <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>&#x22C5;</mo>
   <mo stretchy='false'>,</mo>
   <mo>&#x22C5;</mo>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and shrinkage term (or weight decay) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>J</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>;</mo>
   <mi>&#x3BB;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
, and against training data-set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>S</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <mi>n</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
. Compute <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mi>w</mi>
  <mo stretchy='false'>*</mo>
 </msup>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
, according to the minimization: <a id="eq_dsghadfhafdb_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <msup>
    <mi>w</mi>
    <mo stretchy='false'>*</mo>
   </msup>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>min</mo>
     </mrow>
     <mi>w</mi>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>R</mi>
       <mi>g</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <mi>J</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>;</mo>
        <mi>&#x3BB;</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(4.3)</mtext>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>min</mo>
     </mrow>
     <mi>w</mi>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mtext>E</mtext>
       <mrow>
        <mi>z</mi>
        <mo>&#x223C;</mo>
        <mi>g</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>&#x2113;</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>w</mi>
          <mo stretchy='false'>,</mo>
          <mi>z</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>+</mo>
        <mi>J</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>w</mi>
          <mo stretchy='false'>;</mo>
          <mi>&#x3BB;</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(4.4)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 and set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msubsup>
  <mi>w</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
  <mo stretchy='false'>*</mo>
 </msubsup>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
 if <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mi>w</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>,</mo>
  <mi>i</mi>
  <mo stretchy='false'>,</mo>
  <mi>j</mi>
 </mrow>
 <mo stretchy='false'>*</mo>
</msubsup>
</math>
 is less than a threshold user specific value <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3BE;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 i.e. <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>|</mo>
  <msubsup>
   <mi>w</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>,</mo>
    <mi>i</mi>
    <mo stretchy='false'>,</mo>
    <mi>j</mi>
   </mrow>
   <mo stretchy='false'>*</mo>
  </msubsup>
  <mo>|</mo>
 </mrow>
 <mo stretchy='false'>&lt;</mo>
 <mi>&#x3BE;</mi>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-355'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-356'><span class="note_label">Note 55.</span>
<a id="prob_Popular_shrinkage_terms" />Popular shrinkage terms <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>J</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>;</mo>
   <mi>&#x3BB;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 are</div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-361'>Ridge: <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>J</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>;</mo>
   <mi>&#x3BB;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>&#x3BB;</mi>
 <msubsup>
  <mrow>
   <mo>&#x2225;</mo>
   <mi>w</mi>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>2</mn>
  <mn>2</mn>
 </msubsup>
</mrow>
</math>
</li>
<li class="itemize_item" id='magicparlabel-362'>LASSO: <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>J</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>;</mo>
   <mi>&#x3BB;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>&#x3BB;</mi>
 <msub>
  <mrow>
   <mo>&#x2225;</mo>
   <mi>w</mi>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>1</mn>
 </msub>
</mrow>
</math>
 </li>
<li class="itemize_item" id='magicparlabel-363'>Elastic net: <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>J</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>;</mo>
   <mi>&#x3BB;</mi>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>&#x3BB;</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>&#x3BB;</mi>
      <mn>2</mn>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3BB;</mi>
  <mn>1</mn>
 </msub>
 <msub>
  <mrow>
   <mo>&#x2225;</mo>
   <mi>w</mi>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>1</mn>
 </msub>
 <mo stretchy='false'>+</mo>
 <msub>
  <mi>&#x3BB;</mi>
  <mn>2</mn>
 </msub>
 <msubsup>
  <mrow>
   <mo>&#x2225;</mo>
   <mi>w</mi>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>2</mn>
  <mn>2</mn>
 </msubsup>
</mrow>
</math>
</li>
</ul>
</div>
</section>
</section>
<section>
<h2 class='section' id='magicparlabel-364'><span class="section_label">5</span> Stochastic gradient descent for classical training of NN</h2>
<div class='standard' id='magicparlabel-365'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-366'><span class="note_label">Note 56.</span>
Training a neural network model is usually a high-dimensional problem (essentially <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 has high dimensionality to provide a better approximation) and a big-data problem (essentially we need a large number of training examples to learn a large number of weights). For this reason, Stochastic Gradient Descent (and its variations) is a suitable computational learning tool. </div>
</div>
<div class='standard' id='magicparlabel-367'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-368'><span class="note_label">Note 57.</span>
To address Problem <a href="#prob_Find__">50</a>, the recursion of the SGD with batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>-</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mfrac>
  <mn>1</mn>
  <mi>m</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>m</mi>
 </munderover>
 <msub>
  <mi>&#x2202;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msubsup>
    <mi>z</mi>
    <mi>j</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msubsup>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 </div>
</div>
<div class='standard' id='magicparlabel-369'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-370'><span class="note_label">Note 58.</span>
To address the Problem <a href="#prob_Often_neural_network">54</a>, the recursion of the SGD with batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>-</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mrow>
  <mo>[</mo>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mi>m</mi>
   </mfrac>
   <munderover>
    <mo>&#x2211;</mo>
    <mrow>
     <mi>j</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>m</mi>
   </munderover>
   <msub>
    <mi>&#x2202;</mi>
    <mi>w</mi>
   </msub>
   <mi>&#x2113;</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msup>
      <mi>w</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
     <mo stretchy='false'>,</mo>
     <msubsup>
      <mi>z</mi>
      <mi>j</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>+</mo>
   <msub>
    <mi>&#x2202;</mi>
    <mi>w</mi>
   </msub>
   <mi>J</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>;</mo>
     <mi>&#x3BB;</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>]</mo>
 </mrow>
</mrow>
</math>
 for some positive <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3BB;</mi>
</math>
 which is user specified, or chosen via cross validation.</div>
</div>
<div class='standard' id='magicparlabel-371'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-372'><span class="note_label">Note 59.</span>
The learning problem associated to the Neural network model is (almost always) non-convex due to the non-convex loss with respect to the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
&#8217;s. Upon implementing SGD in the learning problem of Neural Network, the theoretical results in Section <a href="#sec_Analysis">sec:Analysis</a> (Handout 2) and Section <a href="#subsec_Analysis">subsec:Analysis</a> (Handout 3) will not be effective due to the violation of the assumptions. </div>
</div>
<div class='standard' id='magicparlabel-373'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-374'><span class="note_label">Note 60.</span>
Practical guidelines for the use of SGD in the learning problem of NN: <div class='marginal'><div class='plain_layout' id='magicparlabel-378'>Ref [<a href="#enu_LeCun__Y___Bottou_">3.</a>]</div>
</div></div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-379'>Utilize a learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 that changes over the iterations. The choice of the sequence <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 is more significant. In practice, it is tuned by a trial and error manner: given a validation data-set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <msup>
  <mi>S</mi>
  <mo stretchy='false'>*</mo>
 </msup>
</mstyle>
</math>
 you may perform cross validation based on Error Function <a href="#eq__3">(3.1)</a>.</li>
<li class="enumerate_item" id='magicparlabel-385'>Re-run the SGD procedure several times and by using different settings (learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
, batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
) and different seed <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mn>0</mn>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 (randomly choosen) each time. Possibly, by luck, at some trial, we will initialize the SGD process with a random seed <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mn>0</mn>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 producing a trace leading to a good local minimum <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mo stretchy='false'>*</mo>
</msup>
</math>
.</li>
<li class="enumerate_item" id='magicparlabel-386'>The output <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mi>w</mi>
 <mtext>SGD</mtext>
 <mo stretchy='false'>*</mo>
</msubsup>
</math>
 returned by SGD is the best discovered <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 tested by using a performance measure (Error Function) using a validation set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <msup>
   <mi>S</mi>
   <mo stretchy='false'>*</mo>
  </msup>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msubsup>
    <mi>z</mi>
    <mi>i</mi>
    <mo stretchy='false'>*</mo>
   </msubsup>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msubsup>
      <mi>x</mi>
      <mi>i</mi>
      <mo stretchy='false'>*</mo>
     </msubsup>
     <mo stretchy='false'>,</mo>
     <msubsup>
      <mi>y</mi>
      <mi>i</mi>
      <mo stretchy='false'>*</mo>
     </msubsup>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <msup>
    <mi>n</mi>
    <mo stretchy='false'>*</mo>
   </msup>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 ; Eg. 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msubsup>
  <mi>w</mi>
  <mtext>SGD</mtext>
  <mo stretchy='false'>*</mo>
 </msubsup>
 <mo stretchy='false'>=</mo>
 <munder accent='false'>
  <mrow>
   <mo>arg</mo>
   <mo>min</mo>
  </mrow>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
 </munder>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mtext>EF</mtext>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msup>
      <mi>w</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
     <mo stretchy='false'>|</mo>
     <mrow>
      <mo>{</mo>
      <msubsup>
       <mi>z</mi>
       <mi>i</mi>
       <mo stretchy='false'>*</mo>
      </msubsup>
      <mo>}</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mn>.</mn>
</mrow>
</math>
</li>
</ol>
</div>
<div class='standard' id='magicparlabel-387'>
<br />
</div>
<section>
<h3 class='subsection' id='magicparlabel-388'><span class="subsection_label">5.1</span> <a id="subsec_Error_backpropagation__to" /> Error backpropagation </h3>
<div class='note'>
<div class="note_item" id='magicparlabel-393'><span class="note_label">Note 61.</span>
The error back-propagation procedure is an efficient algorithm for the computation of the gradient <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x2207;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 of the loss function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 at some value of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 and some example <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>z</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>x</mi>
   <mo stretchy='false'>,</mo>
   <mi>y</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 as required for the implementation of stochastic gradient based algorithm to train the FFNN. </div>
</div>
<div class='standard' id='magicparlabel-394'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-395'><span class="note_label">Note 62.</span>
Error backpropagation assumes that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is differentiable at <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 for each value of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>z</mi>
</math>
; <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x2207;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 exists âhowever extensions exist.</div>
</div>
<div class='notation'>
<div class="notation_item" id='magicparlabel-396'><span class="notation_label">Notation 63.</span>
Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>V</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>k</mi>
      <mi>t</mi>
     </msub>
    </mrow>
   </msub>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 be the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
-th layer of a NN and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>k</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>|</mo>
  <msub>
   <mi>V</mi>
   <mi>t</mi>
  </msub>
  <mo>|</mo>
 </mrow>
</mrow>
</math>
 the number of neuron in layer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mi>T</mi>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-418'>
<br />
</div>

<div class='standard' id='magicparlabel-419'><div class='Boxed'><div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-467'><span class="algorithm_label">Algorithm 64.</span>
<a id="alg__Error_backpropagation_" />(Error back-propagation)</div>
<div class='plain_layout' id='magicparlabel-468'><i><hr />
</i></div>
<dl class='description'>
<dt class="description_label">Requires</dt>
<dd class="description_item" id='magicparlabel-469'><i> The FFNN <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x3C3;</mi>
  <mo stretchy='false'>,</mo>
  <mi>w</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 with the values of the a weight vector <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo>&#x2208;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
, and example value <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>z</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>x</mi>
   <mo stretchy='false'>,</mo>
   <mi>y</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</i></dd>
</dl>
<div class='plain_layout' id='magicparlabel-470'><i><hr />
</i></div>
<dl class='description'>
<dt class="description_label">Returns</dt>
<dd class="description_item" id='magicparlabel-471'><i> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x2207;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mfrac>
    <mi>&#x2202;</mi>
    <mrow>
     <mi>&#x2202;</mi>
     <msub>
      <mi>w</mi>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>,</mo>
       <mi>i</mi>
       <mo stretchy='false'>,</mo>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
   </mfrac>
   <mi>&#x2113;</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>,</mo>
     <mi>z</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>;</mo>
   <mspace width="6px"/>
   <mi>&#x2200;</mi>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</i></dd>
</dl>
<div class='plain_layout' id='magicparlabel-472'><i><hr />
</i></div>
<dl class='description'>
<dt class="description_label">Initialize</dt>
<dd class="description_item" id='magicparlabel-473'><i> &#xA0;</i>
<div class='plain_layout' id='magicparlabel-474'><i>Set </i><math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>w</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>,</mo>
         <mi>i</mi>
        </mrow>
       </msub>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>+</mo>
         <mn>1</mn>
         <mo stretchy='false'>,</mo>
         <mi>j</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mspace width="6px"/>
     <mtext>if</mtext>
     <mspace width="6px"/>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>,</mo>
         <mi>i</mi>
        </mrow>
       </msub>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>+</mo>
         <mn>1</mn>
         <mo stretchy='false'>,</mo>
         <mi>j</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo>&#x2208;</mo>
     <mstyle mathvariant='script'>
      <mi>E</mi>
     </mstyle>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mn>0</mn>
   </mtd>
   <mtd>
    <mrow>
     <mspace width="6px"/>
     <mtext>if</mtext>
     <mspace width="6px"/>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>,</mo>
         <mi>i</mi>
        </mrow>
       </msub>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>+</mo>
         <mn>1</mn>
         <mo stretchy='false'>,</mo>
         <mi>j</mi>
        </mrow>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>/</mo>
     </mrow>
     <mo>&#x2208;</mo>
     <mstyle mathvariant='script'>
      <mi>E</mi>
     </mstyle>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</mrow>
</math>
</div>
</dd><dt class="description_label">Forward&#xA0;pass</dt>
<dd class="description_item" id='magicparlabel-475'><i> &#xA0;</i>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-476'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>d</mi>
</mrow>
</math>
</i>
<div class='plain_layout' id='magicparlabel-477'><i>&#x2003;&#x2003;Set: 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
</mrow>
</math>
</i></div>
</li><li class="enumerate_item" id='magicparlabel-478'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>T</mi>
</mrow>
</math>
 ; For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
</i>
<div class='plain_layout' id='magicparlabel-479'><i>&#x2003;&#x2003;Compute: 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <msub>
   <mi>k</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
 </munderover>
 <msub>
  <mi>w</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
</mrow>
</math>
</i></div>

<div class='plain_layout' id='magicparlabel-480'><i>&#x2003;&#x2003;Compute: 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>t</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</i></div>
</li></ol>
</dd><dt class="description_label">Backward&#xA0;pass</dt>
<dd class="description_item" id='magicparlabel-481'><i> &#xA0;</i>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-482'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mi>T</mi>
</mrow>
</math>
 ; For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mi>T</mi>
 </msub>
</mrow>
</math>
</i>
<div class='plain_layout' id='magicparlabel-504'><i>&#x2003;&#x2003;Compute: </i></div>

<div class='plain_layout' id='magicparlabel-509'><i><a id="eq__21" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3B4;</mi>
     <mrow>
      <mi>T</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>&#x2113;</mi>
       <mi>T</mi>
      </msub>
     </mrow>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mi>T</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>&#x3B1;</mi>
      <mi>T</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x2113;</mi>
 <mi>T</mi>
</msub>
</math>
 is the loss as a function of the vector of activations <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mi>T</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mi>T</mi>
      <mo stretchy='false'>,</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mi>T</mi>
      <mo stretchy='false'>,</mo>
      <msub>
       <mi>k</mi>
       <mi>T</mi>
      </msub>
     </mrow>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
.</i></div>
</li><li class="enumerate_item" id='magicparlabel-510'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mi>T</mi>
 <mo stretchy='false'>-</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mn>1</mn>
</mrow>
</math>
 ; For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
 </i>
<div class='plain_layout' id='magicparlabel-511'><i>&#x2003;&#x2003;Compute: <a id="eq__22" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>&#x3B4;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mtext>d</mtext>
     <mrow>
      <mtext>d</mtext>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <msub>
     <mi>&#x3C3;</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>&#x3B1;</mi>
      <mrow>
       <mo stretchy='false'>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo>)</mo>
    </mrow>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>j</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <msub>
      <mi>k</mi>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </munderover>
    <msub>
     <mi>w</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <msub>
     <mi>&#x3B4;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</i></div>
</li></ol>
</dd><dt class="description_label">Output</dt>
<dd class="description_item" id='magicparlabel-516'><i> &#xA0;</i>
<div class='plain_layout' id='magicparlabel-517'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>T</mi>
</mrow>
</math>
; <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
 ; <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>j</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
  </mrow>
 </msub>
</mrow>
</math>
 </i></div>

<div class='plain_layout' id='magicparlabel-518'><i>&#x2003;&#x2003;If edge <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>-</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
</mrow>
</math>
, set: 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mfrac>
     <mrow>
      <mi>&#x2202;</mi>
      <mi>&#x2113;</mi>
     </mrow>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>&#x3B4;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mspace width="6px"/>
    <msub>
     <mi>o</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</i></div>
</dd></dl>
</div>
</div></div>


<div class='note'>
<div class="note_item" id='magicparlabel-554'><span class="note_label">Note 65.</span>
In <a href="#eq__21">(5.1)</a> and <a href="#eq__22">(5.2)</a>, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 are called errors. </div>
</div>
<div class='standard' id='magicparlabel-555'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-556'><span class="example_label">Example 66.</span>
Consider the multi-output regression problem, assume a predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x2192;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>q</mi>
 </msup>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>h</mi>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>,</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>h</mi>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>,</mo>
     <mi>q</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>k</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3C3;</mi>
  <mn>2</mn>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <munderover>
    <mo>&#x2211;</mo>
    <mrow>
     <mi>j</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>c</mi>
   </munderover>
   <msub>
    <mi>w</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <msub>
    <mi>&#x3C3;</mi>
    <mn>1</mn>
   </msub>
   <mrow>
    <mo>(</mo>
    <mrow>
     <munderover>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>i</mi>
       <mo stretchy='false'>=</mo>
       <mn>1</mn>
      </mrow>
      <mi>d</mi>
     </munderover>
     <msub>
      <mi>w</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>,</mo>
       <mi>j</mi>
       <mo stretchy='false'>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 with activation functions <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mn>2</mn>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>a</mi>
</mrow>
</math>
, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mn>1</mn>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo>tanh</mo>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mrow>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mi>a</mi>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>-</mo>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo stretchy='false'>-</mo>
     <mi>a</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mrow>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mi>a</mi>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>+</mo>
   <mo>exp</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mo stretchy='false'>-</mo>
     <mi>a</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mfrac>
</mrow>
</math>
, and loss <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mn>2</mn>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>k</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>q</mi>
 </munderover>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>y</mi>
     <mi>k</mi>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mn>2</mn>
 </msup>
</mrow>
</math>
 for example <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>z</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>x</mi>
   <mo stretchy='false'>,</mo>
   <mi>y</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. Perform the error back propagation steps to compute the elements of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x2207;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 at some <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>z</mi>
</math>
.</div>
</div>
<div class='solution_'>
<div class="solution__item" id='magicparlabel-557'><span class="solution__label">Solution.</span>
&#xA0;</div>
<dl class='description'>
<dt class="description_label">Forward&#xA0;pass</dt>
<dd class="description_item" id='magicparlabel-558'> 
<dl class='description'>
<dt class="description_label">Set</dt>
<dd class="description_item" id='magicparlabel-559'> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>d</mi>
</mrow>
</math>
</dd>
<dt class="description_label">Compute</dt>
<dd class="description_item" id='magicparlabel-560'> 
<dl class='description'>
<dt class="description_label">at&#xA0;<math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
</dt>
<dd class="description_item" id='magicparlabel-561'> for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>j</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mi>c</mi>
</mrow>
</math>

<dl class='description'>
<dt class="description_label">comp</dt>
<dd class="description_item" id='magicparlabel-562'> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>d</mi>
 </munderover>
 <msub>
  <mi>w</mi>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
</mrow>
</math>
 </dd>
<dt class="description_label">comp</dt>
<dd class="description_item" id='magicparlabel-563'> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mo>tanh</mo>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mrow>
    <mn>1</mn>
    <mo stretchy='false'>,</mo>
    <mi>j</mi>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 </dd>
</dl>
</dd><dt class="description_label">at&#xA0;<math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>2</mn>
</mrow>
</math>
</dt>
<dd class="description_item" id='magicparlabel-564'> for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>k</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mi>q</mi>
</mrow>
</math>

<dl class='description'>
<dt class="description_label">comp</dt>
<dd class="description_item" id='magicparlabel-565'> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mrow>
   <mn>2</mn>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>c</mi>
 </munderover>
 <msub>
  <mi>w</mi>
  <mrow>
   <mn>2</mn>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
</mrow>
</math>
 </dd>
<dt class="description_label">comp</dt>
<dd class="description_item" id='magicparlabel-566'> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>2</mn>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3B1;</mi>
  <mrow>
   <mn>2</mn>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
</mrow>
</math>
</dd>
</dl>
</dd><dt class="description_label">get</dt>
<dd class="description_item" id='magicparlabel-567'> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>k</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>2</mn>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
</mrow>
</math>
 </dd>
</dl>
</dd></dl>
</dd></dl>
<div class='standard' id='magicparlabel-568'>Note that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mfrac>
  <mtext>d</mtext>
  <mrow>
   <mtext>d</mtext>
   <mi>&#x3BE;</mi>
  </mrow>
 </mfrac>
 <msub>
  <mi>&#x3C3;</mi>
  <mn>1</mn>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3BE;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>-</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>&#x3C3;</mi>
     <mn>1</mn>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>&#x3BE;</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mn>2</mn>
 </msup>
</mrow>
</math>
 and that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mfrac>
  <mtext>d</mtext>
  <mrow>
   <mtext>d</mtext>
   <mi>&#x3BE;</mi>
  </mrow>
 </mfrac>
 <msub>
  <mi>&#x3C3;</mi>
  <mn>2</mn>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3BE;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
. </div>
<dl class='description'>
<dt class="description_label">Backward&#xA0;pass</dt>
<dd class="description_item" id='magicparlabel-569'> 
<dl class='description'>
<dt class="description_label">at&#xA0;<math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>2</mn>
</mrow>
</math>
</dt>
<dd class="description_item" id='magicparlabel-570'> for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>k</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mi>q</mi>
</mrow>
</math>

<dl class='description'>
<dt class="description_label">comp</dt>
<dd class="description_item" id='magicparlabel-571'> &#xA0;
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mn>2</mn>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mi>&#x2202;</mi>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <msub>
  <mi>&#x2113;</mi>
  <mi>T</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>q</mi>
 </munderover>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x2113;</mi>
    <mi>T</mi>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>o</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>o</mi>
   <mrow>
    <mn>2</mn>
    <mo stretchy='false'>,</mo>
    <mi>j</mi>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>o</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mrow>
    <mn>2</mn>
    <mo stretchy='false'>,</mo>
    <mi>k</mi>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x2113;</mi>
    <mi>T</mi>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>o</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>o</mi>
   <mrow>
    <mn>2</mn>
    <mo stretchy='false'>,</mo>
    <mi>k</mi>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>o</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mrow>
    <mn>2</mn>
    <mo stretchy='false'>,</mo>
    <mi>k</mi>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>h</mi>
  <mi>k</mi>
 </msub>
 <mo stretchy='false'>-</mo>
 <msub>
  <mi>y</mi>
  <mi>k</mi>
 </msub>
</mrow>
</math>
</dd>
</dl>
</dd><dt class="description_label">at&#xA0;<math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
</dt>
<dd class="description_item" id='magicparlabel-572'> for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>j</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mi>c</mi>
</mrow>
</math>

<dl class='description'>
<dt class="description_label">comp</dt>
<dd class="description_item" id='magicparlabel-573'> &#xA0;
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <msub>
    <mi>&#x3B4;</mi>
    <mrow>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mrow>
      <mo>.</mo>
      <mrow>
       <mfrac>
        <mtext>d</mtext>
        <mrow>
         <mtext>d</mtext>
         <mi>&#x3BE;</mi>
        </mrow>
       </mfrac>
       <msub>
        <mi>&#x3C3;</mi>
        <mn>1</mn>
       </msub>
       <mrow>
        <mo>(</mo>
        <mi>&#x3BE;</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>&#x3BE;</mi>
      <mo stretchy='false'>=</mo>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mn>1</mn>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </msub>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>k</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>q</mi>
    </munderover>
    <msub>
     <mi>w</mi>
     <mrow>
      <mn>2</mn>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <msub>
     <mi>&#x3B4;</mi>
     <mrow>
      <mn>2</mn>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>=</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <msup>
       <mrow>
        <mo>(</mo>
        <munder accent='false'>
         <munder>
          <mrow>
           <msub>
            <mi>&#x3C3;</mi>
            <mn>1</mn>
           </msub>
           <mrow>
            <mo>(</mo>
            <msub>
             <mi>&#x3B1;</mi>
             <mrow>
              <mn>1</mn>
              <mo stretchy='false'>,</mo>
              <mi>j</mi>
             </mrow>
            </msub>
            <mo>)</mo>
           </mrow>
          </mrow>
          <mo stretchy='true'>&#x23DF;</mo>
         </munder>
         <mrow>
          <mo stretchy='false'>=</mo>
          <msub>
           <mi>o</mi>
           <mrow>
            <mn>1</mn>
            <mo stretchy='false'>,</mo>
            <mi>j</mi>
           </mrow>
          </msub>
         </mrow>
        </munder>
        <mo>)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>k</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>q</mi>
    </munderover>
    <msub>
     <mi>w</mi>
     <mrow>
      <mn>2</mn>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <msub>
     <mi>&#x3B4;</mi>
     <mrow>
      <mn>2</mn>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <msup>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>o</mi>
         <mrow>
          <mn>1</mn>
          <mo stretchy='false'>,</mo>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>k</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>q</mi>
    </munderover>
    <msub>
     <mi>w</mi>
     <mrow>
      <mn>2</mn>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <msub>
     <mi>&#x3B4;</mi>
     <mrow>
      <mn>2</mn>
      <mo stretchy='false'>,</mo>
      <mi>k</mi>
     </mrow>
    </msub>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 </dd>
</dl>
</dd></dl>
</dd><dt class="description_label">Output</dt>
<dd class="description_item" id='magicparlabel-574'> 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <mi>&#x2113;</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>,</mo>
     <mi>z</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>w</mi>
    <mrow>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mtext>and</mtext>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <mi>&#x2113;</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>,</mo>
     <mi>z</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>w</mi>
    <mrow>
     <mn>2</mn>
     <mo stretchy='false'>,</mo>
     <mi>k</mi>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mn>2</mn>
   <mo stretchy='false'>,</mo>
   <mi>k</mi>
  </mrow>
 </msub>
 <msub>
  <mi>o</mi>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
</mrow>
</math>
</dd>
</dl>
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-612'><span class="note_label">Note 67.</span>
We show that the Algorithm <a href="#alg__Error_backpropagation_">64</a> is valid. The Forward pass is valid due to Algorithm <a href="#def_To_sum_up__The">24</a>. Now, we work on the Backward pass.</div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-613'>Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B1;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <msub>
       <mi>k</mi>
       <mi>t</mi>
      </msub>
     </mrow>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
 be the vector of the activations of the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
-th layer of a NN.</li>
<li class="itemize_item" id='magicparlabel-614'>Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x2113;</mi>
  <mi>t</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 be the loss function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 as a function of the vector of the activations <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B1;</mi>
 <mi>t</mi>
</msub>
</math>
 at <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
-th layer. </li>
</ul>
</div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-615'>It is <a id="eq__23" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mfrac>
     <mrow>
      <mi>&#x2202;</mi>
      <mi>&#x2113;</mi>
     </mrow>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>&#x2113;</mi>
       <mi>t</mi>
      </msub>
     </mrow>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>&#x3B1;</mi>
      <mi>t</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <mfrac>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>&#x3B4;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mfrac>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>w</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.4)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
where 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x2113;</mi>
    <mi>t</mi>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mi>t</mi>
  </msub>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>j</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
  </mrow>
 </msub>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>T</mi>
</mrow>
</math>
. </li>
<li class="itemize_item" id='magicparlabel-620'>Regarding the second part of <a href="#eq__23">(5.4)</a>, it is
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>w</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mi>&#x2202;</mi>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>w</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>s</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <msub>
   <mi>k</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>-</mo>
    <mn>1</mn>
   </mrow>
  </msub>
 </munderover>
 <msub>
  <mi>w</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>s</mi>
  </mrow>
 </msub>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>s</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
</mrow>
</math>
for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>T</mi>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
. </li>
<li class="itemize_item" id='magicparlabel-621'>I will try to find a way to compute <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B4;</mi>
 <mi>t</mi>
</msub>
</math>
 given <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B4;</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>+</mo>
  <mn>1</mn>
 </mrow>
</msub>
</math>
 recursively from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mi>T</mi>
</msub>
</math>
 to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mn>0</mn>
</msub>
</math>
. 
<ul class='lyxitem lyxitemii'>
<li class="itemize_item" id='magicparlabel-622'>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mi>T</mi>
</mrow>
</math>
, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mi>T</mi>
 </msub>
</mrow>
</math>
, it is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>T</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x2113;</mi>
    <mi>T</mi>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>T</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mi>T</mi>
  </msub>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</li>
<li class="itemize_item" id='magicparlabel-623'>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>&lt;</mo>
 <mi>T</mi>
</mrow>
</math>
, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
, it is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x2113;</mi>
    <mi>t</mi>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mi>t</mi>
  </msub>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <msub>
   <mi>k</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
 </munderover>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x2113;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <msub>
   <mi>k</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
 </munderover>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
</mrow>
</math>
 and 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mfrac>
    <mrow>
     <mi>&#x2202;</mi>
     <msub>
      <mi>&#x3B1;</mi>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
       <mo stretchy='false'>,</mo>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
    <mrow>
     <mi>&#x2202;</mi>
     <msub>
      <mi>&#x3B1;</mi>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </mfrac>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mi>&#x2202;</mi>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>s</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <msub>
      <mi>k</mi>
      <mi>t</mi>
     </msub>
    </munderover>
    <msub>
     <mi>w</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
      <mo stretchy='false'>,</mo>
      <mi>s</mi>
     </mrow>
    </msub>
    <msub>
     <mi>o</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>s</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mi>&#x2202;</mi>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>s</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <msub>
      <mi>k</mi>
      <mi>t</mi>
     </msub>
    </munderover>
    <msub>
     <mi>w</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
      <mo stretchy='false'>,</mo>
      <mi>s</mi>
     </mrow>
    </msub>
    <msub>
     <mi>&#x3C3;</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>&#x3B1;</mi>
      <mrow>
       <mo stretchy='false'>,</mo>
       <mi>s</mi>
      </mrow>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>w</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
     </mrow>
    </msub>
    <mfrac>
     <mtext>d</mtext>
     <mrow>
      <mtext>d</mtext>
      <msub>
       <mi>&#x3B1;</mi>
       <mrow>
        <mo stretchy='false'>,</mo>
        <mi>i</mi>
       </mrow>
      </msub>
     </mrow>
    </mfrac>
    <msub>
     <mi>&#x3C3;</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>&#x3B1;</mi>
      <mrow>
       <mo stretchy='false'>,</mo>
       <mi>i</mi>
      </mrow>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
hence 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mtext>d</mtext>
  <mrow>
   <mtext>d</mtext>
   <msub>
    <mi>&#x3B1;</mi>
    <mrow>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mfrac>
 <msub>
  <mi>&#x3C3;</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mrow>
    <mo stretchy='false'>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <msub>
   <mi>k</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
 </munderover>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <msub>
  <mi>w</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
</mrow>
</math>
</li>
</ul>
</li></ul>
<div class='standard' id='magicparlabel-624'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-625'><span class="note_label">Note 68.</span>
Error back-propagation idea can also be used to efficiently compute the gradient <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x2207;</mi>
  <mi>x</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 of the loss function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 with respect to the inputs <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>x</mi>
</math>
. The idea is the same, use chain rule to find a recursive procedure from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mi>T</mi>
</msub>
</math>
 to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>V</mi>
 <mn>0</mn>
</msub>
</math>
. </div>
</div>



</section>
<section>
<h3 class='subsection' id='magicparlabel-649'><span class="subsection_label">5.2</span> Preconditioning and computation of the Hessian</h3>
<div class='note'>
<div class="note_item" id='magicparlabel-650'><span class="note_label">Note 69.</span>
Recall (Handout 3, Algorithm <a href="#alg_Stochastic_Gradient_descent_2">alg:Stochastic-Gradient-descent-2</a>), that SGD may be improved by using a suitable preconditioner <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>P</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 as
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>-</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <msub>
  <mi>P</mi>
  <mi>t</mi>
 </msub>
 <msub>
  <mi>&#x2207;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msup>
    <mi>z</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 such a preconditioner can be the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>P</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>[</mo>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>+</mo>
    <mi>&#x3F5;</mi>
    <msub>
     <mi>I</mi>
     <mi>d</mi>
    </msub>
   </mrow>
   <mo>]</mo>
  </mrow>
  <mrow>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
  </mrow>
 </msup>
</mrow>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>H</mi>
 <mi>t</mi>
</msub>
</math>
 is the Hessian of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msup>
    <mi>z</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3F5;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-651'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-652'><span class="note_label">Note 70.</span>
The computation of the Hessian <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>H</mi>
 <mi>t</mi>
</msub>
</math>
 can be done by using error propagation ideas for
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mrow>
   <mo>[</mo>
   <msub>
    <mi>H</mi>
    <mi>t</mi>
   </msub>
   <mo>]</mo>
  </mrow>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mrow>
   <mo>.</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>&#x2202;</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <mi>&#x2202;</mi>
      <msub>
       <mi>w</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mfrac>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mi>w</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>|</mo>
  </mrow>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>=</mo>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
 </msub>
</mrow>
</math>
 We will not go further to exact computations. </div>
</div>
<div class='standard' id='magicparlabel-653'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-654'><span class="note_label">Note 71.</span>
The exact computation of the Hessian <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>H</mi>
 <mi>t</mi>
</msub>
</math>
 of the loss <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>&#x22C5;</mo>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 in NN setting can be computationally expensive and hence approximations are often used (with hope to work well). One can implement the general purpose AdaGrad (Section <a href="#subsec_Adaptive_Stochastic_Gradient">subsec:Adaptive-Stochastic-Gradient</a>, Handout 3). In what follows we present other alternatives tailored to the NN model.</div>
</div>
<div class='standard' id='magicparlabel-655'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-656'><span class="note_label">Note 72.</span>
<a id="note_Consider_the_regression" />Consider the regression problem with predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>o</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x3B1;</mi>
  <mi>T</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
, and loss function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mn>2</mn>
 </mfrac>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mi>y</mi>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mn>2</mn>
 </msup>
</mrow>
</math>
. Then the Hessian of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x2113;</mi>
</math>
 is <a id="eq__17" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mi>H</mi>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mrow>
      <mtext>d</mtext>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>&#x2207;</mi>
         <mi>w</mi>
        </msub>
        <mi>&#x2113;</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mtext>d</mtext>
      <mi>w</mi>
     </mrow>
    </mfrac>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mtext>d</mtext>
     <mrow>
      <mtext>d</mtext>
      <mi>w</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>&#x2207;</mi>
       <mi>w</mi>
      </msub>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>h</mi>
          <mi>w</mi>
         </msub>
         <mrow>
          <mo>(</mo>
          <mi>x</mi>
          <mo>)</mo>
         </mrow>
         <mo stretchy='false'>-</mo>
         <mi>y</mi>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mi>&#x22A4;</mi>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.5)</mtext>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mtext>d</mtext>
       <mrow>
        <mtext>d</mtext>
        <mi>w</mi>
       </mrow>
      </mfrac>
      <msub>
       <mi>&#x2207;</mi>
       <mi>w</mi>
      </msub>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>h</mi>
        <mi>w</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
       </mrow>
       <mo stretchy='false'>-</mo>
       <mi>y</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>&#x22A4;</mi>
    </msup>
    <mo stretchy='false'>+</mo>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>&#x2207;</mi>
        <mi>w</mi>
       </msub>
       <msub>
        <mi>h</mi>
        <mi>w</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>&#x22A4;</mi>
    </msup>
   </mrow>
  </mtd>
  <mtd>
  </mtd>
 </mtr>
</mtable>
</math>
We can expect that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo>&#x2248;</mo>
 <mi>y</mi>
</mrow>
</math>
 provided that the network is well trained due to the global approximation ability of the FFNN. Yet, we can expect that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mi>y</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 provided that we train the network under the quadratic loss and because <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <munder accent='false'>
  <mrow>
   <mo>arg</mo>
   <mo>min</mo>
  </mrow>
  <mi>h</mi>
 </munder>
 <msub>
  <mtext>E</mtext>
  <mrow>
   <mi>y</mi>
   <mo>&#x223C;</mo>
   <mi>g</mi>
  </mrow>
 </msub>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <mi>h</mi>
    <mo stretchy='false'>-</mo>
    <mi>y</mi>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mn>2</mn>
 </msup>
 <mo stretchy='false'>=</mo>
 <msub>
  <mtext>E</mtext>
  <mrow>
   <mi>y</mi>
   <mo>&#x223C;</mo>
   <mi>g</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>y</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. Hence a reasonable approximation can be 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mi>H</mi>
  </mtd>
  <mtd>
   <mrow>
    <mo>&#x2248;</mo>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>&#x2207;</mi>
        <mi>w</mi>
       </msub>
       <msub>
        <mi>h</mi>
        <mi>w</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>&#x22A4;</mi>
    </msup>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mover accent='false'>
     <mo stretchy='false'>=</mo>
     <mrow>
      <msub>
       <mi>&#x3C3;</mi>
       <mi>T</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>a</mi>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>=</mo>
      <mi>a</mi>
     </mrow>
    </mover>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <msub>
     <mi>&#x3B1;</mi>
     <mi>T</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>&#x2207;</mi>
        <mi>w</mi>
       </msub>
       <msub>
        <mi>&#x3B1;</mi>
        <mi>T</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>&#x22A4;</mi>
    </msup>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 Consequently, the approximation of the Hessian of the Error function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>EF</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>|</mo>
   <mrow>
    <mo>{</mo>
    <msub>
     <mi>z</mi>
     <mi>i</mi>
    </msub>
    <mo>}</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>n</mi>
 </munderover>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is<a id="eq__7" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>n</mi>
    </msub>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mfrac>
     <mrow>
      <mtext>d</mtext>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>&#x2207;</mi>
         <mi>w</mi>
        </msub>
        <mtext>EF</mtext>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mtext>d</mtext>
      <mi>w</mi>
     </mrow>
    </mfrac>
    <mo>&#x2248;</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <msub>
     <mi>&#x2207;</mi>
     <mi>w</mi>
    </msub>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>&#x2207;</mi>
        <mi>w</mi>
       </msub>
       <msub>
        <mi>h</mi>
        <mi>w</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mi>&#x22A4;</mi>
    </msup>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.6)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-657'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-658'><span class="note_label">Note 73.</span>
<a id="note__Cont__Note__" />(Cont. Note <a href="#note_Consider_the_regression">72</a>) To efficiently compute the inverse <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mi>H</mi>
 <mi>n</mi>
 <mrow>
  <mo stretchy='false'>-</mo>
  <mn>1</mn>
 </mrow>
</msubsup>
</math>
 of <a href="#eq__7">(5.6)</a> I can utilize Woodbury identity<div class='marginal'><div class='plain_layout' id='magicparlabel-662'>No need to 
<br />
memorize 
<br />
Woodbury 
<br />
identity</div>
</div> <a id="eq__18" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>M</mi>
       <mo stretchy='false'>+</mo>
       <mi>v</mi>
       <msup>
        <mi>v</mi>
        <mi>&#x22A4;</mi>
       </msup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>M</mi>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>M</mi>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
        <mi>v</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>v</mi>
         <mi>&#x22A4;</mi>
        </msup>
        <msup>
         <mi>M</mi>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>+</mo>
      <msup>
       <mi>v</mi>
       <mi>&#x22A4;</mi>
      </msup>
      <msup>
       <mi>M</mi>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
      <mi>v</mi>
     </mrow>
    </mfrac>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.7)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
offering a way to avoid the computational expensive task of directly inverting the high dimensional <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>H</mi>
 <mi>n</mi>
</msub>
</math>
. Given <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>v</mi>
  <mi>i</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x2207;</mi>
  <mi>w</mi>
 </msub>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
, it is <a id="eq__8" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>H</mi>
       <mi>n</mi>
      </msub>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo>&#x2211;</mo>
        <mrow>
         <mi>i</mi>
         <mo stretchy='false'>=</mo>
         <mn>1</mn>
        </mrow>
        <mi>n</mi>
       </munderover>
       <msub>
        <mi>v</mi>
        <mi>i</mi>
       </msub>
       <msubsup>
        <mi>v</mi>
        <mi>i</mi>
        <mi>&#x22A4;</mi>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <munderover>
        <mo>&#x2211;</mo>
        <mrow>
         <mi>i</mi>
         <mo stretchy='false'>=</mo>
         <mn>1</mn>
        </mrow>
        <mrow>
         <mi>n</mi>
         <mo stretchy='false'>-</mo>
         <mn>1</mn>
        </mrow>
       </munderover>
       <msub>
        <mi>v</mi>
        <mi>i</mi>
       </msub>
       <msubsup>
        <mi>v</mi>
        <mi>i</mi>
        <mi>&#x22A4;</mi>
       </msubsup>
       <mo stretchy='false'>+</mo>
       <msub>
        <mi>v</mi>
        <mi>n</mi>
       </msub>
       <msubsup>
        <mi>v</mi>
        <mi>n</mi>
        <mi>&#x22A4;</mi>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>H</mi>
        <mrow>
         <mi>n</mi>
         <mo stretchy='false'>-</mo>
         <mn>1</mn>
        </mrow>
       </msub>
       <mo stretchy='false'>+</mo>
       <msub>
        <mi>v</mi>
        <mi>n</mi>
       </msub>
       <msubsup>
        <mi>v</mi>
        <mi>n</mi>
        <mi>&#x22A4;</mi>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msup>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.8)</mtext>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo stretchy='false'>=</mo>
  </mtd>
  <mtd>
   <mrow>
    <msubsup>
     <mi>H</mi>
     <mrow>
      <mi>n</mi>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msubsup>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msubsup>
         <mi>H</mi>
         <mrow>
          <mi>n</mi>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msubsup>
        <msub>
         <mi>v</mi>
         <mi>n</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msubsup>
         <mi>v</mi>
         <mi>n</mi>
         <mi>&#x22A4;</mi>
        </msubsup>
        <msubsup>
         <mi>H</mi>
         <mrow>
          <mi>n</mi>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
         <mrow>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msubsup>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>+</mo>
      <msubsup>
       <mi>v</mi>
       <mi>n</mi>
       <mi>&#x22A4;</mi>
      </msubsup>
      <msubsup>
       <mi>H</mi>
       <mrow>
        <mi>n</mi>
        <mo stretchy='false'>-</mo>
        <mn>1</mn>
       </mrow>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mn>1</mn>
       </mrow>
      </msubsup>
      <msub>
       <mi>v</mi>
       <mi>n</mi>
      </msub>
     </mrow>
    </mfrac>
   </mrow>
  </mtd>
  <mtd>
  </mtd>
 </mtr>
</mtable>
</math>
 In practice I start with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>H</mi>
  <mn>0</mn>
 </msub>
 <mo stretchy='false'>=</mo>
 <mi>&#x3F5;</mi>
 <mi>I</mi>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3F5;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 small, and iterate <a href="#eq__8">(5.8)</a>.</div>
</div>
<div class='standard' id='magicparlabel-663'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-664'><span class="note_label">Note 74.</span>
Likewise and by modifying <a href="#eq__17">(5.5)</a>, one can compute the corresponding approximations for the classification problems or problems with different loss functions. </div>
</div>


<div class='standard' id='magicparlabel-670'>
<br />
</div>
</section>
</section>
<section>
<h2 class='section' id='magicparlabel-671'><span class="section_label">6</span> <a id="sec_Bayesian_Artificial_Neural" /> Bayesian Artificial Neural Networks </h2>
<div class='note'>
<div class="note_item" id='magicparlabel-672'><span class="note_label">Note 75.</span>
Consider a feed-forward Neural Network with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x3C3;</mi>
  <mo stretchy='false'>,</mo>
  <mi>w</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
. Assume the architecture <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>V</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>E</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x3C3;</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 of a neural network is fixed/known, and interest lies in learning the weights <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>w</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-673'>
<br />
</div>
<div class='problem'>
<div class="problem_item" id='magicparlabel-674'><span class="problem_label">Problem 76.</span>
<a id="prob_Assume_there_is" /> Assume there is available a training set of examples (data-set) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>S</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <mi>n</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>X</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mrow>
   <mo>|</mo>
   <msub>
    <mi>V</mi>
    <mn>0</mn>
   </msub>
   <mo>|</mo>
  </mrow>
 </msup>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>y</mi>
  <mi>i</mi>
 </msub>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>Y</mi>
 </mstyle>
</mrow>
</math>
. The Bayesian NN model is then 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
<mtable>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>|</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>,</mo>
    <mi>w</mi>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mover accent='false'>
     <mo>&#x223C;</mo>
     <mtext>ind</mtext>
    </mover>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>|</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>,</mo>
      <mi>w</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
    <mspace width="6px"/>
    <mi>i</mi>
    <mo stretchy='false'>=</mo>
    <mn>1</mn>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <mi>n</mi>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mrow>
     <mo stretchy='false'>(</mo>sampling&#0160;distribution
     <mo stretchy='false'>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mi>w</mi>
  </mtd>
  <mtd>
   <mrow>
    <mo>&#x223C;</mo>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mi>w</mi>
     <mo>)</mo>
    </mrow>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mrow>
     <mo stretchy='false'>(</mo>prior&#0160;distribution
     <mo stretchy='false'>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
where the sampling distribution is specified either according to the experimental design (how <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>z</mi>
  <mi>i</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
) are collected or based on subjective judgments, while the prior distribution is specified based on subjective manner. </div>
</div>
<div class='standard' id='magicparlabel-675'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-676'><span class="note_label">Note 77.</span>
&#xA0;In most of the real applications, it is difficult (almost impossible) to specify the sampling distribution based on the experimental design or judgments, and almost impossible to specify the prior of the weights based on subjective judgments. </div>
</div>
<div class='standard' id='magicparlabel-677'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-678'><span class="note_label">Note 78.</span>
One could specify the sampling distribution based on the loss function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>w</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 as<a id="eq__15" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>|</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>,</mo>
      <mi>w</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo>&#x221D;</mo>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x2113;</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>h</mi>
         <mi>w</mi>
        </msub>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo stretchy='false'>,</mo>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(6.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 based on the argument that sampling distribution in the posterior distribution contraindicates how far the theoretical model <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 (as casted in a NN) is from the corresponding observation <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>y</mi>
 <mi>i</mi>
</msub>
</math>
 via the likelihood. </div>
</div>
<div class='standard' id='magicparlabel-679'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-680'><span class="note_label">Note 79.</span>
The prior density of the weights may be specified based on some shrinkage term <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>J</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>;</mo>
   <mi>&#x3BB;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 (Note <a href="#prob_Popular_shrinkage_terms">55</a>) as <a id="eq__13" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mi>w</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo>&#x221D;</mo>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>J</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>;</mo>
        <mi>&#x3BB;</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(6.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
based on the argument that I often model the predictive rule <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 with an over-parametrized NN (with many weighs, more than needed) and many of them should be shrunk to zero. Also as we see in Note <a href="#note_Training_of_non_linear">88</a>, careless training of NN tends to produce over-fitted NN with large weights (in abs values).</div>
</div>
<div class='standard' id='magicparlabel-681'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-682'><span class="note_label">Note 80.</span>
Regarding prior it is often, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo>&#x223C;</mo>
 <mtext>N</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>I</mi>
   <msup>
    <mi>&#x3BB;</mi>
    <mrow>
     <mo stretchy='false'>-</mo>
     <mn>1</mn>
    </mrow>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 for some small <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3BB;</mi>
</math>
 controlling prior uncertainty about weights, i.e. <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mn>50</mn>%
</mrow>
</math>
 chances for the weight to be above or below zero.</div>
</div>
<div class='standard' id='magicparlabel-683'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-684'><span class="note_label">Note 81.</span>
The corresponding posterior (according to the Bayes theorem) is
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>|</mo>
   <mrow>
    <mo>{</mo>
    <msub>
     <mi>z</mi>
     <mi>i</mi>
    </msub>
    <mo>}</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mo stretchy='false'>=</mo>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mfrac>
  <mrow>
   <munderover>
    <mo>&#x220F;</mo>
    <mrow>
     <mi>i</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>z</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>|</mo>
     <mi>w</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <mi>w</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mrow>
   <mo>&#x222B;</mo>
   <munderover>
    <mo>&#x220F;</mo>
    <mrow>
     <mi>i</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>z</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>|</mo>
     <mi>w</mi>
     <mo stretchy='false'>'</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>'</mo>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mtext>d</mtext>
   <mi>w</mi>
   <mo stretchy='false'>'</mo>
  </mrow>
 </mfrac>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mo>&#x221D;</mo>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <munderover>
  <mo>&#x220F;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>n</mi>
 </munderover>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
and given <a href="#eq__15">(6.1)</a> and <a href="#eq__13">(6.2)</a>, in log scale I get 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mo>log</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>|</mo>
     <mrow>
      <mo>{</mo>
      <msub>
       <mi>z</mi>
       <mi>i</mi>
      </msub>
      <mo>}</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo stretchy='false'>-</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>n</mi>
 </munderover>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>w</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>,</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo stretchy='false'>,</mo>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>-</mo>
 <mi>J</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>;</mo>
   <mi>&#x3BB;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>+</mo>
 <mtext>const</mtext>
</mrow>
</math>
 that resembles the EF with a shrinkage term in classical learning.</div>
</div>

<div class='example'>
<div class="example_item" id='magicparlabel-691'><span class="example_label">Example 82.</span>
(Regression problem) Sampling distribution can be specified as in <a href="#eq__15">(6.1)</a> based on (Euclidean) loss 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mi>&#x3B2;</mi>
  <mn>2</mn>
 </mfrac>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mi>y</mi>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mn>2</mn>
 </msup>
</mrow>
</math>
 which (based on <a href="#eq__11">(3.4)</a>) can build a density 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>y</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>,</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x221D;</mo>
 <mo>exp</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo stretchy='false'>-</mo>
   <mi>&#x2113;</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>h</mi>
      <mi>w</mi>
     </msub>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo>)</mo>
     </mrow>
     <mo stretchy='false'>,</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>y</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo stretchy='false'>-</mo>
 <mfrac>
  <mi>&#x3B2;</mi>
  <mn>2</mn>
 </mfrac>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mn>2</mn>
 </msup>
 <mo stretchy='false'>,</mo>
</mrow>
</math>
This implies a sampling distribution <a id="eq__9_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>|</mo>
    <msub>
     <mi>x</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>,</mo>
    <mi>w</mi>
    <mo>&#x223C;</mo>
    <mtext>N</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mstyle class='math'>
       <msub>
        <mi>&#x3BC;</mi>
        <mi>i</mi>
       </msub>
      </mstyle>
      <mo stretchy='false'>,</mo>
      <msup>
       <mi>&#x3B2;</mi>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mtext>where</mtext>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <msub>
     <mi>&#x3BC;</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>h</mi>
     <mi>w</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>x</mi>
      <mi>i</mi>
     </msub>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(6.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
for some fixed <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B2;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 based on <a href="#eq__9">(3.2)</a>. Prior can be specified with density <a href="#eq__13">(6.2)</a> where 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>J</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>;</mo>
   <mi>&#x3BB;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mi>&#x3BB;</mi>
  <mn>2</mn>
 </mfrac>
 <msubsup>
  <mrow>
   <mo>&#x2225;</mo>
   <mi>w</mi>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>2</mn>
  <mn>2</mn>
 </msubsup>
</mrow>
</math>
 which is based on the Ridge shrinkage term. This implies a prior<a id="eq__12" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mi>w</mi>
    <mo>&#x223C;</mo>
    <mtext>N</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>0</mn>
      <mo stretchy='false'>,</mo>
      <mi>I</mi>
      <msup>
       <mi>&#x3BB;</mi>
       <mrow>
        <mo stretchy='false'>-</mo>
        <mn>1</mn>
       </mrow>
      </msup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(6.4)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 The resulted posterior density is <a id="eq__14" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>|</mo>
      <mrow>
       <mo>{</mo>
       <msub>
        <mi>z</mi>
        <mi>i</mi>
       </msub>
       <mo>}</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>&#x221D;</mo>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mi>&#x3B2;</mi>
       <mn>2</mn>
      </mfrac>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>i</mi>
        <mo stretchy='false'>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>h</mi>
          <mi>w</mi>
         </msub>
         <mrow>
          <mo>(</mo>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>)</mo>
         </mrow>
         <mo stretchy='false'>-</mo>
         <msub>
          <mi>y</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mn>2</mn>
      </msup>
      <mo stretchy='false'>-</mo>
      <mfrac>
       <mi>&#x3BB;</mi>
       <mn>2</mn>
      </mfrac>
      <msubsup>
       <mrow>
        <mo>&#x2225;</mo>
        <mi>w</mi>
        <mo>&#x2225;</mo>
       </mrow>
       <mn>2</mn>
       <mn>2</mn>
      </msubsup>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(6.5)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-700'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-701'><span class="example_label">Example 83.</span>
(Binary classification problem) Sampling distribution can be specified as in <a href="#eq__15">(6.1)</a> based on (cross-entropy) loss 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>y</mi>
 <mo>log</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>h</mi>
    <mi>w</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>+</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>-</mo>
   <mi>y</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>-</mo>
   <mo>log</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <msub>
      <mi>h</mi>
      <mi>w</mi>
     </msub>
     <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
which (based on <a href="#eq__11">(3.4)</a>) can build a density 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>|</mo>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
      <mo stretchy='false'>,</mo>
      <mi>w</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo>&#x221D;</mo>
    <mo>exp</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x2113;</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>h</mi>
         <mi>w</mi>
        </msub>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo stretchy='false'>,</mo>
          <msub>
           <mi>y</mi>
           <mi>i</mi>
          </msub>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo>log</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>h</mi>
       <mi>w</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <msub>
        <mi>x</mi>
        <mi>i</mi>
       </msub>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <msub>
       <mi>y</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mn>1</mn>
      <mo stretchy='false'>-</mo>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>h</mi>
         <mi>w</mi>
        </msub>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
This implies a sampling distribution 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>y</mi>
  <mi>i</mi>
 </msub>
 <mo stretchy='false'>|</mo>
 <msub>
  <mi>x</mi>
  <mi>i</mi>
 </msub>
 <mo stretchy='false'>,</mo>
 <mi>w</mi>
 <mo>&#x223C;</mo>
 <mtext>Bernoulli</mtext>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>p</mi>
   <mi>i</mi>
  </msub>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>,</mo>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mtext>where</mtext>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <msub>
  <mi>p</mi>
  <mi>i</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>x</mi>
   <mi>i</mi>
  </msub>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
To encourage sparsity, prior can be specified as in <a href="#eq__13">(6.2)</a> by using the LASSO shrinkage term 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>J</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>;</mo>
   <mi>&#x3BB;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>&#x3BB;</mi>
 <msub>
  <mrow>
   <mo>&#x2225;</mo>
   <mi>w</mi>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>1</mn>
 </msub>
 <mo stretchy='false'>;</mo>
</mrow>
</math>
 The resulted posterior density is
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>|</mo>
   <mrow>
    <mo>{</mo>
    <msub>
     <mi>z</mi>
     <mi>i</mi>
    </msub>
    <mo>}</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x221D;</mo>
 <mo>exp</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo stretchy='false'>-</mo>
   <munderover>
    <mo>&#x2211;</mo>
    <mrow>
     <mi>i</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>n</mi>
   </munderover>
   <mrow>
    <mo>[</mo>
    <mrow>
     <msub>
      <mi>y</mi>
      <mi>i</mi>
     </msub>
     <mo>log</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msub>
        <mi>h</mi>
        <mi>w</mi>
       </msub>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo stretchy='false'>+</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>-</mo>
       <msub>
        <mi>y</mi>
        <mi>i</mi>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>-</mo>
       <mo>log</mo>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>h</mi>
          <mi>w</mi>
         </msub>
         <mrow>
          <mo>(</mo>
          <msub>
           <mi>x</mi>
           <mi>i</mi>
          </msub>
          <mo>)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>]</mo>
   </mrow>
   <mo stretchy='false'>-</mo>
   <mi>&#x3BB;</mi>
   <msub>
    <mrow>
     <mo>&#x2225;</mo>
     <mi>w</mi>
     <mo>&#x2225;</mo>
    </mrow>
    <mn>1</mn>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-727'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-728'><span class="note_label">Note 84.</span>
<a id="note_Sampling_from_the" /> Sampling from the posterior can be performed via SGLD due to the high-dimensionality in the weights <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 and the big size of the training data set. Recall the recursion of the SGLD with batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 is <a id="eq__16" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>+</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mi>n</mi>
       <mi>m</mi>
      </mfrac>
      <munder>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>j</mi>
        <mo>&#x2208;</mo>
        <msup>
         <mstyle mathvariant='script'>
          <mi>J</mi>
         </mstyle>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
       </mrow>
      </munder>
      <msub>
       <mi>&#x2207;</mi>
       <mi>w</mi>
      </msub>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msubsup>
           <mi>z</mi>
           <mi>j</mi>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mi>t</mi>
            <mo stretchy='false'>)</mo>
           </mrow>
          </msubsup>
          <mo stretchy='false'>|</mo>
          <msup>
           <mi>w</mi>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mi>t</mi>
            <mo stretchy='false'>)</mo>
           </mrow>
          </msup>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <msub>
       <mi>&#x2207;</mi>
       <mi>w</mi>
      </msub>
      <mo>log</mo>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <msup>
          <mi>w</mi>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mi>t</mi>
           <mo stretchy='false'>)</mo>
          </mrow>
         </msup>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <msqrt>
     <mrow>
      <mn>2</mn>
      <msub>
       <mi>&#x3B7;</mi>
       <mi>t</mi>
      </msub>
      <mi>&#x3C4;</mi>
     </mrow>
    </msqrt>
    <msub>
     <mi>&#x3F5;</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(6.6)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3F5;</mi>
  <mi>t</mi>
 </msub>
 <mo>&#x223C;</mo>
 <mtext>N</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mn>1</mn>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. (See Algorithm <a href="#alg_Stochastic_Gradient_Langevin">alg:Stochastic-Gradient-Langevin</a> in Lecture notes <a href="#enu_Handout___Bayesian">enu:Handout-:-Bayesian</a>: Bayesian Learning via Stochastic gradient and Stochastic gradient Langevin dynamics). </div>
</div>
<div class='standard' id='magicparlabel-729'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-730'><span class="note_label">Note 85.</span>
Given sample values <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mrow>
  <mo>{</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>}</mo>
 </mrow>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
 </mrow>
 <mi>T</mi>
</msubsup>
</math>
 produced from SGLD recursions <a href="#eq__16">(6.6)</a>, learning of any function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>h</mi>
  <mi>w</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 of the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
&#8217;s can be performed via </div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-731'>Monte Carlo estimation namely averaging the samples values <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mrow>
  <mo>{</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>}</mo>
 </mrow>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
 </mrow>
 <mi>T</mi>
</msubsup>
</math>
 as 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mover>
  <msub>
   <mi>h</mi>
   <mi>w</mi>
  </msub>
  <mo stretchy='true'>&#x005E;</mo>
 </mover>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mi>T</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>T</mi>
 </munderover>
 <msub>
  <mi>h</mi>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>,</mo>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mrow>
  <mo stretchy='false'>(</mo>Monte&#0160;Calro&#0160;estimator
  <mo stretchy='false'>)</mo>
 </mrow>
</mrow>
</math>
</li>
<li class="enumerate_item" id='magicparlabel-732'>Maximum-A-posteriori (MAP) estimation namely find the best <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mover>
  <mi>w</mi>
  <mo stretchy='true'>&#x02C6;</mo>
 </mover>
 <mo stretchy='false'>*</mo>
</msup>
</math>
 among the samples values <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mrow>
  <mo>{</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>}</mo>
 </mrow>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
 </mrow>
 <mi>T</mi>
</msubsup>
</math>
 that maximizes the posterior i.e
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mover>
   <mi>w</mi>
   <mo stretchy='true'>&#x02C6;</mo>
  </mover>
  <mo stretchy='false'>*</mo>
 </msup>
 <mo stretchy='false'>=</mo>
 <mo>arg</mo>
 <munder>
  <mo>max</mo>
  <mrow>
   <mi>w</mi>
   <mo>&#x2208;</mo>
   <msubsup>
    <mrow>
     <mo>{</mo>
     <msup>
      <mi>w</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
     <mo>}</mo>
    </mrow>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>T</mi>
   </msubsup>
  </mrow>
 </munder>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>log</mo>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mrow>
      <mo>{</mo>
      <msub>
       <mi>z</mi>
       <mi>i</mi>
      </msub>
      <mo>}</mo>
     </mrow>
     <mo stretchy='false'>|</mo>
     <mi>w</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>+</mo>
   <mo>log</mo>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <mi>w</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and compute
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mover>
  <msub>
   <mi>h</mi>
   <mi>w</mi>
  </msub>
  <mo stretchy='true'>&#x005E;</mo>
 </mover>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>h</mi>
  <msup>
   <mover>
    <mi>w</mi>
    <mo stretchy='true'>&#x02C6;</mo>
   </mover>
   <mo stretchy='false'>*</mo>
  </msup>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>x</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>,</mo>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mrow>
  <mo stretchy='false'>(</mo>MAP&#0160;estimator
  <mo stretchy='false'>)</mo>
 </mrow>
</mrow>
</math>
</li>
</ol>
</div>
<div class='standard' id='magicparlabel-733'>
<br />
</div>


</section>
<section>
<h2 class='section' id='magicparlabel-740'><span class="section_label">7</span> <a id="sec_Theoretical_aspects" />Theoretical aspects</h2>
<div class='note'>
<div class="note_item" id='magicparlabel-741'><span class="note_label">Note 86.</span>
We will not go this direction here. For the interested student, I suggest for starters, Ch 5 from &#8220;Ripley, B. D. (2007). Pattern recognition and neural networks. Cambridge university press.&#8221;; and for advanced Ch 30 from &#8220;Devroye, L., GyÃ¶rfi, L., &amp; Lugosi, G. (2013). A probabilistic theory of pattern recognition (Vol. 31). Springer Science &amp; Business Media.&#8221;</div>
</div>


<div class='standard' id='magicparlabel-747'>
<br />
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-748'><span class="section_label">8</span> Comments, guidelines, and discussions</h2>
<section>
<h3 class='subsection' id='magicparlabel-749'><span class="subsection_label">8.1</span> Over-fitting issues </h3>
<div class='note'>
<div class="note_item" id='magicparlabel-750'><span class="note_label">Note 87.</span>
Neural Networks can be highly &#8220;over-parametrized&#8221;. E.g. they may consist of a large number of layers each of them having a large number of neurons with purpose to represent each feature/characteristic of the pattern to be recognized âthis increases the number of unknown weights to be learned. Careless training may produce NN models with bad generalization predictive properties.</div>
</div>
<div class='standard' id='magicparlabel-751'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-752'><span class="note_label">Note 88.</span>
<a id="note_Training_of_non_linear" /> Training of NN models corresponds to an iterative reduction of the Error Function defined on the training data-set. On the other hand it has been observed that the Error Function defined on the validation data-set (independent to the training data set) often shows a decrease at first (while NN is being tuned), followed by an increase (while the NN starts to overfit). The reason is because the NN training is a a high-dimensional and big-data problem; hence during the NN training against the EF defined on the training data, the NN memorises too much info from the specific training dataset, overfits to it, and presents bad generalization performance. This over-fitting is often associated to the production of weight values larger than needed for the NN learning rule to have a good generalization performance. It is desirable to avoid this over-fitting with purpose to obtain a NN based learning rule with good generalization performance. <div class='float-figure'>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-760'><img style='width:48%;' src='e_145cf639326c_ann-training-set-error.png' alt='image: e_145cf639326c_ann-training-set-error.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure a:  training set</span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-768'><img style='width:48%;' src='e_be3a99976b1f_ann-validation-set-error.png' alt='image: e_be3a99976b1f_ann-validation-set-error.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure b:  validation set</span></div>
</div>



<div class='float-figure'><div class='plain_layout' id='magicparlabel-777'><img style='width:48%;' src='e_a0f97651da88_ann-training-set-error-1.png' alt='image: e_a0f97651da88_ann-training-set-error-1.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure c:  loss function</span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-785'><img style='width:48%;' src='e_b644bcc641f2_ann-validation-set-error-1.png' alt='image: e_b644bcc641f2_ann-validation-set-error-1.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure d:  accuracy</span></div>
</div>


<div class='plain_layout' id='magicparlabel-790'><span class='float-caption-Standard float-caption float-caption-standard'>Figure 8.1:  Behavior of the Error Function wrt the iterations, against a training set and against a validation set.</span></div>
</div>
</div>
</div>
<div class='standard' id='magicparlabel-795'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-796'><span class="note_label">Note 89.</span>
<b>Early stopping</b> is a way of limiting the effective network complexity by halting training before a minimum of the training error has been reached. During training of NN against the MM defined on the training set, we monitor the NN performance against the EF defined on the validation data-set, and stop the training procedure just before the EF defined on the validation data set starts increasing (aka before overfitting) to prevent the model memorizing too much information about the training set. </div>
</div>
<div class='standard' id='magicparlabel-797'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-798'><span class="note_label">Note 90.</span>
<b>Regularization</b> (Section <a href="#subsec_Regularization">4.2</a>) can be used to address the above issue by using a shrinkage term preventing the weights to grow too much away from zero. </div>
</div>
</section>
<section>
<h3 class='subsection' id='magicparlabel-799'><span class="subsection_label">8.2</span> Non-identifiabilities</h3>
<div class='note'>
<div class="note_item" id='magicparlabel-800'><span class="note_label">Note 91.</span>
<a id="note_The_weights_" /> NN Learning Problems (E.g, Problems <a href="#prob_Find__">50</a>, <a href="#prob_Compute_optimal_">51</a>, <a href="#prob_Often_neural_network">54</a>, and <a href="#prob_Assume_there_is">76</a>) are often non-identifiable with respect to weights <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>w</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>}</mo>
</mrow>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-801'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-802'><span class="example_label">Example 92.</span>
Consider the FFNN in Figure <a href="#fig_A_FFNN">8.2</a> with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
 hidden layer of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>M</mi>
</math>
 neurons, activation function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mn>1</mn>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo>tanh</mo>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and and full connectivity in both layers. If we flip the sign of all of the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
&#8217;s feeding into a particular hidden unit (for a given input pattern) then the sign of the activation of the hidden unit will be reversed because <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>tanh</mo>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mrow>
   <mo stretchy='false'>-</mo>
   <mi>a</mi>
  </mrow>
  <mo stretchy='false'>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo stretchy='false'>-</mo>
 <mo>tanh</mo>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>a</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</mrow>
</math>
. This transformation can be compensated by changing the sign of all of the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
&#8217;s leading out of that hidden unit. By changing the signs of a particular group of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
&#8217;s, the input-output mapping function represented by the FFNN is unchanged, and so there are two different weight vectors resulting the same mapping function. I can do <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>M</mi>
</math>
 such flips (there are <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>M</mi>
</math>
 hidden nuerons) leading to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mn>2</mn>
 <mi>M</mi>
</msup>
</math>
 equivalent parameter settings. Similarly, we can permulte the labels of the neurons in hidden layer without changing the loss function; there are <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>M</mi>
 <mo stretchy='false'>!</mo>
</mrow>
</math>
 such permutations. Hence the equivalent parameter settings in total are <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mn>2</mn>
  <mi>M</mi>
 </msup>
 <mi>M</mi>
 <mo stretchy='false'>!</mo>
</mrow>
</math>
. âThis is not harmful in training or predictive rul computation as we just need to find one such parameter setting. <div class='float-figure'><div class='plain_layout' id='magicparlabel-806'><img src='e_4347ec3b4242_ann-1-hiden-layer-nn-bishop.png' alt='image: e_4347ec3b4242_ann-1-hiden-layer-nn-bishop.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Figure 8.2:  <a id="fig_A_FFNN" />A FFNN</span></div>
</div>
</div>
</div>
</section>
<section>
<h3 class='subsection' id='magicparlabel-811'><span class="subsection_label">8.3</span> Non-convexity</h3>
<div class='note'>
<div class="note_item" id='magicparlabel-812'><span class="note_label">Note 93.</span>
Learning problems with NN are non-convex, hence the loss function to be minimized has many local minima. The consequence is that the SGD/SGLD learning algorithms may be trapped in a local optima and never reach any of the global ones. The number of local minima is exaggerated due to the symmetries discussed in Note <a href="#note_The_weights_">91</a>. Due to the large number of data (big-data) used to train the NN (in real life) such local minima become more shallow while the global minima more picky. Due to this and the stochastic nature of SGD/SGLD algorithms, SGD/SGLD may be able (by chance) to escape from such local minima/maxima and reach the global ones. </div>
</div>
<div class='standard' id='magicparlabel-813'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-814'><span class="note_label">Note 94.</span>
To address local optima issue, run SGD/SGLD learning algorithms multiple times by initializing them with different seeds each time. </div>
</div>

</section>
<section>
<h3 class='subsection' id='magicparlabel-825'><span class="subsection_label">8.4</span> Vanishing and exploding gradient</h3>
<div class='note'>
<div class="note_item" id='magicparlabel-826'><span class="note_label">Note 95.</span>
In the Error back-propagation Algorithm <a href="#alg__Error_backpropagation_">64</a>, for the computation of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <mfrac>
   <mrow>
    <mi>&#x2202;</mi>
    <mi>&#x2113;</mi>
   </mrow>
   <mrow>
    <mi>&#x2202;</mi>
    <msub>
     <mi>w</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>i</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
   </mrow>
  </mfrac>
  <mrow>
   <mo>(</mo>
   <mrow>
    <mi>w</mi>
    <mo stretchy='false'>,</mo>
    <mi>z</mi>
   </mrow>
   <mo>)</mo>
  </mrow>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 crucial quantities are the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3B4;</mi>
</math>
-derivatives the propagation of which follows the recursive rule <a href="#eq__22">(5.2)</a>, i.e. 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <msub>
   <mi>k</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
  </msub>
 </munderover>
 <msub>
  <mi>w</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>+</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>'</mo>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>;</mo>
 <mspace width="6px"/>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mi>T</mi>
 <mo stretchy='false'>-</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mn>1</mn>
 <mo stretchy='false'>;</mo>
 <mspace width="6px"/>
 <mi>i</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <msub>
  <mi>k</mi>
  <mi>t</mi>
 </msub>
</mrow>
</math>
 <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B4;</mi>
 <mi>t</mi>
</msub>
</math>
-derivatives depend on the respective <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B4;</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>+</mo>
  <mn>1</mn>
 </mrow>
</msub>
</math>
-derivatives, weights, and derivatives of the sigmoid in a multiplicative manner. Keeping on 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3B4;</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>i</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>[</mo>
  <mrow>
   <munderover>
    <mo>&#x2211;</mo>
    <mrow>
     <mi>j</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
    </mrow>
    <msub>
     <mi>k</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
    </msub>
   </munderover>
   <mrow>
    <mo>(</mo>
    <mrow>
     <munderover>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>s</mi>
       <mo stretchy='false'>=</mo>
       <mn>1</mn>
      </mrow>
      <msub>
       <mi>k</mi>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>+</mo>
        <mn>2</mn>
       </mrow>
      </msub>
     </munderover>
     <msub>
      <mi>&#x3B4;</mi>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
       <mo stretchy='false'>,</mo>
       <mi>s</mi>
      </mrow>
     </msub>
     <msub>
      <mi>w</mi>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>2</mn>
       <mo stretchy='false'>,</mo>
       <mi>s</mi>
       <mo stretchy='false'>,</mo>
       <mi>j</mi>
      </mrow>
     </msub>
    </mrow>
    <mo>)</mo>
   </mrow>
   <msub>
    <mi>&#x3C3;</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo stretchy='false'>'</mo>
   <mrow>
    <mo>(</mo>
    <msub>
     <mi>&#x3B1;</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo>)</mo>
   </mrow>
   <msub>
    <mi>w</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>]</mo>
 </mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>'</mo>
 <mrow>
  <mo>(</mo>
  <msub>
   <mi>&#x3B1;</mi>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>,</mo>
    <mi>i</mi>
   </mrow>
  </msub>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
we see that as the backpropagation algorithm flows backwards, the derivatives of the sigmoids as well as the weights are multiplied and the number of the involved products grows. This may cause the two problems: vanishing or exploding gradient.</div>
</div>
<div class='standard' id='magicparlabel-827'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-828'><span class="note_label">Note 96.</span>
This is more powerful in lower layers. </div>
</div>
<div class='standard' id='magicparlabel-829'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-830'><span class="note_label">Note 97.</span>
This exaggerates in deeper structures of NN. </div>
</div>
<div class='standard' id='magicparlabel-831'>
<br />
</div>
<section>
<h4 class='subsubsection' id='magicparlabel-832'><span class="subsubsection_label">8.4.1</span> Vanishing gradient</h4>
<div class='standard' id='magicparlabel-833'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-834'><span class="note_label">Note 98.</span>
As <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>'</mo>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 are often smaller than <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
 if the corresponding weights are not large enough, the gradients of the loss wrt the weights of the lower layers can take vanishingly small values and make training via SGD too slow. </div>
</div>
<div class='standard' id='magicparlabel-835'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-836'><span class="note_label">Note 99.</span>
A remedy to mitigate vanishing gradient is to use rectified linear unit (ReLU) activation functions 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>t</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo>max</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>&#x3B1;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>+</mo>
 <mi>&#x3BE;</mi>
 <mo>min</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>0</mn>
   <mo stretchy='false'>,</mo>
   <mi>&#x3B1;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3BE;</mi>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 is a user specified parameter. For instance: if <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3BE;</mi>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
, we observe that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>'</mo>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
 when <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B1;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 hence it does not suffer from saturation. However the training may freeze when <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B1;</mi>
 <mo stretchy='false'>&lt;</mo>
 <mn>0</mn>
</mrow>
</math>
 since <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3C3;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>'</mo>
 <mrow>
  <mo>(</mo>
  <mi>&#x3B1;</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
, and hence we often consider some <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>|</mo>
  <mi>&#x3BE;</mi>
  <mo>|</mo>
 </mrow>
 <mo>&#x2248;</mo>
 <mtext>small</mtext>
</mrow>
</math>
 depending on the application. </div>
</div>
</section>
<section>
<h4 class='subsubsection' id='magicparlabel-841'><span class="subsubsection_label">8.4.2</span> Exploding gradient </h4>
<div class='note'>
<div class="note_item" id='magicparlabel-842'><span class="note_label">Note 100.</span>
If the values of the weights get very large values, this can lead to an explosion of the gradient estimates. This can affect the learning by pushing the estimates of the weights to the wrong region in the parameter space when SGD is used.</div>
</div>
<div class='standard' id='magicparlabel-843'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-844'><span class="note_label">Note 101.</span>
Remedies of this are clipping the gradient in SGD (Note <a href="#note_Gradient_scaling_involves">note:Gradient-scaling-involves</a> in Handout <a href="#enu_Handout___Bayesian">enu:Handout-:-Bayesian</a>: Bayesian Learning via Stochastic gradient and Stochastic gradient Langevin dynamics), the use of shrinkage terms in the learning problem (Section <a href="#subsec_Regularization">4.2</a>), or the use of Bayesian framework with appropriate priors (Section <a href="#sec_Bayesian_Artificial_Neural">6</a>). </div>
</div>

</section>
</section>
<section>
<h3 class='subsection' id='magicparlabel-854'><span class="subsection_label">8.5</span> Skip-layers</h3>
<div class='note'>
<div class="note_item" id='magicparlabel-855'><span class="note_label">Note 102.</span>
The general definition of feed forward Neural Network allows &#8220;skip-layer&#8221; connections that is the directed graph <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>G</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 in NN architecture includes edges which may not necessarily connect neurons between consecutive layers, namely <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>,</mo>
     <mi>j</mi>
    </mrow>
   </msub>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>v</mi>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>+</mo>
     <mi>k</mi>
     <mo stretchy='false'>,</mo>
     <mi>i</mi>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
</mrow>
</math>
 for some <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>k</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>1</mn>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-856'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-857'><span class="example_label">Example 103.</span>
For instance, a fully connected FFNN with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
 hidden layer is<a id="eq_weetwetfwert" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>h</mi>
     <mi>k</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mi>&#x3C3;</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mn>2</mn>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <munder accent='false'>
       <munder>
        <mrow>
         <munder>
          <mo>&#x2211;</mo>
          <mrow>
           <mi>&#x2200;</mi>
           <mi>i</mi>
          </mrow>
         </munder>
         <msubsup>
          <mi>w</mi>
          <mrow>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mn>1</mn>
            <mo stretchy='false'>)</mo>
           </mrow>
           <mo stretchy='false'>,</mo>
           <mi>k</mi>
           <mo stretchy='false'>,</mo>
           <mi>i</mi>
          </mrow>
          <mtext>skip</mtext>
         </msubsup>
         <msub>
          <mi>x</mi>
          <mi>i</mi>
         </msub>
        </mrow>
        <mo stretchy='true'>&#x23DF;</mo>
       </munder>
       <mtext>skip&#0160;layer&#0160;terms</mtext>
      </munder>
      <mo stretchy='false'>+</mo>
      <munder>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>&#x2200;</mi>
        <mi>j</mi>
       </mrow>
      </munder>
      <msub>
       <mi>w</mi>
       <mrow>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mn>2</mn>
         <mo stretchy='false'>)</mo>
        </mrow>
        <mo stretchy='false'>,</mo>
        <mi>k</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
      <msub>
       <mi>&#x3C3;</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mn>1</mn>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <munder>
         <mo>&#x2211;</mo>
         <mrow>
          <mi>&#x2200;</mi>
          <mi>i</mi>
         </mrow>
        </munder>
        <msub>
         <mi>w</mi>
         <mrow>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mn>1</mn>
           <mo stretchy='false'>)</mo>
          </mrow>
          <mo stretchy='false'>,</mo>
          <mi>j</mi>
          <mo stretchy='false'>,</mo>
          <mi>i</mi>
         </mrow>
        </msub>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(8.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 Compared to <a href="#eq_ergtgqert">(2.4)</a> in Example <a href="#exa__Cont__Example___1">33</a> and <a href="#eq_ergtgqert">(2.4)</a>, <a href="#eq_weetwetfwert">(8.1)</a> links the input to the output.</div>
</div>
<div class='standard' id='magicparlabel-858'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-859'><span class="note_label">Note 104.</span>
In skip-layer FFNN cases, the error back propagation (Section <a href="#subsec_Error_backpropagation__to">5.1</a>) has to be adjusted properly. </div>
</div>
<div class='standard' id='magicparlabel-860'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-861'><span class="note_label">Note 105.</span>
FFNN are mainly used without skip-layers because theory (Section <a href="#sec_Theoretical_aspects">7</a>) states that FFNN are global approximators even without skip layers, as well as because of computational inconvenience and modeling parsimony.</div>
</div>
<div class='standard' id='magicparlabel-862'>
<br />
</div>

<div class='standard' id='magicparlabel-863'><br /></div>
</section>
</section>
<section>
<h2 class='section' id='magicparlabel-864'><span class="section_label">A</span> About graphs</h2>
<div class='definition'>
<div class="definition_item" id='magicparlabel-865'><span class="definition_label">Definition 106.</span>
A directed graph is an ordered pair <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>G</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 comprising </div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-871'>a set of nodes <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>V</mi>
</mstyle>
</math>
 (or vertices), where a nodes are abstract objects, and </li>
<li class="itemize_item" id='magicparlabel-872'>a set of edges <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>v</mi>
     <mo stretchy='false'>,</mo>
     <mi>u</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>|</mo>
   <mi>v</mi>
   <mo>&#x2208;</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mi>u</mi>
   <mo>&#x2208;</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mi>v</mi>
   <mo>&#x2260;</mo>
   <mi>u</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 (or directed edges, directed links, arrows)  which are ordered pairs of vertices (that is, an edge is associated with two distinct vertices). </li>
</ul>
</div>
<div class='standard' id='magicparlabel-873'>
<br />
</div>
<div class='definition'>
<div class="definition_item" id='magicparlabel-874'><span class="definition_label">Definition 107.</span>
An edge-weighted graph or a network is a graph <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>G</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mstyle mathvariant='script'>
    <mi>V</mi>
   </mstyle>
   <mo stretchy='false'>,</mo>
   <mstyle mathvariant='script'>
    <mi>E</mi>
   </mstyle>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 equipped with a weight function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo stretchy='false'>:</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 that assigns a number (the weight) to each edge <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>e</mi>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>E</mi>
 </mstyle>
</mrow>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-875'>
<br />
</div>


<div class='float-figure'>

<div class='plain_layout' id='magicparlabel-881'><img style='width:50%;' src='e_734a86013563_directed-graph.png' alt='image: e_734a86013563_directed-graph.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Figure A.1:  A directed graph</span></div>


</div>

</section>
<section>
<h2 class='section' id='magicparlabel-887'><span class="section_label">B</span> About Partial derivatives</h2>
<div class='note'>
<div class="note_item" id='magicparlabel-888'><span class="note_label">Note 108.</span>
Consider a function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>n</mi>
 </msup>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
. </div>
</div>
<div class='definition'>
<div class="definition_item" id='magicparlabel-889'><span class="definition_label">Definition 109.</span>
<a id="def_The_partial_derivative" />The partial derivative of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>n</mi>
 </msup>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 at the point <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>a</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy='false'>,</mo>
   <mi>&#x2026;</mi>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <mo stretchy='false'>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mi>U</mi>
 <mo>&#x2286;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>n</mi>
 </msup>
</mrow>
</math>
 with respect to the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
-th variable is denoted as 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <mi>f</mi>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mtext>or&#0160;</mtext>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <msub>
  <mrow>
   <mo>.</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mi>&#x2202;</mi>
      <mi>f</mi>
     </mrow>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>x</mi>
       <mi>i</mi>
      </msub>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mi>x</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>|</mo>
  </mrow>
  <mrow>
   <mi>x</mi>
   <mo stretchy='false'>=</mo>
   <mi>a</mi>
  </mrow>
 </msub>
</mrow>
</math>
 and defined as
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <msub>
    <mrow>
     <mo>.</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>&#x2202;</mi>
        <mi>f</mi>
       </mrow>
       <mrow>
        <mi>&#x2202;</mi>
        <msub>
         <mi>x</mi>
         <mi>i</mi>
        </msub>
       </mrow>
      </mfrac>
      <mrow>
       <mo>(</mo>
       <mi>x</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>|</mo>
    </mrow>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>=</mo>
     <mi>a</mi>
    </mrow>
   </msub>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munder>
     <mo>lim</mo>
     <mrow>
      <mi>h</mi>
      <mo>&#x2192;</mo>
      <mn>0</mn>
     </mrow>
    </munder>
    <mfrac>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>1</mn>
        </msub>
        <mo stretchy='false'>,</mo>
        <mn>...</mn>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>a</mi>
         <mrow>
          <mi>i</mi>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>+</mo>
        <mi>h</mi>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>a</mi>
         <mrow>
          <mi>i</mi>
          <mo stretchy='false'>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy='false'>,</mo>
        <mn>...</mn>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>a</mi>
         <mi>n</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msub>
         <mi>a</mi>
         <mn>1</mn>
        </msub>
        <mo stretchy='false'>,</mo>
        <mn>...</mn>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>a</mi>
         <mrow>
          <mi>i</mi>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>a</mi>
         <mi>i</mi>
        </msub>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>a</mi>
         <mrow>
          <mi>i</mi>
          <mo stretchy='false'>+</mo>
          <mn>1</mn>
         </mrow>
        </msub>
        <mo stretchy='false'>,</mo>
        <mn>...</mn>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>a</mi>
         <mi>n</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mi>h</mi>
    </mfrac>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <munder>
     <mo>lim</mo>
     <mrow>
      <mi>h</mi>
      <mo>&#x2192;</mo>
      <mn>0</mn>
     </mrow>
    </munder>
    <mfrac>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>a</mi>
        <mo stretchy='false'>+</mo>
        <mi>h</mi>
        <msub>
         <mi>e</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>a</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mi>h</mi>
    </mfrac>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>e</mi>
 <mi>i</mi>
</msub>
</math>
 is a <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mn>0</mn>
 <mo stretchy='false'>-</mo>
 <mn>1</mn>
</mrow>
</math>
 vector with only one ace in the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
-th location. </div>
</div>
<div class='standard' id='magicparlabel-890'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-891'><span class="remark_label">Remark 110.</span>
Essentially, Definition <a href="#def_The_partial_derivative">109</a> says that the partial derivative of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>n</mi>
 </msup>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 at the point <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>a</mi>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy='false'>,</mo>
   <mi>&#x2026;</mi>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <mo stretchy='false'>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mi>U</mi>
 <mo>&#x2286;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>n</mi>
 </msup>
</mrow>
</math>
 with respect to the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>i</mi>
</math>
-th variable is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <mi>f</mi>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>x</mi>
    <mi>i</mi>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mrow>
   <mo>.</mo>
   <mrow>
    <mfrac>
     <mrow>
      <mtext>d</mtext>
      <mi>g</mi>
     </mrow>
     <mrow>
      <mtext>d</mtext>
      <mi>h</mi>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mi>h</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>|</mo>
  </mrow>
  <mrow>
   <mi>h</mi>
   <mo stretchy='false'>=</mo>
   <mn>0</mn>
  </mrow>
 </msub>
</mrow>
</math>
 the derivative of function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>g</mi>
 <mrow>
  <mo>(</mo>
  <mi>h</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>a</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>i</mi>
     <mo stretchy='false'>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>a</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>+</mo>
   <mi>h</mi>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>a</mi>
    <mrow>
     <mi>i</mi>
     <mo stretchy='false'>+</mo>
     <mn>1</mn>
    </mrow>
   </msub>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>a</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 at value <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>0</mn>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-892'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-893'><span class="example_label">Example 111.</span>
Consider a function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>f</mi>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msubsup>
  <mi>x</mi>
  <mn>1</mn>
  <mn>2</mn>
 </msubsup>
 <mo stretchy='false'>+</mo>
 <msub>
  <mi>x</mi>
  <mn>1</mn>
 </msub>
 <msubsup>
  <mi>x</mi>
  <mn>2</mn>
  <mn>3</mn>
 </msubsup>
</mrow>
</math>
. Comput is partial derivatives at <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>a</mi>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <mn>2</mn>
    <mo stretchy='false'>,</mo>
    <mn>3</mn>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
; i.e. <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <mi>f</mi>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>x</mi>
    <mn>1</mn>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mfrac>
  <mrow>
   <mi>&#x2202;</mi>
   <mi>f</mi>
  </mrow>
  <mrow>
   <mi>&#x2202;</mi>
   <msub>
    <mi>x</mi>
    <mn>2</mn>
   </msub>
  </mrow>
 </mfrac>
 <mrow>
  <mo>(</mo>
  <mi>a</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. </div>
<div class='solution_'>
<div class="solution__item" id='magicparlabel-894'><span class="solution__label">Solution.</span>
It is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mfrac>
     <mrow>
      <mi>&#x2202;</mi>
      <mi>f</mi>
     </mrow>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>x</mi>
       <mn>1</mn>
      </msub>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mi>a</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mrow>
      <mo>.</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mi>&#x2202;</mi>
         <mi>f</mi>
        </mrow>
        <mrow>
         <mi>&#x2202;</mi>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mfrac>
       <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo stretchy='false'>=</mo>
      <mi>a</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>=</mo>
    <msub>
     <mrow>
      <mo>.</mo>
      <mrow>
       <mfrac>
        <mtext>d</mtext>
        <mrow>
         <mtext>d</mtext>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
        </mrow>
       </mfrac>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msubsup>
          <mi>x</mi>
          <mn>1</mn>
          <mn>2</mn>
         </msubsup>
         <mo stretchy='false'>+</mo>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
         <msubsup>
          <mi>x</mi>
          <mn>2</mn>
          <mn>3</mn>
         </msubsup>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo stretchy='false'>=</mo>
      <mi>a</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>=</mo>
    <msub>
     <mrow>
      <mo>.</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <mo stretchy='false'>+</mo>
       <msubsup>
        <mi>x</mi>
        <mn>2</mn>
        <mn>3</mn>
       </msubsup>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo stretchy='false'>=</mo>
      <mi>a</mi>
     </mrow>
    </msub>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mn>2</mn>
    <msub>
     <mi>a</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy='false'>+</mo>
    <msubsup>
     <mi>a</mi>
     <mn>2</mn>
     <mn>3</mn>
    </msubsup>
    <mo stretchy='false'>=</mo>
    <mn>4</mn>
    <mo stretchy='false'>+</mo>
    <mn>27</mn>
    <mo stretchy='false'>=</mo>
    <mn>31</mn>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <mfrac>
     <mrow>
      <mi>&#x2202;</mi>
      <mi>f</mi>
     </mrow>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>x</mi>
       <mn>2</mn>
      </msub>
     </mrow>
    </mfrac>
    <mrow>
     <mo>(</mo>
     <mi>a</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mrow>
      <mo>.</mo>
      <mrow>
       <mfrac>
        <mrow>
         <mi>&#x2202;</mi>
         <mi>f</mi>
        </mrow>
        <mrow>
         <mi>&#x2202;</mi>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mfrac>
       <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo stretchy='false'>=</mo>
      <mi>a</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>=</mo>
    <msub>
     <mrow>
      <mo>.</mo>
      <mrow>
       <mfrac>
        <mtext>d</mtext>
        <mrow>
         <mtext>d</mtext>
         <msub>
          <mi>x</mi>
          <mn>2</mn>
         </msub>
        </mrow>
       </mfrac>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msubsup>
          <mi>x</mi>
          <mn>1</mn>
          <mn>2</mn>
         </msubsup>
         <mo stretchy='false'>+</mo>
         <msub>
          <mi>x</mi>
          <mn>1</mn>
         </msub>
         <msubsup>
          <mi>x</mi>
          <mn>2</mn>
          <mn>3</mn>
         </msubsup>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo stretchy='false'>=</mo>
      <mi>a</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>=</mo>
    <msub>
     <mrow>
      <mo>.</mo>
      <mrow>
       <mn>2</mn>
       <msub>
        <mi>x</mi>
        <mn>1</mn>
       </msub>
       <msubsup>
        <mi>x</mi>
        <mn>2</mn>
        <mn>2</mn>
       </msubsup>
      </mrow>
      <mo>|</mo>
     </mrow>
     <mrow>
      <mi>x</mi>
      <mo stretchy='false'>=</mo>
      <mi>a</mi>
     </mrow>
    </msub>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mn>2</mn>
    <msub>
     <mi>a</mi>
     <mn>1</mn>
    </msub>
    <msubsup>
     <mi>a</mi>
     <mn>2</mn>
     <mn>2</mn>
    </msubsup>
    <mo stretchy='false'>=</mo>
    <mn>4</mn>
    <mo stretchy='false'>+</mo>
    <mn>27</mn>
    <mo stretchy='false'>=</mo>
    <mn>72</mn>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
</div>
<div class='standard' id='magicparlabel-919'>
<br />
</div>
</section>
</body>
</html>
