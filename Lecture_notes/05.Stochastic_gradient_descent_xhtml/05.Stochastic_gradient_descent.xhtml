<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta name="generator" content="LyX 2.4.1" />
<title>LyX Document</title>
<style>
/* LyX Provided Styles */
mstyle.math { font-style: italic; }

/* Layout-provided Styles */
div.standard {
text-align: left;

}
div.plain_layout {
text-align: left;

}
h3.subsection_ {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ol.enumi   { list-style-type: decimal; }
ol.enumii  { list-style-type: lower-latin; }
ol.enumiii { list-style-type: lower-roman; }
ol.enumiv  { list-style-type: upper-latin; }
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h2.section {
font-weight: normal;
font-style: normal;
font-variant: small-caps;
font-size: medium;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.theorem {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.theorem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.problem {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.problem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.note {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.note_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.algorithm {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.algorithm_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.condition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.condition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.proposition {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.proposition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.proof {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.proof_label {
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.example {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.example_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.definition {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.definition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.remark {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.remark_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
h3.subsection {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
span.subsection_label {
font-weight: normal;
font-size: medium;

}
div.Shadowbox { border: solid gray medium; border-bottom: solid black 1ex; border-right: solid black 1ex; padding: 0.5ex; }
span.flex_url {
font-family: monospace;
}
div.Boxed {
	border: solid thick black;
	padding: 0.5ex;
}
div.marginal {
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
	background-color: #F0F0F0;
	float:right;
	font-size: small;
	font-weight: normal;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}
div.float {
	border: 2px solid black;
	text-align: center;
}
div.float-caption {
	text-align: center;
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
}


</style>
</head>
<body dir="auto">
<div class='standard' id='magicparlabel-1'><div class='Shadowbox'>

<div class='plain_layout' id='magicparlabel-10'>Machine Learning and Neural Networks (MATH3431)&#xA0;&#xA0;
Epiphany term, 2024<div style='height:3ex'></div></div>

<div class='plain_layout' style='text-align: center;' id='magicparlabel-11'> Handout <a href="#enu_Handout___Stochastic">enu:Handout-:-Stochastic</a>: Stochastic gradient descent <div style='height:3ex'></div></div>

<div class='plain_layout' id='magicparlabel-28'>Lecturer &amp; author: Georgios P. Karagiannis 
<a href="mailto:georgios.karagiannis@durham.ac.uk">georgios.karagiannis@durham.ac.uk</a></div>

<div class='plain_layout' id='magicparlabel-29'><hr />
<div style='height:3ex'></div></div>
<h3 class='subsection_' id='magicparlabel-30'>Aim</h3>
<div class='plain_layout' id='magicparlabel-31'>To introduce the stochastic gradient descent (motivation, description, practical tricks, analysis in the convex scenario, and implementation).</div>

<div class='plain_layout' id='magicparlabel-32'><hr />
<div style='height:3ex'></div></div>
<h3 class='subsection_' id='magicparlabel-33'>Reading list &amp; references:</h3>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-34'><a id="enu_Shalev_Shwartz__S____" />Shalev-Shwartz, S., &amp; Ben-David, S. (2014). Understanding machine learning: From theory to algorithms. Cambridge university press. 
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-39'>Ch. 14.3 Stochastic Gradient Descent (SGD), 14.5 Variants, 14.5 Learning with SGD </li>
</ul>
</li><li class="enumerate_item" id='magicparlabel-40'>Bottou, L. (2012). Stochastic gradient descent tricks. In Neural networks: Tricks of the trade (pp. 421-436). Springer, Berlin, Heidelberg. </li>
<li class="enumerate_item" id='magicparlabel-41'><a id="enu_Johnson__Rie__and" /> Johnson, Rie, and Tong Zhang. "Accelerating stochastic gradient descent using predictive variance reduction." Advances in neural information processing systems 26 (2013).</li>
<li class="enumerate_item" id='magicparlabel-42'><a id="enu_Duchi__John__Elad" /> Duchi, John, Elad Hazan, and Yoram Singer. "Adaptive subgradient methods for online learning and stochastic optimization." Journal of machine learning research 12, no. 7 (2011).</li>
</ol>
<div class='plain_layout' id='magicparlabel-43'><hr />
<div style='height:3ex'></div></div>

<div class='plain_layout' id='magicparlabel-44'><span style='font-size:x-small;'>Code of the Examples can be found in <span class='flex_url'>https://github.com/georgios-stats/Machine_Learning_and_Neural_Networks_III_Epiphany_2024/tree/main/Lecture_handouts/code/05.Stochastic_gradient_descent</span></span></div>
</div></div>
<section>
<h2 class='section' id='magicparlabel-49'><span class="section_label">1</span> Motivations for stochastic gradient descent</h2>
<div class='problem'>
<div class="problem_item" id='magicparlabel-50'><span class="problem_label">Problem 1.</span>
<a id="prob_Consider_a_learning" /> Consider a learning problem <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>H</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>Z</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x2113;</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
. Learning may involve the computation of the minimizer <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mi>w</mi>
  <mo stretchy='false'>*</mo>
 </msup>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>H</mi>
 </mstyle>
</mrow>
</math>
, where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
 is a class of hypotheses, of the risk function (RF) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>R</mi>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mtext>E</mtext>
  <mrow>
   <mi>z</mi>
   <mo>&#x223C;</mo>
   <mi>g</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x2113;</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>,</mo>
     <mi>z</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 given an unknown data generating model <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>g</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mo>&#x22C5;</mo>
  <mo stretchy='false'>)</mo>
 </mrow>
</mrow>
</math>
 and using a known tractable loss <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo>&#x22C5;</mo>
   <mo stretchy='false'>,</mo>
   <mo>&#x22C5;</mo>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
; that is <a id="eq_rfminproblem" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mo stretchy='false'>*</mo>
    </msup>
    <mo stretchy='false'>=</mo>
    <mo>arg</mo>
    <munder>
     <mo>min</mo>
     <mrow>
      <mi>&#x2200;</mi>
      <mi>w</mi>
      <mo>&#x2208;</mo>
      <mstyle mathvariant='script'>
       <mi>H</mi>
      </mstyle>
     </mrow>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mi>R</mi>
       <mi>g</mi>
      </msub>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mo>arg</mo>
    <munder>
     <mo>min</mo>
     <mrow>
      <mi>&#x2200;</mi>
      <mi>w</mi>
      <mo>&#x2208;</mo>
      <mstyle mathvariant='script'>
       <mi>H</mi>
      </mstyle>
     </mrow>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mtext>E</mtext>
       <mrow>
        <mi>z</mi>
        <mo>&#x223C;</mo>
        <mi>g</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>&#x2113;</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>w</mi>
          <mo stretchy='false'>,</mo>
          <mi>z</mi>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(1.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-51'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-52'><span class="note_label">Note 2.</span>
<a id="rem_Gradient_descent__GD_" /> Gradient descent (GD) cannot be directly utilized to address Problem <a href="#prob_Consider_a_learning">1</a> (i.e., minimize the Risk function) because <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>g</mi>
</math>
 is unknown, and because <a href="#eq_rfminproblem">(1.1)</a> involves an integral which may be computationally intractable. Instead it aims to minimize the ERF <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mover>
  <mi>R</mi>
  <mo stretchy='true'>&#x02C6;</mo>
 </mover>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mi>n</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>n</mi>
 </munderover>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 which ideally is used as a proxy when data size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>n</mi>
</math>
 is big (big-data). </div>
</div>
<div class='standard' id='magicparlabel-53'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-54'><span class="note_label">Note 3.</span>
<a id="rem_The_implementation_of" /> The implementation of GD may be computationally impractical even in problems where we need to minimize an ERF <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mi>R</mi>
   <mo stretchy='true'>&#x02C6;</mo>
  </mover>
  <mi>n</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 if we have big data (<math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>n</mi>
 <mo>&#x2248;</mo>
</mrow>
</math>
big). This is because GD requires the recursive computation of the exact gradient <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2207;</mi>
 <msub>
  <mover>
   <mi>R</mi>
   <mo stretchy='true'>&#x02C6;</mo>
  </mover>
  <mi>n</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mi>n</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>n</mi>
 </munderover>
 <mi>&#x2207;</mi>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 using all the data <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>z</mi>
  <mi>i</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 at each iteration. That may be too slow.</div>
</div>
<div class='standard' id='magicparlabel-67'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-68'><span class="note_label">Note 4.</span>
Stochastic gradient descent (SGD) aims at solving <a href="#eq_rfminproblem">(1.1)</a>, and overcoming the issues in Notes <a href="#rem_Gradient_descent__GD_">2</a> &amp; <a href="#rem_The_implementation_of">3</a> by using an unbiased estimator of the actual gradient (or some sub-gradient) based on a sample (a single example or a set of examples) properly drawn from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>g</mi>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-69'>
<br />
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-70'><span class="section_label">2</span> Stochastic gradient descent</h2>
<div class='problem'>
<div class="problem_item" id='magicparlabel-71'><span class="problem_label">Problem 5.</span>
<a id="nota_For_the_sake" /> For the sake of notation simplicity and generalization, we present Stochastic Gradient Descent (SGD) in the following minimization problem<a id="eq_gvbzvcb_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mo stretchy='false'>*</mo>
    </msup>
    <mo stretchy='false'>=</mo>
    <mo>arg</mo>
    <munder>
     <mo>min</mo>
     <mrow>
      <mi>w</mi>
      <mo>&#x2208;</mo>
      <mstyle mathvariant='script'>
       <mi>H</mi>
      </mstyle>
     </mrow>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <mi>w</mi>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where here <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 , and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>H</mi>
 </mstyle>
 <mo>&#x2286;</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mi>d</mi>
 </msup>
</mrow>
</math>
; <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is the unknown function to be minimized, e.g., <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 can be the risk function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>R</mi>
  <mi>g</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mtext>E</mtext>
  <mrow>
   <mi>z</mi>
   <mo>&#x223C;</mo>
   <mi>g</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>&#x2113;</mi>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>w</mi>
     <mo stretchy='false'>,</mo>
     <mi>z</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-72'>
<br />
</div>

<div class='standard' id='magicparlabel-73'><div class='Boxed'><div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-77'><span class="algorithm_label">Algorithm 6.</span>
<a id="alg_Stochastic_Gradient_descent" /> Stochastic Gradient Descent (SGD) with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 for the solution of the minimization problem <a href="#nota_For_the_sake">5</a> </div>
<div class="algorithm_item" id='magicparlabel-82'><hr />
</div>
<div class='plain_layout' id='magicparlabel-83'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate:</i></div>
<ol class='lyxenum enumi'>
<li style='text-align: left;' id='magicparlabel-84'><i><a id="enu_compute__where" />compute <a id="eq_GD_UPDATE_MECHANISM" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <msub>
     <mi>v</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
 is a random vector such that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mi>&#x2202;</mi>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</i></li>
<li class="enumerate_item" id='magicparlabel-85'><i><a id="enu_terminate_if_2" />terminate if a termination criterion is satisfied, e.g.
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mtext>If</mtext>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mi>t</mi>
 <mo>&#x2265;</mo>
 <msub>
  <mi>T</mi>
  <mtext>
  <mstyle class='math'>
   <mo>max</mo>
  </mstyle></mtext>
 </msub>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mtext>then</mtext>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mtext>STOP</mtext>
</mrow>
</math>
</i></li>
</ol>
</div>
</div>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-86'><span class="note_label">Note 7.</span>
If <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>f</mi>
</math>
 is differentiable at <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>t</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
, it is <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2202;</mi>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mi>&#x2207;</mi>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
. Hence <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
 is such as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mi>&#x2207;</mi>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 in Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a> step <a href="#enu_compute__where">1.</a>. </div>
</div>
<div class='standard' id='magicparlabel-87'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-88'><span class="note_label">Note 8.</span>
Assume <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>f</mi>
</math>
 is differentiable (for simplicity). To compare SGD with GD, we can re-write <a href="#eq_GD_UPDATE_MECHANISM">(2.2)</a> in the SGD Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a> as<a id="eq_GD_UPDATE_MECHANISM_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mi>&#x2207;</mi>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <msub>
       <mi>&#x3BE;</mi>
       <mi>t</mi>
      </msub>
     </mrow>
     <mo>]</mo>
    </mrow>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>&#x3BE;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>-</mo>
 <mi>&#x2207;</mi>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 represents the (observed) noise introduced in <a href="#eq_GD_UPDATE_MECHANISM">(2.2)</a> by using a random realization of the exact gradient.</div>
</div>
<div class='standard' id='magicparlabel-89'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-90'><span class="note_label">Note 9.</span>
Given <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>T</mi>
</math>
 SGD algorithm iterations, the output of SGD can be (but not a exclusively)</div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-91'>the average (after discarding the first few iterations of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>t</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 for stability reasons)<a id="eq_fghsgh" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msubsup>
     <mi>w</mi>
     <mtext>SGD</mtext>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>T</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msubsup>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mn>1</mn>
     <mi>T</mi>
    </mfrac>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>T</mi>
    </munderover>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(2.4)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="enumerate_item" id='magicparlabel-92'>or the best value discovered
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msubsup>
  <mi>w</mi>
  <mtext>SGD</mtext>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>T</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msubsup>
 <mo stretchy='false'>=</mo>
 <mo>arg</mo>
 <munder>
  <mo>min</mo>
  <mrow>
   <mo>{</mo>
   <msub>
    <mi>w</mi>
    <mi>t</mi>
   </msub>
   <mo>}</mo>
  </mrow>
 </munder>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 </li>
<li class="enumerate_item" id='magicparlabel-93'>or the last value discovered 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msubsup>
  <mi>w</mi>
  <mtext>SGD</mtext>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>T</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msubsup>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>T</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
</mrow>
</math>
</li>
</ol>
</div>
<div class='standard' id='magicparlabel-94'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-95'><span class="note_label">Note 10.</span>
SGD output converges to a local minimum, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msubsup>
  <mi>w</mi>
  <mtext>SGD</mtext>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>T</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msubsup>
 <mo>&#x2192;</mo>
 <msub>
  <mi>w</mi>
  <mo stretchy='false'>*</mo>
 </msub>
</mrow>
</math>
 (in some sense), under different sets of regularity conditions –Section <a href="#subsec_Analysis">3</a> has a brief analysis. To achieve this, Conditions <a href="#rem_For_the_SGD">11</a> on the learning rate are rather inevitable and should be satisfied. </div>
</div>
<div class='standard' id='magicparlabel-96'>
<br />
</div>
<div class='condition'>
<div class="condition_item" id='magicparlabel-97'><span class="condition_label">Condition 11.</span>
<a id="rem_For_the_SGD" /> Regarding the learning rate (or gain) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 should satisfy conditions </div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-98'><a id="enu__" /><math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>&#x2265;</mo>
 <mn>0</mn>
</mrow>
</math>
, </li>
<li class="enumerate_item" id='magicparlabel-99'><a id="enu_" /><math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>&#x221E;</mi>
 </munderover>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mi>&#x221E;</mi>
</mrow>
</math>
</li>
<li class="enumerate_item" id='magicparlabel-100'><a id="enu__1" /><math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>&#x221E;</mi>
 </munderover>
 <msubsup>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
  <mn>2</mn>
 </msubsup>
 <mo stretchy='false'>&lt;</mo>
 <mi>&#x221E;</mi>
</mrow>
</math>
</li>
</ol>
</div>
<div class='standard' id='magicparlabel-101'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-102'><span class="note_label">Note 12.</span>
The popular learning rates <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 in Note <a href="#note_Given__iterations">note:Given--iterations</a> in Handout <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a> &#8220;Gradient descent&#8221; satisfy Condition <a href="#rem_For_the_SGD">11</a> and hence can be used in SGD too. Once parameterized, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 can be tuned based on pilot runs using a reasonably small fraction of the training data set.</div>
</div>
<div class='standard' id='magicparlabel-103'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-104'><span class="note_label">Note 13.</span>
(Intuition on Condition <a href="#rem_For_the_SGD">11</a>). Assume that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
 is bounded. Condition <a href="#rem_For_the_SGD">11</a><a href="#enu__1">(3.)</a> aims at reducing the effect of the randomness in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
 (introduced noise <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3BE;</mi>
 <mi>t</mi>
</msub>
</math>
) because it implies <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>ssearrow</mo>
 <mn>0</mn>
</mrow>
</math>
 as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo>&#x2192;</mo>
 <mi>&#x221E;</mi>
</mrow>
</math>
; if this was not the case then 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>-</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <mo stretchy='false'>-</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo>&#x2192;</mo>
 <mn>0</mn>
</mrow>
</math>
may not be satisfied and the chain <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
 may not converge. Condition <a href="#rem_For_the_SGD">11</a>(<a href="#enu_">2.</a>) prevents <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 from reducing too fast and allows the generated chain <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
 to be able to converge. E.g.,  after <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
 iterations 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <mo>&#x2225;</mo>
    <mrow>
     <msup>
      <mi>w</mi>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msup>
     <mo stretchy='false'>-</mo>
     <msup>
      <mi>w</mi>
      <mo stretchy='false'>*</mo>
     </msup>
    </mrow>
    <mo>&#x2225;</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mrow>
     <mo>&#x2225;</mo>
     <mrow>
      <msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mi>t</mi>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
      <mo>&#x00B1;</mo>
      <msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mn>0</mn>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
      <mo stretchy='false'>-</mo>
      <msup>
       <mi>w</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </mrow>
     <mo>&#x2225;</mo>
    </mrow>
    <mo>&#x2265;</mo>
    <mrow>
     <mo>&#x2225;</mo>
     <mrow>
      <msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mn>0</mn>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
      <mo stretchy='false'>-</mo>
      <msup>
       <mi>w</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </mrow>
     <mo>&#x2225;</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mrow>
     <mo>&#x2225;</mo>
     <mrow>
      <msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mi>t</mi>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
      <mo stretchy='false'>-</mo>
      <msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mn>0</mn>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
     </mrow>
     <mo>&#x2225;</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo>&#x2265;</mo>
    <mrow>
     <mo>&#x2225;</mo>
     <mrow>
      <msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mn>0</mn>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
      <mo stretchy='false'>-</mo>
      <msup>
       <mi>w</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </mrow>
     <mo>&#x2225;</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>=</mo>
      <mn>0</mn>
     </mrow>
     <mi>&#x221E;</mi>
    </munderover>
    <mrow>
     <mo>&#x2225;</mo>
     <mrow>
      <msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>+</mo>
         <mn>1</mn>
        </mrow>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
      <mo stretchy='false'>-</mo>
      <msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mi>t</mi>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
     </mrow>
     <mo>&#x2225;</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mrow>
     <mo>&#x2225;</mo>
     <mrow>
      <msup>
       <mi>w</mi>
       <mrow>
        <mo stretchy='false'>(</mo>
        <mn>0</mn>
        <mo stretchy='false'>)</mo>
       </mrow>
      </msup>
      <mo stretchy='false'>-</mo>
      <msup>
       <mi>w</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </mrow>
     <mo>&#x2225;</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>=</mo>
      <mn>0</mn>
     </mrow>
     <mrow>
      <mi>T</mi>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </munderover>
    <mrow>
     <mo>&#x2225;</mo>
     <mrow>
      <msub>
       <mi>&#x3B7;</mi>
       <mi>t</mi>
      </msub>
      <msub>
       <mi>v</mi>
       <mi>t</mi>
      </msub>
     </mrow>
     <mo>&#x2225;</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 However if it was <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>&#x221E;</mi>
 </munderover>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&lt;</mo>
 <mi>&#x221E;</mi>
</mrow>
</math>
 it would be <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>0</mn>
  </mrow>
  <mi>&#x221E;</mi>
 </munderover>
 <mrow>
  <mo>&#x2225;</mo>
  <mrow>
   <msub>
    <mi>&#x3B7;</mi>
    <mi>t</mi>
   </msub>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
  </mrow>
  <mo>&#x2225;</mo>
 </mrow>
 <mo stretchy='false'>&lt;</mo>
 <mi>&#x221E;</mi>
</mrow>
</math>
 and hence <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>t</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 would never converge to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mo stretchy='false'>*</mo>
</msup>
</math>
 if the seed <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mn>0</mn>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 is far enough from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mo stretchy='false'>*</mo>
</msup>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-114'>
<br />
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-115'><span class="section_label">3</span> <a id="subsec_Analysis" /> Analysis of SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a>)</h2>
<div class='standard' id='magicparlabel-116'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-117'><span class="note_label">Note 14.</span>
Recall that the stochasticity of SGD comes from the stochastic sub-gradients <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo>}</mo>
</mrow>
</math>
 in <a href="#eq_GD_UPDATE_MECHANISM">(2.2)</a>; hence the expectations below are under these random vectors&#8217; distributions.</div>
</div>
<div class='proposition'>
<div class="proposition_item" id='magicparlabel-118'><span class="proposition_label">Proposition 15.</span>
<a id="thm_Let__be" /> Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 be a convex function.  If we run SGD algorithm of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>f</mi>
</math>
 with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>T</mi>
</math>
 steps, the output <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msubsup>
  <mi>w</mi>
  <mtext>GD</mtext>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>T</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msubsup>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mi>T</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>T</mi>
 </munderover>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
</mrow>
</math>
 satisfies <a id="eq_sgd_upper_bound" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mtext>E</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msubsup>
        <mi>w</mi>
        <mtext>SGD</mtext>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>T</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>w</mi>
      <mo stretchy='false'>*</mo>
     </msup>
     <mo>)</mo>
    </mrow>
    <mo>&#x2264;</mo>
    <mfrac>
     <msup>
      <mrow>
       <mo>&#x2225;</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo>&#x2225;</mo>
      </mrow>
      <mn>2</mn>
     </msup>
     <mrow>
      <mn>2</mn>
      <mi>&#x3B7;</mi>
      <mi>T</mi>
     </mrow>
    </mfrac>
    <mo stretchy='false'>+</mo>
    <mfrac>
     <mi>&#x3B7;</mi>
     <mn>2</mn>
    </mfrac>
    <mfrac>
     <mn>1</mn>
     <mi>T</mi>
    </mfrac>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>T</mi>
    </munderover>
    <mtext>E</mtext>
    <msup>
     <mrow>
      <mo>&#x2225;</mo>
      <msub>
       <mi>v</mi>
       <mi>t</mi>
      </msub>
      <mo>&#x2225;</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
<div class='proof'>
<div class="proof_item" id='magicparlabel-131'><span class="proof_label">Proof.</span>
Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>v</mi>
  <mrow>
   <mn>1</mn>
   <mo stretchy='false'>:</mo>
   <mi>t</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. By Jensens&#8217; inequality (or see <a href="#eq_SFGSDFSFSDF">eq:SFGSDFSFSDF</a> in Handout <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a>)<a id="eq_svbnhgjh" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mtext>E</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msubsup>
        <mi>w</mi>
        <mtext>SGD</mtext>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>T</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>&#x2264;</mo>
    <mtext>E</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mfrac>
       <mn>1</mn>
       <mi>T</mi>
      </mfrac>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>t</mi>
        <mo stretchy='false'>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>T</mi>
      </munderover>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <msup>
          <mi>w</mi>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mi>t</mi>
           <mo stretchy='false'>)</mo>
          </mrow>
         </msup>
         <mo>)</mo>
        </mrow>
        <mo stretchy='false'>-</mo>
        <mi>f</mi>
        <mrow>
         <mo>(</mo>
         <msup>
          <mi>w</mi>
          <mo stretchy='false'>*</mo>
         </msup>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mfrac>
     <mn>1</mn>
     <mi>T</mi>
    </mfrac>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>T</mi>
    </munderover>
    <mtext>E</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</div>
<div class="proof_item" id='magicparlabel-132'>I will try to use Lemma <a href="#lem_Let__be">lem:Let--be</a> from Handout <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a>, hence I need to show <a id="eq_dfggbgghgdrds" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mtext>E</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>&#x2264;</mo>
    <mtext>E</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>&#x27E8;</mo>
      <mrow>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo stretchy='false'>-</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>v</mi>
        <mi>t</mi>
       </msub>
      </mrow>
      <mo stretchy='false'>&#x27E9;</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
where the expectation is under <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mn>1</mn>
  <mo stretchy='false'>:</mo>
  <mi>T</mi>
 </mrow>
</msub>
</math>
. It is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left right '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <msub>
      <mi>v</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>:</mo>
       <mi>T</mi>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>&#x27E8;</mo>
      <mrow>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo stretchy='false'>-</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>v</mi>
        <mi>t</mi>
       </msub>
      </mrow>
      <mo stretchy='false'>&#x27E9;</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <msub>
      <mi>v</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>:</mo>
       <mi>t</mi>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>&#x27E8;</mo>
      <mrow>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo stretchy='false'>-</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>v</mi>
        <mi>t</mi>
       </msub>
      </mrow>
      <mo stretchy='false'>&#x27E9;</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow/>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo stretchy='false'>=</mo>
  </mtd>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <msub>
      <mi>v</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>:</mo>
       <mi>t</mi>
       <mo stretchy='false'>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mtext>E</mtext>
       <msub>
        <mi>v</mi>
        <mrow>
         <mn>1</mn>
         <mo stretchy='false'>:</mo>
         <mi>t</mi>
        </mrow>
       </msub>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mo stretchy='false'>&#x27E8;</mo>
         <mrow>
          <msup>
           <mi>w</mi>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mi>t</mi>
            <mo stretchy='false'>)</mo>
           </mrow>
          </msup>
          <mo stretchy='false'>-</mo>
          <msup>
           <mi>w</mi>
           <mo stretchy='false'>*</mo>
          </msup>
          <mo stretchy='false'>,</mo>
          <msub>
           <mi>v</mi>
           <mi>t</mi>
          </msub>
         </mrow>
         <mo stretchy='false'>&#x27E9;</mo>
        </mrow>
        <mo stretchy='false'>|</mo>
        <msub>
         <mi>v</mi>
         <mrow>
          <mn>1</mn>
          <mo stretchy='false'>:</mo>
          <mi>t</mi>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mspace width="6px"/>
    <mspace width="6px"/>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mtext>&#0160;law&#0160;of&#0160;total&#0160;expectation&#0160;</mtext>
     <mo stretchy='false'>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 But <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>t</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 is fully determined by <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mn>1</mn>
  <mo stretchy='false'>:</mo>
  <mi>t</mi>
  <mo stretchy='false'>-</mo>
  <mn>1</mn>
 </mrow>
</msub>
</math>
, (see <a href="#eq_GD_UPDATE_MECHANISM">(2.2)</a>) so
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <msub>
      <mi>v</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>:</mo>
       <mi>t</mi>
       <mo stretchy='false'>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <msub>
       <mtext>E</mtext>
       <msub>
        <mi>v</mi>
        <mrow>
         <mn>1</mn>
         <mo stretchy='false'>:</mo>
         <mi>t</mi>
        </mrow>
       </msub>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mrow>
         <mo stretchy='false'>&#x27E8;</mo>
         <mrow>
          <msup>
           <mi>w</mi>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mi>t</mi>
            <mo stretchy='false'>)</mo>
           </mrow>
          </msup>
          <mo stretchy='false'>-</mo>
          <msup>
           <mi>w</mi>
           <mo stretchy='false'>*</mo>
          </msup>
          <mo stretchy='false'>,</mo>
          <msub>
           <mi>v</mi>
           <mi>t</mi>
          </msub>
         </mrow>
         <mo stretchy='false'>&#x27E9;</mo>
        </mrow>
        <mo stretchy='false'>|</mo>
        <msub>
         <mi>v</mi>
         <mrow>
          <mn>1</mn>
          <mo stretchy='false'>:</mo>
          <mi>t</mi>
          <mo stretchy='false'>-</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <msub>
      <mi>v</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>:</mo>
       <mi>t</mi>
       <mo stretchy='false'>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>&#x27E8;</mo>
      <mrow>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo stretchy='false'>-</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo stretchy='false'>,</mo>
       <msub>
        <mtext>E</mtext>
        <msub>
         <mi>v</mi>
         <mrow>
          <mn>1</mn>
          <mo stretchy='false'>:</mo>
          <mi>t</mi>
         </mrow>
        </msub>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>v</mi>
          <mi>t</mi>
         </msub>
         <mo stretchy='false'>|</mo>
         <msub>
          <mi>v</mi>
          <mrow>
           <mn>1</mn>
           <mo stretchy='false'>:</mo>
           <mi>t</mi>
           <mo stretchy='false'>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo stretchy='false'>&#x27E9;</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
As <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>t</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 is fully determined by <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mn>1</mn>
  <mo stretchy='false'>:</mo>
  <mi>t</mi>
  <mo stretchy='false'>-</mo>
  <mn>1</mn>
 </mrow>
</msub>
</math>
 then <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mtext>E</mtext>
  <msub>
   <mi>v</mi>
   <mrow>
    <mn>1</mn>
    <mo stretchy='false'>:</mo>
    <mi>t</mi>
   </mrow>
  </msub>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <msub>
    <mi>v</mi>
    <mrow>
     <mn>1</mn>
     <mo stretchy='false'>:</mo>
     <mi>t</mi>
     <mo stretchy='false'>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mtext>E</mtext>
  <msub>
   <mi>v</mi>
   <mrow>
    <mn>1</mn>
    <mo stretchy='false'>:</mo>
    <mi>t</mi>
   </mrow>
  </msub>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mi>&#x2202;</mi>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
, hence <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mtext>E</mtext>
  <msub>
   <mi>v</mi>
   <mrow>
    <mn>1</mn>
    <mo stretchy='false'>:</mo>
    <mi>t</mi>
   </mrow>
  </msub>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <msub>
    <mi>v</mi>
    <mrow>
     <mn>1</mn>
     <mo stretchy='false'>:</mo>
     <mi>t</mi>
     <mo stretchy='false'>-</mo>
     <mn>1</mn>
    </mrow>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is a sub-gradient. By sub-gradient definition<a id="eq_xgsxfg" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <msub>
      <mi>v</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>:</mo>
       <mi>t</mi>
       <mo stretchy='false'>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo stretchy='false'>&#x27E8;</mo>
      <mrow>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo stretchy='false'>-</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo stretchy='false'>,</mo>
       <msub>
        <mtext>E</mtext>
        <msub>
         <mi>v</mi>
         <mrow>
          <mn>1</mn>
          <mo stretchy='false'>:</mo>
          <mi>t</mi>
         </mrow>
        </msub>
       </msub>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>v</mi>
          <mi>t</mi>
         </msub>
         <mo stretchy='false'>|</mo>
         <msub>
          <mi>v</mi>
          <mrow>
           <mn>1</mn>
           <mo stretchy='false'>:</mo>
           <mi>t</mi>
           <mo stretchy='false'>-</mo>
           <mn>1</mn>
          </mrow>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo stretchy='false'>&#x27E9;</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>&#x2265;</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <msub>
      <mi>v</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>:</mo>
       <mi>t</mi>
       <mo stretchy='false'>-</mo>
       <mn>1</mn>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mo stretchy='false'>=</mo>
  </mtd>
  <mtd>
   <mrow>
    <msub>
     <mtext>E</mtext>
     <msub>
      <mi>v</mi>
      <mrow>
       <mn>1</mn>
       <mo stretchy='false'>:</mo>
       <mi>T</mi>
      </mrow>
     </msub>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msup>
        <mi>w</mi>
        <mo stretchy='false'>*</mo>
       </msup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.4)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 Hence combining <a href="#eq_xgsxfg">(3.4)</a>, <a href="#eq_dfggbgghgdrds">(3.3)</a>, and <a href="#eq_svbnhgjh">(3.2)</a>
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>w</mi>
     <mtext>SGD</mtext>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>T</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msubsup>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>-</mo>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <msup>
     <mi>w</mi>
     <mo stretchy='false'>*</mo>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2264;</mo>
 <mfrac>
  <mn>1</mn>
  <mi>T</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>T</mi>
 </munderover>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mo stretchy='false'>&#x27E8;</mo>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <msup>
     <mi>w</mi>
     <mo stretchy='false'>*</mo>
    </msup>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>v</mi>
     <mi>t</mi>
    </msub>
   </mrow>
   <mo stretchy='false'>&#x27E9;</mo>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
Then Lemma <a href="#lem_Let__be">lem:Let--be</a> in Handout <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a> &#8220;Gradient descent&#8221; implies 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>w</mi>
     <mtext>SGD</mtext>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>T</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msubsup>
    <mo>)</mo>
   </mrow>
   <mo stretchy='false'>-</mo>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <msup>
     <mi>w</mi>
     <mo stretchy='false'>*</mo>
    </msup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2264;</mo>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mfrac>
    <mn>1</mn>
    <mi>T</mi>
   </mfrac>
   <mfrac>
    <msup>
     <mrow>
      <mo>&#x2225;</mo>
      <msup>
       <mi>w</mi>
       <mo stretchy='false'>*</mo>
      </msup>
      <mo>&#x2225;</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mrow>
     <mn>2</mn>
     <mi>&#x3B7;</mi>
    </mrow>
   </mfrac>
   <mo stretchy='false'>+</mo>
   <mfrac>
    <mi>&#x3B7;</mi>
    <mn>2</mn>
   </mfrac>
   <mfrac>
    <mn>1</mn>
    <mi>T</mi>
   </mfrac>
   <munderover>
    <mo>&#x2211;</mo>
    <mrow>
     <mi>t</mi>
     <mo stretchy='false'>=</mo>
     <mn>1</mn>
    </mrow>
    <mi>T</mi>
   </munderover>
   <msup>
    <mrow>
     <mo>&#x2225;</mo>
     <msub>
      <mi>v</mi>
      <mi>t</mi>
     </msub>
     <mo>&#x2225;</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mrow>
   <mtext>E</mtext>
   <msup>
    <mrow>
     <mo>&#x2225;</mo>
     <msup>
      <mi>w</mi>
      <mo stretchy='false'>*</mo>
     </msup>
     <mo>&#x2225;</mo>
    </mrow>
    <mn>2</mn>
   </msup>
  </mrow>
  <mrow>
   <mn>2</mn>
   <mi>&#x3B7;</mi>
   <mi>T</mi>
  </mrow>
 </mfrac>
 <mo stretchy='false'>+</mo>
 <mfrac>
  <mi>&#x3B7;</mi>
  <mn>2</mn>
 </mfrac>
 <mfrac>
  <mn>1</mn>
  <mi>T</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>T</mi>
 </munderover>
 <mtext>E</mtext>
 <msup>
  <mrow>
   <mo>&#x2225;</mo>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>2</mn>
 </msup>
</mrow>
</math>
</div>
</div>
</div>
<div class='standard' id='magicparlabel-133'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-134'><span class="note_label">Note 16.</span>
<a id="rem_Note_that_the" />The upper bound in <a href="#eq_sgd_upper_bound">(3.1)</a> depends on the variation of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
 as <a id="eq_" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mtext>E</mtext>
    <msup>
     <mrow>
      <mo>&#x2225;</mo>
      <msub>
       <mi>v</mi>
       <mi>t</mi>
      </msub>
      <mo>&#x2225;</mo>
     </mrow>
     <mn>2</mn>
    </msup>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>j</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>d</mi>
    </munderover>
    <mtext>Var</mtext>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>v</mi>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>,</mo>
       <mi>j</mi>
      </mrow>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>j</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>d</mi>
    </munderover>
    <msup>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mtext>E</mtext>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>v</mi>
         <mrow>
          <mi>t</mi>
          <mo stretchy='false'>,</mo>
          <mi>j</mi>
         </mrow>
        </msub>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.5)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
  where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>d</mi>
</math>
 is the dimension of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>v</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>v</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>,</mo>
      <mi>d</mi>
     </mrow>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
. The second term on the right hand side of <a href="#eq_">(3.5)</a> is constant as <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mrow>
  <mi>t</mi>
  <mo stretchy='false'>,</mo>
  <mi>j</mi>
 </mrow>
</msub>
</math>
 is the unbiased estimator of the sub-gradient by construction.</div>
</div>
<div class='standard' id='magicparlabel-139'>
<br />
</div>
<div class='proposition'>
<div class="proposition_item" id='magicparlabel-140'><span class="proposition_label">Proposition 17.</span>
<a id="prop__Cont__Proposition__" /> (Cont. Proposition <a href="#thm_Let__be">15</a>) Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 be a convex function, and let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>H</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mi>w</mi>
   <mo>&#x2208;</mo>
   <mstyle mathvariant='double-struck'>
    <mi>R</mi>
   </mstyle>
   <mo stretchy='false'>:</mo>
   <mrow>
    <mo>&#x2225;</mo>
    <mi>w</mi>
    <mo>&#x2225;</mo>
   </mrow>
   <mo>&#x2264;</mo>
   <mi>B</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
. Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>E</mtext>
 <msup>
  <mrow>
   <mo>&#x2225;</mo>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>2</mn>
 </msup>
 <mo>&#x2264;</mo>
 <msup>
  <mi>&#x3C1;</mi>
  <mn>2</mn>
 </msup>
</mrow>
</math>
. Assume we run SGD algorithm of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msqrt>
  <mfrac>
   <msup>
    <mi>B</mi>
    <mn>2</mn>
   </msup>
   <mrow>
    <msup>
     <mi>&#x3C1;</mi>
     <mn>2</mn>
    </msup>
    <mi>T</mi>
   </mrow>
  </mfrac>
 </msqrt>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>T</mi>
</math>
 steps, and output <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msubsup>
  <mi>w</mi>
  <mtext>SGD</mtext>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>T</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msubsup>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mi>T</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>T</mi>
 </munderover>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
</mrow>
</math>
 <i>. Then</i></div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-141'><i><a id="enu_the_output_WEDSD" />upper bound on the sub-optimality is </i><a id="eq_asfgasfgasdfDFSDF" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mtext>E</mtext>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>f</mi>
      <mrow>
       <mo>(</mo>
       <msubsup>
        <mi>w</mi>
        <mtext>SGD</mtext>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>T</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <msup>
      <mi>w</mi>
      <mo stretchy='false'>*</mo>
     </msup>
     <mo>)</mo>
    </mrow>
    <mo>&#x2264;</mo>
    <mfrac>
     <mrow>
      <mi>B</mi>
      <mi>&#x3C1;</mi>
     </mrow>
     <msqrt>
      <mi>T</mi>
     </msqrt>
    </mfrac>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(3.6)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="enumerate_item" id='magicparlabel-142'><i><a id="enu_a_given_levelDFGDSF" /> a given level of accuracy <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3B5;</mi>
</math>
 such that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>f</mi>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>w</mi>
     <mtext>SGD</mtext>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>T</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msubsup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>-</mo>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>w</mi>
   <mo stretchy='false'>*</mo>
  </msup>
  <mo>)</mo>
 </mrow>
 <mo>&#x2264;</mo>
 <mi>&#x3B5;</mi>
</mrow>
</math>
 can be achieved after <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>T</mi>
</math>
iterations 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>T</mi>
 <mo>&#x2265;</mo>
 <mfrac>
  <mrow>
   <msup>
    <mi>B</mi>
    <mn>2</mn>
   </msup>
   <msup>
    <mi>&#x3C1;</mi>
    <mn>2</mn>
   </msup>
  </mrow>
  <msup>
   <mi>&#x3B5;</mi>
   <mn>2</mn>
  </msup>
 </mfrac>
 <mn>.</mn>
</mrow>
</math>
</i></li>
</ol>
<div class='proof'>
<div class="proof_item" id='magicparlabel-143'><span class="proof_label">Proof.</span>
It follows from Proposition <a href="#thm_Let__be">15</a>. Condition <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>E</mtext>
 <msup>
  <mrow>
   <mo>&#x2225;</mo>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>2</mn>
 </msup>
 <mo>&#x2264;</mo>
 <msup>
  <mi>&#x3C1;</mi>
  <mn>2</mn>
 </msup>
</mrow>
</math>
 can be achieved, for instance by assuming Lipschitz (See Lemma <a href="#prop__is__Lipschitz">prop:-is--Lipschitz</a> from &#8220;Handout <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a>: Gradient descent&#8221;).</div>
</div>
</div>
<div class='standard' id='magicparlabel-149'>
<br />
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-150'><span class="section_label">4</span> Stochastic gradient descent with projection</h2>
<div class='note'>
<div class="note_item" id='magicparlabel-151'><span class="note_label">Note 18.</span>
Consider the scenario in Problem <a href="#prob_Consider_a_learning">1</a> where the learning problem requires to discover <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>w</mi>
 <mo stretchy='false'>*</mo>
</msup>
</math>
 in the restricted/bounded set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
. Assume the function to be minimized is convex in the restricted hypothesis set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
, e.g. <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>H</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>:</mo>
   <mrow>
    <mo>&#x2225;</mo>
    <mi>w</mi>
    <mo>&#x2225;</mo>
   </mrow>
   <mo>&#x2264;</mo>
   <mi>B</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
, but non-convex in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
 <mi>d</mi>
</msup>
</math>
. Direct implementation of vanilla SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a>) may produce a chain stepping out <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
 and hence an output <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>w</mi>
  <mtext>SGD</mtext>
 </msub>
 <mrow>
  <mo>/</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>H</mi>
 </mstyle>
</mrow>
</math>
. SGD can be modified to address this issue, as in Algorithm <a href="#alg_Stochastic_Gradient_descent_1">19</a>, by including a projection step guaranteeing <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='script'>
  <mi>H</mi>
 </mstyle>
</mrow>
</math>
.</div>
</div>
<div class='standard' id='magicparlabel-152'>
<br />
</div>

<div class='standard' id='magicparlabel-153'><div class='Boxed'><div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-157'><span class="algorithm_label">Algorithm 19.</span>
<a id="alg_Stochastic_Gradient_descent_1" /> Stochastic Gradient Descent with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 and with projection in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
 for Problem <a href="#nota_For_the_sake">5</a></div>
<div class="algorithm_item" id='magicparlabel-162'><hr />
</div>
<div class='plain_layout' id='magicparlabel-163'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate:</i></div>
<ol class='lyxenum enumi'>
<li style='text-align: left;' id='magicparlabel-164'><i><a id="enu_compute__where_1" />compute <a id="eq_GD_UPDATE_MECHANISM_3" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mfrac>
        <mn>1</mn>
        <mn>2</mn>
       </mfrac>
      </mrow>
      <mo>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <msub>
     <mi>v</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(4.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
 is a random vector such that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mi>&#x2202;</mi>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
</i></li>
<li class="enumerate_item" id='magicparlabel-165'><i>compute <a id="eq_GD_UPDATE_MECHANISM_3_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <mo>arg</mo>
    <munder>
     <mo>min</mo>
     <mrow>
      <mi>w</mi>
      <mo>&#x2208;</mo>
      <mstyle mathvariant='script'>
       <mi>H</mi>
      </mstyle>
     </mrow>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo>&#x2225;</mo>
      <mrow>
       <mi>w</mi>
       <mo stretchy='false'>-</mo>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mi>t</mi>
          <mo stretchy='false'>+</mo>
          <mfrac>
           <mn>1</mn>
           <mn>2</mn>
          </mfrac>
         </mrow>
         <mo>)</mo>
        </mrow>
       </msup>
      </mrow>
      <mo>&#x2225;</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(4.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</i></li>
<li class="enumerate_item" id='magicparlabel-166'><i><a id="enu_terminate_if_2_1" />terminate if a termination criterion is satisfied</i></li>
</ol>
</div>
</div></div>

<div class='standard' id='magicparlabel-171'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-172'><span class="note_label">Note 20.</span>
The analysis in Section <a href="#subsec_Analysis">3</a> holds for the SGD with projection after a slight modification in the math proofs; see Exercise <a href="#exer____2_1_1_1_1_2_1">exer:()-2-1-1-1-1-2-1</a> from the Exercise sheet. </div>
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-177'><span class="section_label">5</span> Implementation of SGD in the learning Problem <a href="#prob_Consider_a_learning">1</a></h2>
<div class='standard' id='magicparlabel-178'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-179'><span class="note_label">Note 21.</span>
Proposition <a href="#prop_For_a_randomly">22</a> allows a convenient implementation of SGD to the learning problem (Problem <a href="#prob_Consider_a_learning">1</a>). </div>
</div>
<div class='standard' id='magicparlabel-180'>
<br />
</div>
<div class='proposition'>
<div class="proposition_item" id='magicparlabel-181'><span class="proposition_label">Proposition 22.</span>
<a id="prop_For_a_randomly" /> For a randomly drawn example <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>z</mi>
 <mo>&#x223C;</mo>
 <mi>g</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mo>&#x22C5;</mo>
  <mo stretchy='false'>)</mo>
 </mrow>
</mrow>
</math>
, the sub-gradient <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>v</mi>
</math>
 of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 at point <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 is an unbiased estimator of the sub-gradient of the risk <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>R</mi>
  <mi>g</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 at point <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
. </div>
<div class='proof'>
<div class="proof_item" id='magicparlabel-182'><span class="proof_label">Proof.</span>
Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>v</mi>
</math>
 be a sub-gradient of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 at point <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
, then<a id="eq_sfgfgrqwetg" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>u</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>z</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>&#x2265;</mo>
    <mrow>
     <mo stretchy='false'>&#x27E8;</mo>
     <mrow>
      <mi>u</mi>
      <mo stretchy='false'>-</mo>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <mi>v</mi>
     </mrow>
     <mo stretchy='false'>&#x27E9;</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
It is  
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>R</mi>
     <mi>g</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>u</mi>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>R</mi>
     <mi>g</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mi>w</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msub>
     <mtext>E</mtext>
     <mrow>
      <mi>z</mi>
      <mo>&#x223C;</mo>
      <mi>g</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>&#x2113;</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>u</mi>
        <mo stretchy='false'>,</mo>
        <mi>z</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x2113;</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>w</mi>
        <mo stretchy='false'>,</mo>
        <mi>z</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>|</mo>
      <mi>w</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo>&#x2265;</mo>
    <msub>
     <mtext>E</mtext>
     <mrow>
      <mi>z</mi>
      <mo>&#x223C;</mo>
      <mi>g</mi>
     </mrow>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mrow>
       <mo stretchy='false'>&#x27E8;</mo>
       <mrow>
        <mi>u</mi>
        <mo stretchy='false'>-</mo>
        <mi>w</mi>
        <mo stretchy='false'>,</mo>
        <mi>v</mi>
       </mrow>
       <mo stretchy='false'>&#x27E9;</mo>
      </mrow>
      <mo stretchy='false'>|</mo>
      <mi>w</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow/>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mrow>
     <mo stretchy='false'>&#x27E8;</mo>
     <mrow>
      <mi>u</mi>
      <mo stretchy='false'>-</mo>
      <mi>w</mi>
      <mo stretchy='false'>,</mo>
      <msub>
       <mtext>E</mtext>
       <mrow>
        <mi>z</mi>
        <mo>&#x223C;</mo>
        <mi>g</mi>
       </mrow>
      </msub>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mi>v</mi>
        <mo stretchy='false'>|</mo>
        <mi>w</mi>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo stretchy='false'>&#x27E9;</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
 Hence, by definition, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>v</mi>
</math>
 is such that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mtext>E</mtext>
  <mrow>
   <mi>z</mi>
   <mo>&#x223C;</mo>
   <mi>g</mi>
  </mrow>
 </msub>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>v</mi>
   <mo stretchy='false'>|</mo>
   <mi>w</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is a sub-gradient of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>R</mi>
  <mi>g</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</div>
</div>
</div>
<div class='standard' id='magicparlabel-187'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-188'><span class="example_label">Example 23.</span>
<a id="exa_Consider_that_loss" />Consider that loss <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x2113;</mi>
</math>
 is differentiable wrt <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
. If <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>v</mi>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>&#x2207;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
, then </div>
</div>
<div class='standard' id='magicparlabel-195'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-196'><span class="note_label">Note 24.</span>
Assume there is available a finite dataset <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mstyle mathvariant='script'>
   <mi>S</mi>
  </mstyle>
  <mi>n</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <mi>n</mi>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 of size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>n</mi>
</math>
 which consists of independent realizations <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>z</mi>
 <mi>i</mi>
</msub>
</math>
 from the data generating distribution <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>g</mi>
</math>
; <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>z</mi>
  <mi>i</mi>
 </msub>
 <mover accent='false'>
  <mo>&#x223C;</mo>
  <mtext>ind</mtext>
 </mover>
 <mi>g</mi>
</mrow>
</math>
. Batch SGD (Algorithm <a href="#alg_batch_Stochastic_Gradient">25</a>) is an implementation of the SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a>) in the learning Problem <a href="#prob_Consider_a_learning">1</a>. </div>
</div>
<div class='standard' id='magicparlabel-197'>
<br />
</div>

<div class='standard' id='magicparlabel-198'><div class='Boxed'><div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-202'><span class="algorithm_label">Algorithm 25.</span>
<a id="alg_batch_Stochastic_Gradient" /> Batch Stochastic Gradient Descent with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
, and batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
, for Problem <a href="#prob_Consider_a_learning">1</a>.</div>
<div class="algorithm_item" id='magicparlabel-207'><hr />
</div>
<div class='plain_layout' style='text-align: left;' id='magicparlabel-208'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate:</i></div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-209'><i><a id="enu_sample___and" /> get a random sub-sample <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msubsup>
   <mover>
    <mi>z</mi>
    <mo stretchy='true'>&#x02DC;</mo>
   </mover>
   <mi>j</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msubsup>
  <mo stretchy='false'>;</mo>
  <mi>j</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mn>...</mn>
  <mo stretchy='false'>,</mo>
  <mi>m</mi>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 of size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 with or without replacement from the complete data-set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mstyle mathvariant='script'>
  <mi>S</mi>
 </mstyle>
 <mi>n</mi>
</msub>
</math>
.</i></li>
<li style='text-align: left;' id='magicparlabel-214'><i>compute <a id="eq_GD_UPDATE_MECHANISM_2" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
      <mo>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <msub>
     <mi>v</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(5.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mi>m</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>m</mi>
 </munderover>
 <msub>
  <mover>
   <mi>v</mi>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
</mrow>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mi>v</mi>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>&#x2208;</mo>
 <msub>
  <mi>&#x2202;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msubsup>
    <mover>
     <mi>z</mi>
     <mo stretchy='true'>&#x02DC;</mo>
    </mover>
    <mi>j</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msubsup>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</i></li>
<li style='text-align: left;' id='magicparlabel-219'><i>terminate if a termination criterion is satisfied</i></li>
</ol>
</div>
</div></div>

<div class='standard' id='magicparlabel-224'>
<br />
</div>

<div class='standard' id='magicparlabel-225'> </div>

<div class='standard' id='magicparlabel-236'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-237'><span class="note_label">Note 26.</span>
Step <a href="#enu_sample___and">1.</a> can be described equivalently as </div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-238'>Randomly generate a set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mstyle mathvariant='script'>
   <mi>J</mi>
  </mstyle>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>&#x2286;</mo>
 <msup>
  <mrow>
   <mo>{</mo>
   <mrow>
    <mn>1</mn>
    <mo stretchy='false'>,</mo>
    <mn>...</mn>
    <mo stretchy='false'>,</mo>
    <mi>n</mi>
   </mrow>
   <mo>}</mo>
  </mrow>
  <mi>m</mi>
 </msup>
</mrow>
</math>
 of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 indices from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mn>1</mn>
</math>
 to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>n</mi>
</math>
 with or without replacement, and set a <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mstyle mathvariant='script'>
    <mi>S</mi>
   </mstyle>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mi>m</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo>&#x2208;</mo>
   <msup>
    <mstyle mathvariant='script'>
     <mi>J</mi>
    </mstyle>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
. </li>
</ol>
<div class='standard' id='magicparlabel-239'>Hence <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mi>m</mi>
 </mfrac>
 <munder>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo>&#x2208;</mo>
   <msup>
    <mstyle mathvariant='script'>
     <mi>J</mi>
    </mstyle>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
 </munder>
 <msub>
  <mi>v</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
</mrow>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mi>v</mi>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo>&#x2208;</mo>
 <msub>
  <mi>&#x2202;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <mi>j</mi>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
.</div>
</div>


<div class='standard' id='magicparlabel-246'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-247'><span class="note_label">Note 27.</span>
If it is possible to sample anytime fresh examples <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>z</mi>
 <mi>i</mi>
</msub>
</math>
 directly from the data generation model <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>g</mi>
</math>
 instead of just having access to only a given finite dataset of examples <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mstyle mathvariant='script'>
  <mi>S</mi>
 </mstyle>
 <mi>n</mi>
</msub>
</math>
, then step <a href="#enu_sample___and">1.</a> in Algorithm <a href="#alg_batch_Stochastic_Gradient">25</a> can become </div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-248'>sample <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msubsup>
  <mover>
   <mi>z</mi>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mi>j</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msubsup>
 <mo>&#x223C;</mo>
 <mi>g</mi>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mo>&#x22C5;</mo>
  <mo stretchy='false'>)</mo>
 </mrow>
</mrow>
</math>
 for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>j</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
 <mo stretchy='false'>,</mo>
 <mi>m</mi>
</mrow>
</math>
.</li>
</ol>
</div>
<div class='standard' id='magicparlabel-249'>
<br />
</div>
<div class='definition'>
<div class="definition_item" id='magicparlabel-250'><span class="definition_label">Definition 28.</span>
<a id="def_Online_Stochastic_gradient" /> Online Stochastic gradient descent is the special case of Algorithm <a href="#alg_batch_Stochastic_Gradient">25</a> using sub-samples of size one ( <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>m</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
 ), namely, only one example is randomly chosen in Step <a href="#enu_sample___and">1.</a> of Algorithm <a href="#alg_batch_Stochastic_Gradient">25</a>. </div>
</div>
<div class='standard' id='magicparlabel-251'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-252'><span class="note_label">Note 29.</span>
In theory, using larger batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 has the benefit that reduces the variance  of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
 at iteration <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
 due to averaging effect, stabilizes the SGD algorithm, and reduces the error bound <a href="#eq_sgd_upper_bound">(3.1)</a>; see Remark <a href="#rem_Note_that_the">16</a>. </div>
</div>
<div class='standard' id='magicparlabel-261'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-262'><span class="note_label">Note 30.</span>
<a id="rem_In_practice__using" />In practice, for a given fixed computational time, using smaller batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 has the benefit that the algorithm iterates faster as each iteration processes less number of examples. E.g., consider the extreme cases GD vs online SGD  utilized in a scenario of big-data (large training data set): if the dataset consists of several replications of the same values, GD (using all the data) has to process the same information multiple times, while the online SGD (using only one example at a time) would avoid this issue.</div>
</div>
<div class='standard' id='magicparlabel-271'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-272'><span class="note_label">Note 31.</span>
<a id="rem_In_practice__for" />In practice, for a given fixed computational time, it is possible for a batch SGD with smaller batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 to present better generalization properties (wrt the theoretical assumptions) than those with larger <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>m</mi>
</math>
 (GD is included). It is observed for the former to be often less prone to getting stuck in shallow local minima because of the additional amount of “noise” E.g., consider the extreme cases GD vs online SGD in a scenario with non-convex risk function (e.g. our theoretical assumptions as violated): if the Risk function presents local minima, considering less examples randomly chosen each time may cause fluctuations in the gradient that allow the chain to accidentally jump/escape to an area with a lower minimum.</div>
</div>
<div class='standard' id='magicparlabel-273'>
<br />
</div>
<div class='proposition'>
<div class="proposition_item" id='magicparlabel-274'><span class="proposition_label">Proposition 32.</span>
(Implementing Proposition <a href="#prop__Cont__Proposition__">17</a>) Consider a convex-Lipschitz-bounded problem <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <mstyle mathvariant='script'>
   <mi>H</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mstyle mathvariant='script'>
   <mi>Z</mi>
  </mstyle>
  <mo stretchy='false'>,</mo>
  <mi>&#x2113;</mi>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 with parameters <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C1;</mi>
</math>
 and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>B</mi>
</math>
. Then for every <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3F5;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
, if we run SGD Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a> to minimize Problem <a href="#prob_Consider_a_learning">1</a> for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>T</mi>
 <mo>&#x2265;</mo>
 <mfrac>
  <msup>
   <mi>B</mi>
   <mn>2</mn>
  </msup>
  <msup>
   <mi>&#x3F5;</mi>
   <mn>2</mn>
  </msup>
 </mfrac>
 <msup>
  <mi>&#x3C1;</mi>
  <mn>2</mn>
 </msup>
</mrow>
</math>
 iterations then it produces output <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msubsup>
 <mi>w</mi>
 <mtext>SGD</mtext>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>T</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</msubsup>
</math>
 satisfying 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>R</mi>
    <mi>g</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <msubsup>
     <mi>w</mi>
     <mtext>SGD</mtext>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>T</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msubsup>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2264;</mo>
 <munder>
  <mo>min</mo>
  <mrow>
   <mi>&#x2200;</mi>
   <mi>w</mi>
   <mo>&#x2208;</mo>
   <mstyle mathvariant='script'>
    <mi>H</mi>
   </mstyle>
  </mrow>
 </munder>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>R</mi>
    <mi>g</mi>
   </msub>
   <mrow>
    <mo>(</mo>
    <mi>w</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>+</mo>
 <mi>&#x3F5;</mi>
</mrow>
</math>
 and hence we can achieve PAC guarantees.</div>
<div class='proof'>
<div class="proof_item" id='magicparlabel-275'><span class="proof_label">Proof.</span>
It is just re-writing the formula in part <a href="#enu_a_given_levelDFGDSF">2.</a> of Proposition <a href="#prop__Cont__Proposition__">17</a>. Notice that here, condition <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>E</mtext>
 <msup>
  <mrow>
   <mo>&#x2225;</mo>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo>&#x2225;</mo>
  </mrow>
  <mn>2</mn>
 </msup>
 <mo>&#x2264;</mo>
 <msup>
  <mi>&#x3C1;</mi>
  <mn>2</mn>
 </msup>
</mrow>
</math>
 is satisfied by the self-bounding property from Lipschitzness of the loss (see Lemma <a href="#prop__is__Lipschitz">prop:-is--Lipschitz</a> from &#8220;Handout <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a>: Gradient descent&#8221;); i.e. if <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x2113;</mi>
</math>
 is <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3C1;</mi>
</math>
-Lipschitz, then <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mrow>
  <mo>&#x2225;</mo>
  <msub>
   <mi>v</mi>
   <mi>t</mi>
  </msub>
  <mo>&#x2225;</mo>
 </mrow>
 <mo>&#x2264;</mo>
 <mi>&#x3C1;</mi>
</mrow>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo>&#x2208;</mo>
 <msub>
  <mi>&#x2202;</mi>
  <mi>w</mi>
 </msub>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msubsup>
    <mover>
     <mi>z</mi>
     <mo stretchy='true'>&#x02DC;</mo>
    </mover>
    <mi>j</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msubsup>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. </div>
</div>
</div>
<div class='standard' id='magicparlabel-276'>
<br />
</div>

<div class='standard' id='magicparlabel-277'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-278'><span class="example_label">Example 33.</span>
<a id="exa_The_batch_SGD" /> We continue Example <a href="#exa_Consider_the_simple">exa:Consider-the-simple</a> in Section <a href="#sec_Examples">sec:Examples</a> of Handout <a href="#enu_Handout___Gradient">enu:Handout-:-Gradient</a>. Recall, we considered a hypothesis space <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
 of linear functions <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mo stretchy='false'>:</mo>
 <msup>
  <mstyle mathvariant='double-struck'>
   <mi>R</mi>
  </mstyle>
  <mn>2</mn>
 </msup>
 <mo>&#x2192;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>h</mi>
 <mrow>
  <mo>(</mo>
  <mi>w</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msub>
  <mi>w</mi>
  <mn>1</mn>
 </msub>
 <mo stretchy='false'>+</mo>
 <msub>
  <mi>w</mi>
  <mn>2</mn>
 </msub>
 <mi>x</mi>
</mrow>
</math>
, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>w</mi>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>w</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy='false'>,</mo>
    <msub>
     <mi>w</mi>
     <mn>2</mn>
    </msub>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
   <mo stretchy='false'>=</mo>
   <msup>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mi>x</mi>
      <mo stretchy='false'>,</mo>
      <mi>y</mi>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mi>&#x22A4;</mi>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <msub>
     <mi>y</mi>
     <mi>i</mi>
    </msub>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>w</mi>
     <mn>1</mn>
    </msub>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>w</mi>
     <mn>2</mn>
    </msub>
    <mi>x</mi>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mn>2</mn>
 </msup>
</mrow>
</math>
. Here we consider a big dataset <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mstyle mathvariant='script'>
   <mi>S</mi>
  </mstyle>
  <mi>n</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mn>1</mn>
   </msub>
   <mo stretchy='false'>,</mo>
   <mn>...</mn>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <mi>n</mi>
   </msub>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>n</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <msup>
  <mn>0</mn>
  <mn>6</mn>
 </msup>
</mrow>
</math>
 examples. </div>
<div class='standard' id='magicparlabel-279'>The batch SGD algorithm (Algorithm <a href="#alg_batch_Stochastic_Gradient">25</a>) with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 and batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>m</mi>
 <mo stretchy='false'>=</mo>
 <mn>10</mn>
</mrow>
</math>
 is </div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-280'>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate:
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-281'>Randomly generate a set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mstyle mathvariant='script'>
  <mi>J</mi>
 </mstyle>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>t</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 by drawing <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>m</mi>
 <mo stretchy='false'>=</mo>
 <mn>10</mn>
</mrow>
</math>
 numbers from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mn>...</mn>
  <mo stretchy='false'>,</mo>
  <mi>n</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
  <msup>
   <mn>0</mn>
   <mn>6</mn>
  </msup>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
, and set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mstyle mathvariant='script'>
    <mi>S</mi>
   </mstyle>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mi>m</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
   <mo stretchy='false'>;</mo>
   <mi>i</mi>
   <mo>&#x2208;</mo>
   <msup>
    <mstyle mathvariant='script'>
     <mi>J</mi>
    </mstyle>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
</li>
<li style='text-align: left;' id='magicparlabel-282'><a id="enu_sample___and_3" />compute 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>-</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>,</mo>
</mrow>
</math>
 where 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>1</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mo stretchy='false'>+</mo>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>2</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <munder>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>j</mi>
       <mo>&#x2208;</mo>
       <msup>
        <mstyle mathvariant='script'>
         <mi>J</mi>
        </mstyle>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
      </mrow>
     </munder>
     <msub>
      <mi>x</mi>
      <mi>j</mi>
     </msub>
     <mo stretchy='false'>-</mo>
     <mn>2</mn>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <munder>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>j</mi>
       <mo>&#x2208;</mo>
       <msup>
        <mstyle mathvariant='script'>
         <mi>J</mi>
        </mstyle>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
      </mrow>
     </munder>
     <msub>
      <mi>y</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>1</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mover>
      <mi>x</mi>
      <mo stretchy='true'>&#x00AF;</mo>
     </mover>
     <mo stretchy='false'>+</mo>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>2</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <munder>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>j</mi>
       <mo>&#x2208;</mo>
       <msup>
        <mstyle mathvariant='script'>
         <mi>J</mi>
        </mstyle>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
      </mrow>
     </munder>
     <msubsup>
      <mi>x</mi>
      <mi>j</mi>
      <mn>2</mn>
     </msubsup>
     <mo stretchy='false'>-</mo>
     <mn>2</mn>
     <munder>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>j</mi>
       <mo>&#x2208;</mo>
       <msup>
        <mstyle mathvariant='script'>
         <mi>J</mi>
        </mstyle>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
      </mrow>
     </munder>
     <msub>
      <mi>y</mi>
      <mi>j</mi>
     </msub>
     <msub>
      <mi>x</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
 <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
</mrow>
</math>
, </li>
<li class="enumerate_item" id='magicparlabel-283'>if <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo>&#x2265;</mo>
 <mi>T</mi>
 <mo stretchy='false'>=</mo>
 <mn>1000</mn>
</mrow>
</math>
 STOP</li>
</ol>
</li></ul>
<div class='standard' id='magicparlabel-284'>because 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mfrac>
  <mn>1</mn>
  <mi>m</mi>
 </mfrac>
 <munder>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>j</mi>
   <mo>&#x2208;</mo>
   <msup>
    <mstyle mathvariant='script'>
     <mi>J</mi>
    </mstyle>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
 </munder>
 <mi>&#x2207;</mi>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msup>
    <mover>
     <mi>z</mi>
     <mo stretchy='true'>&#x02DC;</mo>
    </mover>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>...</mn>
 <mo stretchy='false'>=</mo>
 <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>1</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mo stretchy='false'>+</mo>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>2</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <munder>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>j</mi>
       <mo>&#x2208;</mo>
       <msup>
        <mstyle mathvariant='script'>
         <mi>J</mi>
        </mstyle>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
      </mrow>
     </munder>
     <msub>
      <mi>x</mi>
      <mi>j</mi>
     </msub>
     <mo stretchy='false'>-</mo>
     <mn>2</mn>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <munder>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>j</mi>
       <mo>&#x2208;</mo>
       <msup>
        <mstyle mathvariant='script'>
         <mi>J</mi>
        </mstyle>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
      </mrow>
     </munder>
     <msub>
      <mi>y</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>1</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mover>
      <mi>x</mi>
      <mo stretchy='true'>&#x00AF;</mo>
     </mover>
     <mo stretchy='false'>+</mo>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>2</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mfrac>
      <mn>1</mn>
      <mi>m</mi>
     </mfrac>
     <munder>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>j</mi>
       <mo>&#x2208;</mo>
       <msup>
        <mstyle mathvariant='script'>
         <mi>J</mi>
        </mstyle>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
      </mrow>
     </munder>
     <msubsup>
      <mi>x</mi>
      <mi>j</mi>
      <mn>2</mn>
     </msubsup>
     <mo stretchy='false'>-</mo>
     <mn>2</mn>
     <munder>
      <mo>&#x2211;</mo>
      <mrow>
       <mi>j</mi>
       <mo>&#x2208;</mo>
       <msup>
        <mstyle mathvariant='script'>
         <mi>J</mi>
        </mstyle>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
      </mrow>
     </munder>
     <msub>
      <mi>y</mi>
      <mi>j</mi>
     </msub>
     <msub>
      <mi>x</mi>
      <mi>j</mi>
     </msub>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
 <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
</mrow>
</math>
 In Figures <a href="#fig_Example_">A.0.1</a> &amp; <a href="#fig_Example__3">A.0.4</a>, we observe that increasing the batch size has improved the convergence however this is not a panacea. Also it had reduced the oscillations of chain <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo>}</mo>
</mrow>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-285'>
<br />
</div>

<div class='standard' id='magicparlabel-286'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-287'><span class="example_label">Example 34.</span>
<a id="exa_Consider_a__rather" />Consider a (rather naive) loss function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
   <mo stretchy='false'>=</mo>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>x</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo stretchy='false'>-</mo>
 <mtext>cos</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>0.5</mn>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>y</mi>
     <mo stretchy='false'>-</mo>
     <msub>
      <mi>w</mi>
      <mn>1</mn>
     </msub>
     <mo stretchy='false'>-</mo>
     <msub>
      <mi>w</mi>
      <mn>2</mn>
     </msub>
     <mi>x</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
, a hypothesis class <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mstyle mathvariant='script'>
  <mi>H</mi>
 </mstyle>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <mrow>
   <mi>w</mi>
   <mo>&#x2208;</mo>
   <msup>
    <mstyle mathvariant='double-struck'>
     <mi>R</mi>
    </mstyle>
    <mn>2</mn>
   </msup>
   <mo stretchy='false'>:</mo>
   <mrow>
    <mo>&#x2225;</mo>
    <mi>w</mi>
    <mo>&#x2225;</mo>
   </mrow>
   <mo>&#x2264;</mo>
   <mn>1.5</mn>
  </mrow>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
, and assume that inputs <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>x</mi>
</math>
 in dataset <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>D</mi>
</mstyle>
</math>
 are such that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>x</mi>
 <mo>&#x2208;</mo>
 <mrow>
  <mo>[</mo>
  <mrow>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
   <mo stretchy='false'>,</mo>
   <mn>1</mn>
  </mrow>
  <mo>]</mo>
 </mrow>
</mrow>
</math>
. Note that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo stretchy='false'>-</mo>
 <mtext>cos</mtext>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is convex in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>[</mo>
 <mrow>
  <mo stretchy='false'>-</mo>
  <mn>1.5</mn>
  <mo stretchy='false'>,</mo>
  <mn>1.5</mn>
 </mrow>
 <mo>]</mo>
</mrow>
</math>
 and non-convex in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='double-struck'>
 <mi>R</mi>
</mstyle>
</math>
. Consider learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mn>50</mn>
 <mo stretchy='false'>/</mo>
 <mi>t</mi>
</mrow>
</math>
 reducing to zero, and seed <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mn>0</mn>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mn>1.5</mn>
   <mo stretchy='false'>,</mo>
   <mn>1.5</mn>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. An unconstrained SGD may produce a minimizer/solution outside <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
 because <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>&#x3B7;</mi>
 <mi>t</mi>
</msub>
</math>
 is too large at the first few iterations. We can design the online SGD (batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>m</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
) with projection to <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
 as</div>
</div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-288'>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate:
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-289'><a id="enu_sample___and_2_1_1_1" /> randomly generate a set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mstyle mathvariant='script'>
   <mi>J</mi>
  </mstyle>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <msup>
   <mi>j</mi>
   <mo stretchy='false'>*</mo>
  </msup>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 by drawing one number from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mn>...</mn>
  <mo stretchy='false'>,</mo>
  <mi>n</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
  <msup>
   <mn>0</mn>
   <mn>6</mn>
  </msup>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
, and set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mstyle mathvariant='script'>
    <mi>S</mi>
   </mstyle>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mn>1</mn>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <msub>
   <mi>z</mi>
   <msup>
    <mi>j</mi>
    <mo stretchy='false'>*</mo>
   </msup>
  </msub>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
</li>
<li style='text-align: left;' id='magicparlabel-294'><a id="enu_sample___and_3_1_1" />compute
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
       <mo stretchy='false'>/</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <mfrac>
     <mi>t</mi>
    </mfrac>
    <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <mo>sin</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mn>0.5</mn>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msub>
             <mi>y</mi>
             <msup>
              <mi>j</mi>
              <mo stretchy='false'>*</mo>
             </msup>
            </msub>
            <mo stretchy='false'>-</mo>
            <msubsup>
             <mi>w</mi>
             <mn>1</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
            <mo stretchy='false'>-</mo>
            <msubsup>
             <mi>w</mi>
             <mn>2</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
            <msub>
             <mi>x</mi>
             <msup>
              <mi>j</mi>
              <mo stretchy='false'>*</mo>
             </msup>
            </msub>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow>
        <mo>sin</mo>
        <mrow>
         <mo>(</mo>
         <mrow>
          <mn>0.5</mn>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msub>
             <mi>y</mi>
             <msup>
              <mi>j</mi>
              <mo stretchy='false'>*</mo>
             </msup>
            </msub>
            <mo stretchy='false'>-</mo>
            <msubsup>
             <mi>w</mi>
             <mn>1</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
            <mo stretchy='false'>-</mo>
            <msubsup>
             <mi>w</mi>
             <mn>2</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
            <msub>
             <mi>x</mi>
             <msup>
              <mi>j</mi>
              <mo stretchy='false'>*</mo>
             </msup>
            </msub>
           </mrow>
           <mo>)</mo>
          </mrow>
         </mrow>
         <mo>)</mo>
        </mrow>
        <msub>
         <mi>x</mi>
         <msup>
          <mi>j</mi>
          <mo stretchy='false'>*</mo>
         </msup>
        </msub>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
       <mo stretchy='false'>/</mo>
       <mn>2</mn>
      </mrow>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <munder accent='false'>
     <mrow>
      <mo>arg</mo>
      <mo>min</mo>
     </mrow>
     <mrow>
      <mrow>
       <mo>&#x2225;</mo>
       <mi>w</mi>
       <mo>&#x2225;</mo>
      </mrow>
      <mo>&#x2264;</mo>
      <mn>1.5</mn>
     </mrow>
    </munder>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo>&#x2225;</mo>
      <mrow>
       <mi>w</mi>
       <mo stretchy='false'>-</mo>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mrow>
          <mi>t</mi>
          <mo stretchy='false'>+</mo>
          <mn>1</mn>
          <mo stretchy='false'>/</mo>
          <mn>2</mn>
         </mrow>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
      </mrow>
      <mo>&#x2225;</mo>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="enumerate_item" id='magicparlabel-295'>if <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo>&#x2265;</mo>
 <mi>T</mi>
 <mo stretchy='false'>=</mo>
 <mn>1000</mn>
</mrow>
</math>
 STOP</li>
</ol>
<div class='standard' id='magicparlabel-296'>because 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mi>&#x2207;</mi>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <msup>
     <mi>j</mi>
     <mo stretchy='false'>*</mo>
    </msup>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mi>&#x2202;</mi>
      <mrow>
       <mi>&#x2202;</mi>
       <msubsup>
        <mi>w</mi>
        <mn>1</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
      </mrow>
     </mfrac>
     <mi>&#x2113;</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>z</mi>
        <msup>
         <mi>j</mi>
         <mo stretchy='false'>*</mo>
        </msup>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mi>&#x2202;</mi>
      <mrow>
       <mi>&#x2202;</mi>
       <msubsup>
        <mi>w</mi>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
      </mrow>
     </mfrac>
     <mi>&#x2113;</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>z</mi>
        <msup>
         <mi>j</mi>
         <mo stretchy='false'>*</mo>
        </msup>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
 <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
 <mo stretchy='false'>=</mo>
 <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mn>0.5</mn>
     <mo>sin</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>0.5</mn>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>y</mi>
          <msup>
           <mi>j</mi>
           <mo stretchy='false'>*</mo>
          </msup>
         </msub>
         <mo stretchy='false'>-</mo>
         <msubsup>
          <mi>w</mi>
          <mn>1</mn>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mi>t</mi>
           <mo stretchy='false'>)</mo>
          </mrow>
         </msubsup>
         <mo stretchy='false'>-</mo>
         <msubsup>
          <mi>w</mi>
          <mn>2</mn>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mi>t</mi>
           <mo stretchy='false'>)</mo>
          </mrow>
         </msubsup>
         <msub>
          <mi>x</mi>
          <msup>
           <mi>j</mi>
           <mo stretchy='false'>*</mo>
          </msup>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mn>0.5</mn>
     <mo>sin</mo>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mn>0.5</mn>
       <mrow>
        <mo>(</mo>
        <mrow>
         <msub>
          <mi>y</mi>
          <msup>
           <mi>j</mi>
           <mo stretchy='false'>*</mo>
          </msup>
         </msub>
         <mo stretchy='false'>-</mo>
         <msubsup>
          <mi>w</mi>
          <mn>1</mn>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mi>t</mi>
           <mo stretchy='false'>)</mo>
          </mrow>
         </msubsup>
         <mo stretchy='false'>-</mo>
         <msubsup>
          <mi>w</mi>
          <mn>2</mn>
          <mrow>
           <mo stretchy='false'>(</mo>
           <mi>t</mi>
           <mo stretchy='false'>)</mo>
          </mrow>
         </msubsup>
         <msub>
          <mi>x</mi>
          <msup>
           <mi>j</mi>
           <mo stretchy='false'>*</mo>
          </msup>
         </msub>
        </mrow>
        <mo>)</mo>
       </mrow>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <msup>
       <mi>j</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </msub>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
 <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
</mrow>
</math>
In Figures <a href="#fig_Example__1">A.0.2</a> &amp; <a href="#fig_Example__4">A.0.5</a>, we observe that the SGD got trapped outside <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
 due to the unreasonably large learning rate at the beginning of the iterations, while the SGD with projection step managed to stay in <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mstyle mathvariant='script'>
 <mi>H</mi>
</mstyle>
</math>
 and converge. </div>
</li></ul>
</section>
<section>
<h2 class='section' id='magicparlabel-297'><span class="section_label">6</span> Stochastic Variance Reduced Gradient (SVRG) <div class='marginal'><div class='plain_layout' id='magicparlabel-301'>Ref [<a href="#enu_Johnson__Rie__and">3.</a>]</div>
</div></h2>
<div class='remark'>
<div class="remark_item" id='magicparlabel-302'><span class="remark_label">Remark 35.</span>
Recall the upper bound of the error <a href="#eq_sgd_upper_bound">(3.1)</a> in SGD depends on the variance of the stochastic gradient, as shown in <a href="#eq_">(3.5)</a> of Remark <a href="#rem_Note_that_the">16</a>. Hence the algorithm may be improved by reducing the variance of each element of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-303'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-304'><span class="remark_label">Remark 36.</span>
<a id="rem_Control_variate_is" />Control variate is a general way to perform variance reduction. Let random variables <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>v</mi>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>y</mi>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
. Let <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>z</mi>
 <mo stretchy='false'>=</mo>
 <mi>v</mi>
 <mo stretchy='false'>+</mo>
 <mi>c</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>y</mi>
   <mo stretchy='false'>-</mo>
   <mtext>E</mtext>
   <mrow>
    <mo>(</mo>
    <mi>y</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 for some constant <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>c</mi>
 <mo>&#x2208;</mo>
 <mstyle mathvariant='double-struck'>
  <mi>R</mi>
 </mstyle>
</mrow>
</math>
. It is <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mtext>E</mtext>
  <mi>c</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>z</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mi>v</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 and 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mtext>Var</mtext>
  <mi>c</mi>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>z</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mtext>Var</mtext>
 <mrow>
  <mo>(</mo>
  <mi>v</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>+</mo>
 <msup>
  <mi>c</mi>
  <mn>2</mn>
 </msup>
 <mtext>Var</mtext>
 <mrow>
  <mo>(</mo>
  <mi>y</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>+</mo>
 <mn>2</mn>
 <mi>c</mi>
 <mtext>Cov</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>x</mi>
   <mo stretchy='false'>,</mo>
   <mi>y</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 which is minimized for
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mi>c</mi>
  <mo stretchy='false'>*</mo>
 </msup>
 <mo stretchy='false'>=</mo>
 <mo stretchy='false'>-</mo>
 <mfrac>
  <mrow>
   <mtext>Cov</mtext>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mi>v</mi>
     <mo stretchy='false'>,</mo>
     <mi>y</mi>
    </mrow>
    <mo>)</mo>
   </mrow>
  </mrow>
  <mrow>
   <mtext>Var</mtext>
   <mrow>
    <mo>(</mo>
    <mi>y</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mfrac>
</mrow>
</math>
 hence
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mtext>Var</mtext>
  <msup>
   <mi>c</mi>
   <mo stretchy='false'>*</mo>
  </msup>
 </msub>
 <mrow>
  <mo>(</mo>
  <mi>z</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mtext>Var</mtext>
 <mrow>
  <mo>(</mo>
  <mi>v</mi>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>-</mo>
 <mfrac>
  <msup>
   <mrow>
    <mo>(</mo>
    <mrow>
     <mtext>Cov</mtext>
     <mrow>
      <mo>(</mo>
      <mrow>
       <mi>v</mi>
       <mo stretchy='false'>,</mo>
       <mi>y</mi>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
    <mo>)</mo>
   </mrow>
   <mn>2</mn>
  </msup>
  <mrow>
   <mtext>Var</mtext>
   <mrow>
    <mo>(</mo>
    <mi>y</mi>
    <mo>)</mo>
   </mrow>
  </mrow>
 </mfrac>
</mrow>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-305'>
<br />
</div>
<div class='note'>
<div class="note_item" id='magicparlabel-306'><span class="note_label">Note 37.</span>
For simplicity, SVRG is presented in the case where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>c</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
 and the loss function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>,</mo>
   <mi>z</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 is differentiable wrt <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 at every <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>z</mi>
</math>
 hence its gradient exists. However it is applicable to the more general cases introduced. </div>
</div>
<div class='standard' id='magicparlabel-307'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-308'><span class="remark_label">Remark 38.</span>
Every <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3BA;</mi>
</math>
 iterations, SVRG keeps a snapshot <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mover>
 <mi>w</mi>
 <mo stretchy='true'>&#x02DC;</mo>
</mover>
</math>
, and computes the gradient using all data i.e. <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mfrac>
  <mn>1</mn>
  <mi>n</mi>
 </mfrac>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>n</mi>
 </munderover>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mover>
    <mi>w</mi>
    <mo stretchy='true'>&#x02DC;</mo>
   </mover>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <mi>i</mi>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
. At each iteration <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
, the update is 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>-</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mrow>
  <mo>[</mo>
  <munder accent='false'>
   <munder>
    <mrow>
     <munder accent='false'>
      <munder>
       <mrow>
        <mi>&#x2207;</mi>
        <mi>&#x2113;</mi>
        <mrow>
         <mo>(</mo>
         <mrow>
          <msup>
           <mi>w</mi>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mi>t</mi>
            <mo stretchy='false'>)</mo>
           </mrow>
          </msup>
          <mo stretchy='false'>,</mo>
          <msup>
           <mover>
            <mi>z</mi>
            <mo stretchy='true'>&#x02DC;</mo>
           </mover>
           <mrow>
            <mo stretchy='false'>(</mo>
            <mi>t</mi>
            <mo stretchy='false'>)</mo>
           </mrow>
          </msup>
         </mrow>
         <mo>)</mo>
        </mrow>
       </mrow>
       <mo stretchy='true'>&#x23DF;</mo>
      </munder>
      <mrow>
       <mo stretchy='false'>=</mo>
       <mi>v</mi>
      </mrow>
     </munder>
     <mo stretchy='false'>-</mo>
     <munder accent='false'>
      <munder>
       <mn>1</mn>
       <mo stretchy='true'>&#x23DF;</mo>
      </munder>
      <mrow>
       <mo stretchy='false'>=</mo>
       <mi>c</mi>
      </mrow>
     </munder>
     <munder accent='false'>
      <munder>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mi>&#x2207;</mi>
         <mi>&#x2113;</mi>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mover>
            <mi>w</mi>
            <mo stretchy='true'>&#x02DC;</mo>
           </mover>
           <mo stretchy='false'>,</mo>
           <msup>
            <mover>
             <mi>z</mi>
             <mo stretchy='true'>&#x02DC;</mo>
            </mover>
            <mrow>
             <mo stretchy='false'>(</mo>
             <mi>t</mi>
             <mo stretchy='false'>)</mo>
            </mrow>
           </msup>
          </mrow>
          <mo>)</mo>
         </mrow>
         <mo stretchy='false'>-</mo>
         <mfrac>
          <mn>1</mn>
          <mi>n</mi>
         </mfrac>
         <munderover>
          <mo>&#x2211;</mo>
          <mrow>
           <mi>i</mi>
           <mo stretchy='false'>=</mo>
           <mn>1</mn>
          </mrow>
          <mi>n</mi>
         </munderover>
         <mi>&#x2207;</mi>
         <mi>&#x2113;</mi>
         <mrow>
          <mo>(</mo>
          <mrow>
           <mover>
            <mi>w</mi>
            <mo stretchy='true'>&#x02DC;</mo>
           </mover>
           <mo stretchy='false'>,</mo>
           <msub>
            <mi>z</mi>
            <mi>i</mi>
           </msub>
          </mrow>
          <mo>)</mo>
         </mrow>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mo stretchy='true'>&#x23DF;</mo>
      </munder>
      <mi>y</mi>
     </munder>
    </mrow>
    <mo stretchy='true'>&#x23DF;</mo>
   </munder>
   <mi>z</mi>
  </munder>
  <mo>]</mo>
 </mrow>
</mrow>
</math>
 given that a random <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mover>
  <mi>z</mi>
  <mo stretchy='true'>&#x02DC;</mo>
 </mover>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>t</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 has been collected from the sample. The symbols below the brackets are given with reference to Remark <a href="#rem_Control_variate_is">36</a>. </div>
</div>
<div class='standard' id='magicparlabel-330'>
<br />
</div>

<div class='standard' id='magicparlabel-331'>
<br />
</div>

<div class='standard' id='magicparlabel-332'><div class='Boxed'><div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-336'><span class="algorithm_label">Algorithm 39.</span>
<a id="alg_Stochastic_Variance_Reduced" /> Stochastic Variance Reduced Gradient with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 for Problem <a href="#prob_Consider_a_learning">1</a>.</div>
<div class="algorithm_item" id='magicparlabel-337'><hr />
</div>
<div class='plain_layout' style='text-align: left;' id='magicparlabel-338'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate:</i></div>
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-339'><i><a id="enu_sample___and_2" /> randomly get an example <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mover>
  <mi>z</mi>
  <mo stretchy='true'>&#x02DC;</mo>
 </mover>
 <mrow>
  <mo stretchy='false'>(</mo>
  <mi>t</mi>
  <mo stretchy='false'>)</mo>
 </mrow>
</msup>
</math>
 from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>S</mi>
 <mi>n</mi>
</msub>
</math>
.</i></li>
<li style='text-align: left;' id='magicparlabel-344'><i>compute <a id="eq_GD_UPDATE_MECHANISM_2_2" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo>[</mo>
     <mrow>
      <mi>&#x2207;</mi>
      <mi>&#x2113;</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <msup>
         <mi>w</mi>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
        <mo stretchy='false'>,</mo>
        <msup>
         <mover>
          <mi>z</mi>
          <mo stretchy='true'>&#x02DC;</mo>
         </mover>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>-</mo>
      <mi>&#x2207;</mi>
      <mi>&#x2113;</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mover>
         <mi>w</mi>
         <mo stretchy='true'>&#x02DC;</mo>
        </mover>
        <mo stretchy='false'>,</mo>
        <msup>
         <mover>
          <mi>z</mi>
          <mo stretchy='true'>&#x02DC;</mo>
         </mover>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msup>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mo stretchy='false'>+</mo>
      <mfrac>
       <mn>1</mn>
       <mi>n</mi>
      </mfrac>
      <munderover>
       <mo>&#x2211;</mo>
       <mrow>
        <mi>i</mi>
        <mo stretchy='false'>=</mo>
        <mn>1</mn>
       </mrow>
       <mi>n</mi>
      </munderover>
      <mi>&#x2207;</mi>
      <mi>&#x2113;</mi>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mover>
         <mi>w</mi>
         <mo stretchy='true'>&#x02DC;</mo>
        </mover>
        <mo stretchy='false'>,</mo>
        <msub>
         <mi>z</mi>
         <mi>i</mi>
        </msub>
       </mrow>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>]</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(6.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</i></li>
<li class="enumerate_item" id='magicparlabel-345'><i>if <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>modulo</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>&#x3BA;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
, set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mover>
  <mi>w</mi>
  <mo stretchy='true'>&#x02DC;</mo>
 </mover>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
</mrow>
</math>
</i></li>
<li style='text-align: left;' id='magicparlabel-346'><i>if a termination criterion is satisfied STOP</i></li>
</ol>
</div>
</div></div>


<div class='remark'>
<div class="remark_item" id='magicparlabel-376'><span class="remark_label">Remark 40.</span>
Iterations of SVRG are computationally faster than those of full GD, but SVRG can still match the theoretical convergence rate of GD.</div>
</div>
<div class='standard' id='magicparlabel-377'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-378'><span class="remark_label">Remark 41.</span>
How often we get snapshots, aka <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3BA;</mi>
</math>
, in Algorithm <a href="#alg_Stochastic_Variance_Reduced">39</a> is specified by the researcher. The smaller the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3BA;</mi>
</math>
, the more frequent snapshots, and the more correlated the baseline <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>y</mi>
</math>
 will be with the objective <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>x</mi>
</math>
 and hence the bigger the performance improvement; however the iterations will be slower. </div>
</div>
<div class='standard' id='magicparlabel-379'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-380'><span class="example_label">Example 42.</span>
<a id="exa_The_SVRG_with" /> The SVRG with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 and batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>m</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
 is</div>
<ul class='lyxitem lyxitemi'>
<li style='text-align: left;' id='magicparlabel-381'>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate:
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-382'><a id="enu_sample___and_2_1" /> randomly generate a set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mstyle mathvariant='script'>
   <mi>J</mi>
  </mstyle>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <msup>
   <mi>j</mi>
   <mo stretchy='false'>*</mo>
  </msup>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 by drawing one number <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msup>
 <mi>j</mi>
 <mo stretchy='false'>*</mo>
</msup>
</math>
 from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mn>...</mn>
  <mo stretchy='false'>,</mo>
  <mi>n</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
  <msup>
   <mn>0</mn>
   <mn>6</mn>
  </msup>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
, and set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mstyle mathvariant='script'>
    <mi>S</mi>
   </mstyle>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mn>1</mn>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <msub>
   <mi>z</mi>
   <msup>
    <mi>j</mi>
    <mo stretchy='false'>*</mo>
   </msup>
  </msub>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
</li>
<li style='text-align: left;' id='magicparlabel-387'>compute <a id="eq_GD_UPDATE_MECHANISM_2_2_2" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>[</mo>
    <mtable>
     <mtr>
      <mtd>
       <msubsup>
        <mi>w</mi>
        <mn>1</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <msubsup>
        <mi>w</mi>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
      </mtd>
     </mtr>
    </mtable>
    <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>]</mo>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>[</mo>
      <mtable>
       <mtr>
        <mtd>
         <mrow>
          <mn>2</mn>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msubsup>
             <mi>w</mi>
             <mn>1</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
            <mo stretchy='false'>-</mo>
            <msubsup>
             <mover>
              <mi>w</mi>
              <mo stretchy='true'>&#x02DC;</mo>
             </mover>
             <mn>1</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo>)</mo>
          </mrow>
          <mo stretchy='false'>+</mo>
          <mn>2</mn>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msubsup>
             <mi>w</mi>
             <mn>2</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo>)</mo>
          </mrow>
          <msub>
           <mi>x</mi>
           <msup>
            <mi>j</mi>
            <mo stretchy='false'>*</mo>
           </msup>
          </msub>
         </mrow>
        </mtd>
       </mtr>
       <mtr>
        <mtd>
         <mrow>
          <mn>2</mn>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msubsup>
             <mi>w</mi>
             <mn>2</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
            <mo stretchy='false'>-</mo>
            <msubsup>
             <mover>
              <mi>w</mi>
              <mo stretchy='true'>&#x02DC;</mo>
             </mover>
             <mn>2</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo>)</mo>
          </mrow>
          <msub>
           <mi>x</mi>
           <msup>
            <mi>j</mi>
            <mo stretchy='false'>*</mo>
           </msup>
          </msub>
          <mo stretchy='false'>+</mo>
          <mn>2</mn>
          <mrow>
           <mo>(</mo>
           <mrow>
            <msubsup>
             <mi>w</mi>
             <mn>2</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
            <mo stretchy='false'>-</mo>
            <msubsup>
             <mover>
              <mi>w</mi>
              <mo stretchy='true'>&#x02DC;</mo>
             </mover>
             <mn>2</mn>
             <mrow>
              <mo stretchy='false'>(</mo>
              <mi>t</mi>
              <mo stretchy='false'>)</mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo>)</mo>
          </mrow>
          <msup>
           <mrow>
            <mo>(</mo>
            <msub>
             <mi>x</mi>
             <msup>
              <mi>j</mi>
              <mo stretchy='false'>*</mo>
             </msup>
            </msub>
            <mo>)</mo>
           </mrow>
           <mn>2</mn>
          </msup>
         </mrow>
        </mtd>
       </mtr>
      </mtable>
      <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>]</mo>
      <mo stretchy='false'>+</mo>
      <mi>&#x2207;</mi>
      <msub>
       <mover>
        <mi>R</mi>
        <mo stretchy='true'>&#x02C6;</mo>
       </mover>
       <mstyle mathvariant='script'>
        <mi>D</mi>
       </mstyle>
      </msub>
      <mrow>
       <mo>(</mo>
       <mover>
        <mi>w</mi>
        <mo stretchy='true'>&#x02DC;</mo>
       </mover>
       <mo>)</mo>
      </mrow>
     </mrow>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(6.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="enumerate_item" id='magicparlabel-388'>if <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>modulo</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>&#x3BA;</mi>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mn>0</mn>
</mrow>
</math>
, 
<ol class='lyxenum enumii'>
<li class="enumerate_item" id='magicparlabel-389'>set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mover>
  <mi>w</mi>
  <mo stretchy='true'>&#x02DC;</mo>
 </mover>
 <mo stretchy='false'>=</mo>
 <msup>
  <mi>w</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
</mrow>
</math>
</li>
<li class="enumerate_item" id='magicparlabel-390'>compute <a id="eq_tyhtsstyrujey" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <mfrac>
     <mn>1</mn>
     <mi>n</mi>
    </mfrac>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>i</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>n</mi>
    </munderover>
    <mi>&#x2113;</mi>
    <mrow>
     <mo>(</mo>
     <mrow>
      <mover>
       <mi>w</mi>
       <mo stretchy='true'>&#x02DC;</mo>
      </mover>
      <mo stretchy='false'>,</mo>
      <msub>
       <mi>z</mi>
       <mi>i</mi>
      </msub>
     </mrow>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>=</mo>
    <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <mn>2</mn>
        <msubsup>
         <mover>
          <mi>w</mi>
          <mo stretchy='true'>&#x02DC;</mo>
         </mover>
         <mn>1</mn>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msubsup>
        <mo stretchy='false'>+</mo>
        <mn>2</mn>
        <msubsup>
         <mover>
          <mi>w</mi>
          <mo stretchy='true'>&#x02DC;</mo>
         </mover>
         <mn>2</mn>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msubsup>
        <mover>
         <mi>x</mi>
         <mo stretchy='true'>&#x00AF;</mo>
        </mover>
        <mo stretchy='false'>-</mo>
        <mn>2</mn>
        <mover>
         <mi>y</mi>
         <mo stretchy='true'>&#x00AF;</mo>
        </mover>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow>
        <mn>2</mn>
        <msubsup>
         <mover>
          <mi>w</mi>
          <mo stretchy='true'>&#x02DC;</mo>
         </mover>
         <mn>1</mn>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msubsup>
        <mover>
         <mi>x</mi>
         <mo stretchy='true'>&#x00AF;</mo>
        </mover>
        <mo stretchy='false'>+</mo>
        <mn>2</mn>
        <msubsup>
         <mover>
          <mi>w</mi>
          <mo stretchy='true'>&#x02DC;</mo>
         </mover>
         <mn>2</mn>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msubsup>
        <mover>
         <msup>
          <mi>x</mi>
          <mn>2</mn>
         </msup>
         <mo stretchy='true'>&#x00AF;</mo>
        </mover>
        <mo stretchy='false'>-</mo>
        <mn>2</mn>
        <msup>
         <mi>y</mi>
         <mi>&#x22A4;</mi>
        </msup>
        <mi>x</mi>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
    <mo stretchy='false'>=</mo>
    <mi>&#x2207;</mi>
    <msub>
     <mover>
      <mi>R</mi>
      <mo stretchy='true'>&#x02C6;</mo>
     </mover>
     <mstyle mathvariant='script'>
      <mi>D</mi>
     </mstyle>
    </msub>
    <mrow>
     <mo>(</mo>
     <mover>
      <mi>w</mi>
      <mo stretchy='true'>&#x02DC;</mo>
     </mover>
     <mo>)</mo>
    </mrow>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(6.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
</ol>
</li><li style='text-align: left;' id='magicparlabel-391'>if a termination criterion is satisfied STOP</li>
</ol>
</li></ul>
<div class='standard' id='magicparlabel-396'>Because <a href="#eq_tyhtsstyrujey">(6.3)</a> is actually the gradient of the Risk function at <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mover>
 <mi>w</mi>
 <mo stretchy='true'>&#x02DC;</mo>
</mover>
</math>
 and 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mi>&#x2207;</mi>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <msup>
     <mi>j</mi>
     <mo stretchy='false'>*</mo>
    </msup>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>-</mo>
 <mi>&#x2207;</mi>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <mover>
    <mi>w</mi>
    <mo stretchy='true'>&#x02DC;</mo>
   </mover>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <msup>
     <mi>j</mi>
     <mo stretchy='false'>*</mo>
    </msup>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msubsup>
        <mi>w</mi>
        <mn>1</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <mo stretchy='false'>-</mo>
       <msubsup>
        <mover>
         <mi>w</mi>
         <mo stretchy='true'>&#x02DC;</mo>
        </mover>
        <mn>1</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <mo stretchy='false'>+</mo>
     <mn>2</mn>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msubsup>
        <mi>w</mi>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <mo stretchy='false'>-</mo>
       <msubsup>
        <mover>
         <mi>w</mi>
         <mo stretchy='true'>&#x02DC;</mo>
        </mover>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <msup>
       <mi>j</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </msub>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mn>2</mn>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msubsup>
        <mi>w</mi>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <mo stretchy='false'>-</mo>
       <msubsup>
        <mover>
         <mi>w</mi>
         <mo stretchy='true'>&#x02DC;</mo>
        </mover>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
      </mrow>
      <mo>)</mo>
     </mrow>
     <msub>
      <mi>x</mi>
      <msup>
       <mi>j</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </msub>
     <mo stretchy='false'>+</mo>
     <mn>2</mn>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msubsup>
        <mi>w</mi>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <msup>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>x</mi>
          <msup>
           <mi>j</mi>
           <mo stretchy='false'>*</mo>
          </msup>
         </msub>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
       <mo stretchy='false'>-</mo>
       <msubsup>
        <mover>
         <mi>w</mi>
         <mo stretchy='true'>&#x02DC;</mo>
        </mover>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <msup>
        <mrow>
         <mo>(</mo>
         <msub>
          <mi>x</mi>
          <msup>
           <mi>j</mi>
           <mo stretchy='false'>*</mo>
          </msup>
         </msub>
         <mo>)</mo>
        </mrow>
        <mn>2</mn>
       </msup>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
 <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
</mrow>
</math>
In Figure <a href="#fig_Example__2">A.0.3</a> we observe the frequency of the snapshots has improved the convergence; however this is not a panacea as seen in Figure <a href="#fig_Example__5">A.0.6</a>. </div>
</div>
<div class='standard' id='magicparlabel-397'>
<br />
</div>
</section>
<section>
<h2 class='section' id='magicparlabel-398'><span class="section_label">7</span> Preconditioned SGD; The AdaGrad algorithm <div class='marginal'><div class='plain_layout' id='magicparlabel-402'>Ref [<a href="#enu_Duchi__John__Elad">4.</a>]</div>
</div></h2>
<div class='remark'>
<div class="remark_item" id='magicparlabel-403'><span class="remark_label">Remark 43.</span>
All SGD (introduced earlier) are first order methods in the sense they consider only the gradient. Their advantage is each iteration is fast. The disadvantage is that they ignore the curvature of the space and hence can be slower to converge in cases the curvature changes eg. among dimensions of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
. </div>
</div>
<div class='standard' id='magicparlabel-404'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-405'><span class="remark_label">Remark 44.</span>
To address this, SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent">6</a>) can be modified in the update step as in Algorithm <a href="#alg_Stochastic_Gradient_descent_2">45</a> by using a preconditioner <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>P</mi>
 <mi>t</mi>
</msub>
</math>
 that accounts for the curvature (or geometry in general of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>f</mi>
</math>
). </div>
</div>
<div class='standard' id='magicparlabel-410'>
<br />
</div>

<div class='standard' id='magicparlabel-411'><div class='Boxed'><div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-415'><span class="algorithm_label">Algorithm 45.</span>
<a id="alg_Stochastic_Gradient_descent_2" /> Preconditioned Stochastic Gradient Descent with learning rate <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
, and preconditioner <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>P</mi>
 <mi>t</mi>
</msub>
</math>
 for the solution of the minimization problem <a href="#eq_gvbzvcb">eq:gvbzvcb</a> <hr />
</div>
<div class='plain_layout' id='magicparlabel-420'><i>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate:</i></div>
<ol class='lyxenum enumi'>
<li style='text-align: left;' id='magicparlabel-421'><i><a id="enu_compute__where_2" />compute <a id="eq_GD_UPDATE_MECHANISM_4" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mrow>
       <mi>t</mi>
       <mo stretchy='false'>+</mo>
       <mn>1</mn>
      </mrow>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <msub>
     <mi>P</mi>
     <mi>t</mi>
    </msub>
    <msub>
     <mi>v</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(7.1)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>v</mi>
 <mi>t</mi>
</msub>
</math>
 is a random vector such that <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>E</mtext>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msub>
    <mi>v</mi>
    <mi>t</mi>
   </msub>
   <mo stretchy='false'>|</mo>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo>&#x2208;</mo>
 <mi>&#x2202;</mi>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <msup>
   <mi>w</mi>
   <mrow>
    <mo stretchy='false'>(</mo>
    <mi>t</mi>
    <mo stretchy='false'>)</mo>
   </mrow>
  </msup>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>P</mi>
 <mi>t</mi>
</msub>
</math>
 is a preconditioner</i></li>
<li class="enumerate_item" id='magicparlabel-422'><i><a id="enu_terminate_if_2_2" />terminate if a termination criterion is satisfied, e.g.
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <mtext>If</mtext>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mi>t</mi>
 <mo>&#x2265;</mo>
 <mi>T</mi>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mtext>then</mtext>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mspace width="6px"/>
 <mtext>STOP</mtext>
</mrow>
</math>
</i></li>
</ol>
</div>
</div></div>

<div class='standard' id='magicparlabel-423'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-424'><span class="remark_label">Remark 46.</span>
A natural choice of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>P</mi>
 <mi>t</mi>
</msub>
</math>
 can be <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>P</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>:</mo>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>[</mo>
   <mrow>
    <msub>
     <mi>H</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>+</mo>
    <mi>&#x3F5;</mi>
    <msub>
     <mi>I</mi>
     <mi>d</mi>
    </msub>
   </mrow>
   <mo>]</mo>
  </mrow>
  <mrow>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
  </mrow>
 </msup>
</mrow>
</math>
, where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>H</mi>
 <mi>t</mi>
</msub>
</math>
 is the Hessian matrix <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mrow>
   <mo>[</mo>
   <msub>
    <mi>H</mi>
    <mi>t</mi>
   </msub>
   <mo>]</mo>
  </mrow>
  <mrow>
   <mi>i</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mo stretchy='false'>=</mo>
 <msub>
  <mrow>
   <mo>.</mo>
   <mrow>
    <mfrac>
     <msup>
      <mi>&#x2202;</mi>
      <mn>2</mn>
     </msup>
     <mrow>
      <mi>&#x2202;</mi>
      <msub>
       <mi>w</mi>
       <mi>i</mi>
      </msub>
      <mi>&#x2202;</mi>
      <msub>
       <mi>w</mi>
       <mi>j</mi>
      </msub>
     </mrow>
    </mfrac>
    <mi>f</mi>
    <mrow>
     <mo>(</mo>
     <mi>w</mi>
     <mo>)</mo>
    </mrow>
   </mrow>
   <mo>|</mo>
  </mrow>
  <mrow>
   <mi>w</mi>
   <mo stretchy='false'>=</mo>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mrow>
 </msub>
</mrow>
</math>
 (ie. the gradient of the gradient&#8217;s elements), and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>&#x3F5;</mi>
</math>
 is a tiny <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3F5;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 to mitigate machine error when Hessian elements are close to zero. </div>
</div>
<div class='standard' id='magicparlabel-425'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-426'><span class="remark_label">Remark 47.</span>
If the preconditioner <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>P</mi>
 <mi>t</mi>
</msub>
</math>
 is set to be the inverse of the full Hessian, it may be too expensive to perform matrix operations in <a href="#eq_GD_UPDATE_MECHANISM_4">(7.1)</a> with the full Hessian, and such operations can be too unstable/inaccurate due to the random error induced by the stochasticity of the gradient. </div>
</div>
<section>
<h3 class='subsection' id='magicparlabel-427'><span class="subsection_label">7.1</span> <a id="subsec_Adaptive_Stochastic_Gradient" /> Adaptive Stochastic Gradient Decent (AdaGrad)</h3>
<div class='remark'>
<div class="remark_item" id='magicparlabel-441'><span class="remark_label">Remark 48.</span>
AdaGrad aims to dynamically incorporate knowledge of the geometry of function <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>f</mi>
 <mrow>
  <mo>(</mo>
  <mo>&#x22C5;</mo>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 (to be minimized) in earlier iterations to perform more informative gradient-based learning. </div>
</div>
<div class='standard' id='magicparlabel-442'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-443'><span class="remark_label">Remark 49.</span>
AdaGrad aims to perform larger updates (i.e. high learning rates) for those dimensions of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 that are related to infrequent features (largest partial derivative) and smaller updates (i.e. low learning rates) for frequent ones (smaller partial derivative).</div>
</div>
<div class='standard' id='magicparlabel-444'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-445'><span class="remark_label">Remark 50.</span>
Hence, this strategy often improves convergence performance over standard stochastic gradient descent in settings where the data are sparse and sparse features <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
&#8217;s are more informative. </div>
</div>
<div class='standard' id='magicparlabel-446'>
<br />
</div>
<div class='algorithm'>
<div class="algorithm_item" id='magicparlabel-447'><span class="algorithm_label">Algorithm 51.</span>
<a id="def_Adaptive_Stochastic_Gradient" /> Adaptive Stochastic Gradient Decent (AdaGrad) can be presented in terms of preconditioned SGD (Algorithm <a href="#alg_Stochastic_Gradient_descent_2">45</a>) with preconditioner <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>P</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>[</mo>
   <mrow>
    <mtext>diag</mtext>
    <mrow>
     <mo>(</mo>
     <msub>
      <mi>G</mi>
      <mi>t</mi>
     </msub>
     <mo>)</mo>
    </mrow>
    <mo stretchy='false'>+</mo>
    <mi>&#x3F5;</mi>
    <msub>
     <mi>I</mi>
     <mi>d</mi>
    </msub>
   </mrow>
   <mo>]</mo>
  </mrow>
  <mrow>
   <mo stretchy='false'>-</mo>
   <mn>1</mn>
   <mo stretchy='false'>/</mo>
   <mn>2</mn>
  </mrow>
 </msup>
</mrow>
</math>
 in <a href="#eq_GD_UPDATE_MECHANISM_4">(7.1)</a> <a id="eq_GD_UPDATE_MECHANISM_4_1" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <msup>
     <mi>w</mi>
     <mrow>
      <mo stretchy='false'>(</mo>
      <mi>t</mi>
      <mo stretchy='false'>)</mo>
     </mrow>
    </msup>
    <mo stretchy='false'>-</mo>
    <msub>
     <mi>&#x3B7;</mi>
     <mi>t</mi>
    </msub>
    <msup>
     <mrow>
      <mo>[</mo>
      <mrow>
       <mtext>diag</mtext>
       <mrow>
        <mo>(</mo>
        <msub>
         <mi>G</mi>
         <mi>t</mi>
        </msub>
        <mo>)</mo>
       </mrow>
       <mo stretchy='false'>+</mo>
       <mi>&#x3F5;</mi>
       <msub>
        <mi>I</mi>
        <mi>d</mi>
       </msub>
      </mrow>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
      <mo stretchy='false'>/</mo>
      <mn>2</mn>
     </mrow>
    </msup>
    <msub>
     <mi>v</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(7.2)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where notation <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mtext>diag</mtext>
 <mrow>
  <mo>(</mo>
  <mi>A</mi>
  <mo>)</mo>
 </mrow>
</mrow>
</math>
 denotes a <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>d</mi>
 <mo>&#x00D7;</mo>
 <mi>d</mi>
</mrow>
</math>
 matrix whose diagonal is the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>d</mi>
</math>
 dimensional diagonal vector <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>(</mo>
 <mrow>
  <msub>
   <mi>A</mi>
   <mrow>
    <mn>1</mn>
    <mo stretchy='false'>,</mo>
    <mn>1</mn>
   </mrow>
  </msub>
  <mo stretchy='false'>,</mo>
  <msub>
   <mi>A</mi>
   <mrow>
    <mn>2</mn>
    <mo stretchy='false'>,</mo>
    <mn>2</mn>
   </mrow>
  </msub>
  <mn>...</mn>
  <mo stretchy='false'>,</mo>
  <msub>
   <mi>A</mi>
   <mrow>
    <mi>d</mi>
    <mo stretchy='false'>,</mo>
    <mi>d</mi>
   </mrow>
  </msub>
 </mrow>
 <mo>)</mo>
</mrow>
</math>
 of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>d</mi>
 <mo>&#x00D7;</mo>
 <mi>d</mi>
</mrow>
</math>
 matrix <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>A</mi>
</math>
 and whose off-diagonal elements are zero, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>G</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <munderover>
  <mo>&#x2211;</mo>
  <mrow>
   <mi>&#x3C4;</mi>
   <mo stretchy='false'>=</mo>
   <mn>1</mn>
  </mrow>
  <mi>t</mi>
 </munderover>
 <msub>
  <mi>v</mi>
  <mi>&#x3C4;</mi>
 </msub>
 <msubsup>
  <mi>v</mi>
  <mi>&#x3C4;</mi>
  <mi>&#x22A4;</mi>
 </msubsup>
</mrow>
</math>
 is the sum of the outer products of the gradients <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msub>
   <mi>v</mi>
   <mi>&#x3C4;</mi>
  </msub>
  <mo stretchy='false'>;</mo>
  <mi>&#x3C4;</mi>
  <mo>&#x2264;</mo>
  <mi>t</mi>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
 up to the state <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>t</mi>
</math>
, and <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3F5;</mi>
 <mo stretchy='false'>&gt;</mo>
 <mn>0</mn>
</mrow>
</math>
 is a tiny value (eg, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mn>1</mn>
 <msup>
  <mn>0</mn>
  <mrow>
   <mo stretchy='false'>-</mo>
   <mn>6</mn>
  </mrow>
 </msup>
</mrow>
</math>
) set for computational stability is case the gradient becomes too close to zero.</div>
</div>
<div class='standard' id='magicparlabel-452'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-453'><span class="remark_label">Remark 52.</span>
AdaGrad algorithm individually adapts the learning rate of each dimension of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mi>t</mi>
</msub>
</math>
 by scaling them inversely proportional to the square root of the sum of all the past squared values of the gradient <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <msub>
   <mi>v</mi>
   <mi>&#x3C4;</mi>
  </msub>
  <mo stretchy='false'>;</mo>
  <mi>&#x3C4;</mi>
  <mo>&#x2264;</mo>
  <mi>t</mi>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
. This is because <a id="eq_fgsfg" />
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true'>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mrow>
      <mo>[</mo>
      <msub>
       <mi>G</mi>
       <mi>t</mi>
      </msub>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mi>j</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>=</mo>
    <munderover>
     <mo>&#x2211;</mo>
     <mrow>
      <mi>&#x3C4;</mi>
      <mo stretchy='false'>=</mo>
      <mn>1</mn>
     </mrow>
     <mi>t</mi>
    </munderover>
    <msup>
     <mrow>
      <mo>(</mo>
      <msub>
       <mi>v</mi>
       <mrow>
        <mi>&#x3C4;</mi>
        <mo stretchy='false'>,</mo>
        <mi>j</mi>
       </mrow>
      </msub>
      <mo>)</mo>
     </mrow>
     <mn>2</mn>
    </msup>
   </mrow>
  </mtd>
  <mtd>
   <mtext>(7.3)</mtext>
  </mtd>
 </mtr>
</mtable>
</math>
 where <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>j</mi>
</math>
 denotes the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>j</mi>
</math>
-th dimension of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
. Hence <a href="#eq_GD_UPDATE_MECHANISM_4_1">(7.2)</a> and <a href="#eq_GD_UPDATE_MECHANISM_4_1">(7.2)</a>imply that the <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>j</mi>
</math>
-th dimension of <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mi>w</mi>
</math>
 is updated as 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msubsup>
  <mi>w</mi>
  <mi>j</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mrow>
    <mi>t</mi>
    <mo stretchy='false'>+</mo>
    <mn>1</mn>
   </mrow>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msubsup>
 <mo stretchy='false'>=</mo>
 <msubsup>
  <mi>w</mi>
  <mi>j</mi>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msubsup>
 <mo stretchy='false'>-</mo>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mfrac>
  <mn>1</mn>
  <msqrt>
   <mrow>
    <msub>
     <mrow>
      <mo>[</mo>
      <msub>
       <mi>G</mi>
       <mi>t</mi>
      </msub>
      <mo>]</mo>
     </mrow>
     <mrow>
      <mi>j</mi>
      <mo stretchy='false'>,</mo>
      <mi>j</mi>
     </mrow>
    </msub>
    <mo stretchy='false'>+</mo>
    <mi>&#x3F5;</mi>
   </mrow>
  </msqrt>
 </mfrac>
 <msub>
  <mi>v</mi>
  <mrow>
   <mi>t</mi>
   <mo stretchy='false'>,</mo>
   <mi>j</mi>
  </mrow>
 </msub>
 <mn>.</mn>
</mrow>
</math>
</div>
</div>
<div class='standard' id='magicparlabel-454'>
<br />
</div>
<div class='remark'>
<div class="remark_item" id='magicparlabel-455'><span class="remark_label">Remark 53.</span>
The accumulation of positive terms in <a href="#eq_fgsfg">(7.3)</a> makes the sum keep growing during training and causes the learning rate to shrink and becoming infinitesimally small. This offers an automatic way to choose a decreasing learning rate simplifying setting the learning rate; however it may result in a premature and excessive decrease in the effective learning rate. This can be mitigated by still considering in <a href="#eq_GD_UPDATE_MECHANISM_4_1">(7.2)</a> a (user specified rate) <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo>&#x2265;</mo>
 <mn>0</mn>
</mrow>
</math>
 and tuning it properly via pilot runs.</div>
</div>
<div class='standard' id='magicparlabel-456'>
<br />
</div>
<div class='example'>
<div class="example_item" id='magicparlabel-457'><span class="example_label">Example 54.</span>
<a id="exa_The_AdaGrad_with" />The AdaGrad with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>&#x3B7;</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
, <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3F5;</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <msup>
  <mn>0</mn>
  <mrow>
   <mo stretchy='false'>-</mo>
   <mn>6</mn>
  </mrow>
 </msup>
</mrow>
</math>
, and batch size <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>m</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
 is</div>
<ul class='lyxitem lyxitemi'>
<li class="itemize_item" id='magicparlabel-458'>Set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mi>G</mi>
  <mn>0</mn>
 </msub>
 <mo stretchy='false'>=</mo>
 <msup>
  <mrow>
   <mo>(</mo>
   <mrow>
    <mn>0</mn>
    <mo stretchy='false'>,</mo>
    <mn>0</mn>
   </mrow>
   <mo>)</mo>
  </mrow>
  <mi>&#x22A4;</mi>
 </msup>
</mrow>
</math>
.</li>
<li class="itemize_item" id='magicparlabel-459'>For <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
 <mo stretchy='false'>,</mo>
 <mn>2</mn>
 <mo stretchy='false'>,</mo>
 <mn>3</mn>
 <mo stretchy='false'>,</mo>
 <mn>...</mn>
</mrow>
</math>
 iterate:
<ol class='lyxenum enumi'>
<li class="enumerate_item" id='magicparlabel-460'><a id="enu_sample___and_2_1_1" /> randomly generate a set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msup>
  <mstyle mathvariant='script'>
   <mi>J</mi>
  </mstyle>
  <mrow>
   <mo stretchy='false'>(</mo>
   <mi>t</mi>
   <mo stretchy='false'>)</mo>
  </mrow>
 </msup>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <msup>
   <mi>j</mi>
   <mo stretchy='false'>*</mo>
  </msup>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
 by drawing one number from <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mo>{</mo>
 <mrow>
  <mn>1</mn>
  <mo stretchy='false'>,</mo>
  <mn>...</mn>
  <mo stretchy='false'>,</mo>
  <mi>n</mi>
  <mo stretchy='false'>=</mo>
  <mn>1</mn>
  <msup>
   <mn>0</mn>
   <mn>6</mn>
  </msup>
 </mrow>
 <mo>}</mo>
</mrow>
</math>
, and set <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <msub>
  <mover>
   <mstyle mathvariant='script'>
    <mi>S</mi>
   </mstyle>
   <mo stretchy='true'>&#x02DC;</mo>
  </mover>
  <mn>1</mn>
 </msub>
 <mo stretchy='false'>=</mo>
 <mrow>
  <mo>{</mo>
  <msub>
   <mi>z</mi>
   <msup>
    <mi>j</mi>
    <mo stretchy='false'>*</mo>
   </msup>
  </msub>
  <mo>}</mo>
 </mrow>
</mrow>
</math>
</li>
<li style='text-align: left;' id='magicparlabel-465'><a id="enu_sample___and_3_1" />compute
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mtable displaystyle='true' columnalign='right left '>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>v</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
   <mtable>
    <mtr>
     <mtd>
      <mrow>
       <mn>2</mn>
       <msubsup>
        <mi>w</mi>
        <mn>1</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <mo stretchy='false'>+</mo>
       <mn>2</mn>
       <msubsup>
        <mi>w</mi>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <msub>
        <mi>x</mi>
        <msup>
         <mi>j</mi>
         <mo stretchy='false'>*</mo>
        </msup>
       </msub>
       <mo stretchy='false'>-</mo>
       <mn>2</mn>
       <msub>
        <mi>y</mi>
        <msup>
         <mi>j</mi>
         <mo stretchy='false'>*</mo>
        </msup>
       </msub>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow>
       <mn>2</mn>
       <msubsup>
        <mi>w</mi>
        <mn>1</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <mover>
        <mi>x</mi>
        <mo stretchy='true'>&#x00AF;</mo>
       </mover>
       <mo stretchy='false'>+</mo>
       <mn>2</mn>
       <msubsup>
        <mi>w</mi>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
       <msubsup>
        <mi>x</mi>
        <msup>
         <mi>j</mi>
         <mo stretchy='false'>*</mo>
        </msup>
        <mn>2</mn>
       </msubsup>
       <mo stretchy='false'>-</mo>
       <mn>2</mn>
       <msub>
        <mi>y</mi>
        <msup>
         <mi>j</mi>
         <mo stretchy='false'>*</mo>
        </msup>
       </msub>
       <msub>
        <mi>x</mi>
        <msup>
         <mi>j</mi>
         <mo stretchy='false'>*</mo>
        </msup>
       </msub>
      </mrow>
     </mtd>
    </mtr>
   </mtable>
   <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <mrow>
    <msub>
     <mi>G</mi>
     <mi>t</mi>
    </msub>
    <mo stretchy='false'>=</mo>
   </mrow>
  </mtd>
  <mtd>
   <mrow>
    <msub>
     <mi>G</mi>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>-</mo>
      <mn>1</mn>
     </mrow>
    </msub>
    <mo stretchy='false'>+</mo>
    <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
    <mtable>
     <mtr>
      <mtd>
       <msubsup>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>,</mo>
         <mn>1</mn>
        </mrow>
        <mn>2</mn>
       </msubsup>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <msubsup>
        <mi>v</mi>
        <mrow>
         <mi>t</mi>
         <mo stretchy='false'>,</mo>
         <mn>2</mn>
        </mrow>
        <mn>2</mn>
       </msubsup>
      </mtd>
     </mtr>
    </mtable>
    <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
   </mrow>
  </mtd>
 </mtr>
 <mtr>
  <mtd>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mrow>
      <mi>t</mi>
      <mo stretchy='false'>+</mo>
      <mn>1</mn>
     </mrow>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
  </mtd>
  <mtd>
   <mrow>
    <mo stretchy='false'>=</mo>
    <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
    <mtable>
     <mtr>
      <mtd>
       <mrow>
        <msubsup>
         <mi>w</mi>
         <mn>1</mn>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msubsup>
        <mo stretchy='false'>-</mo>
        <mfrac>
         <msub>
          <mi>&#x3B7;</mi>
          <mi>t</mi>
         </msub>
         <msqrt>
          <mrow>
           <msub>
            <mi>G</mi>
            <mrow>
             <mi>t</mi>
             <mo stretchy='false'>,</mo>
             <mn>1</mn>
            </mrow>
           </msub>
           <mo stretchy='false'>+</mo>
           <mi>&#x3F5;</mi>
          </mrow>
         </msqrt>
        </mfrac>
        <msub>
         <mi>v</mi>
         <mrow>
          <mi>t</mi>
          <mo stretchy='false'>,</mo>
          <mn>1</mn>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
     <mtr>
      <mtd>
       <mrow>
        <msubsup>
         <mi>w</mi>
         <mn>2</mn>
         <mrow>
          <mo stretchy='false'>(</mo>
          <mi>t</mi>
          <mo stretchy='false'>)</mo>
         </mrow>
        </msubsup>
        <mo stretchy='false'>-</mo>
        <mfrac>
         <msub>
          <mi>&#x3B7;</mi>
          <mi>t</mi>
         </msub>
         <msqrt>
          <mrow>
           <msub>
            <mi>G</mi>
            <mrow>
             <mi>t</mi>
             <mo stretchy='false'>,</mo>
             <mn>2</mn>
            </mrow>
           </msub>
           <mo stretchy='false'>+</mo>
           <mi>&#x3F5;</mi>
          </mrow>
         </msqrt>
        </mfrac>
        <msub>
         <mi>v</mi>
         <mrow>
          <mi>t</mi>
          <mo stretchy='false'>,</mo>
          <mn>2</mn>
         </mrow>
        </msub>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
    <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
    <mo stretchy='false'>,</mo>
   </mrow>
  </mtd>
 </mtr>
</mtable>
</math>
</li>
<li class="enumerate_item" id='magicparlabel-466'>if <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>t</mi>
 <mo>&#x2265;</mo>
 <mi>T</mi>
 <mo stretchy='false'>=</mo>
 <mn>1000</mn>
</mrow>
</math>
 STOP</li>
</ol>
</li></ul>
<div class='standard' id='magicparlabel-467'>because 
<math xmlns='http://www.w3.org/1998/Math/MathML' display='block'>
<mrow>
 <msub>
  <mi>v</mi>
  <mi>t</mi>
 </msub>
 <mo stretchy='false'>=</mo>
 <mi>&#x2207;</mi>
 <mi>&#x2113;</mi>
 <mrow>
  <mo>(</mo>
  <mrow>
   <msup>
    <mi>w</mi>
    <mrow>
     <mo stretchy='false'>(</mo>
     <mi>t</mi>
     <mo stretchy='false'>)</mo>
    </mrow>
   </msup>
   <mo stretchy='false'>,</mo>
   <msub>
    <mi>z</mi>
    <msup>
     <mi>j</mi>
     <mo stretchy='false'>*</mo>
    </msup>
   </msub>
  </mrow>
  <mo>)</mo>
 </mrow>
 <mo stretchy='false'>=</mo>
 <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mi>&#x2202;</mi>
      <mrow>
       <mi>&#x2202;</mi>
       <msubsup>
        <mi>w</mi>
        <mn>1</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
      </mrow>
     </mfrac>
     <mi>&#x2113;</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>z</mi>
        <msup>
         <mi>j</mi>
         <mo stretchy='false'>*</mo>
        </msup>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mfrac>
      <mi>&#x2202;</mi>
      <mrow>
       <mi>&#x2202;</mi>
       <msubsup>
        <mi>w</mi>
        <mn>2</mn>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msubsup>
      </mrow>
     </mfrac>
     <mi>&#x2113;</mi>
     <mrow>
      <mo>(</mo>
      <mrow>
       <msup>
        <mi>w</mi>
        <mrow>
         <mo stretchy='false'>(</mo>
         <mi>t</mi>
         <mo stretchy='false'>)</mo>
        </mrow>
       </msup>
       <mo stretchy='false'>,</mo>
       <msub>
        <mi>z</mi>
        <msup>
         <mi>j</mi>
         <mo stretchy='false'>*</mo>
        </msup>
       </msub>
      </mrow>
      <mo>)</mo>
     </mrow>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
 <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
 <mo stretchy='false'>=</mo>
 <mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>(</mo>
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>1</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mo stretchy='false'>+</mo>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>2</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <msub>
      <mi>x</mi>
      <msup>
       <mi>j</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </msub>
     <mo stretchy='false'>-</mo>
     <mn>2</mn>
     <msub>
      <mi>y</mi>
      <msup>
       <mi>j</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </msub>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>1</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <mover>
      <mi>x</mi>
      <mo stretchy='true'>&#x00AF;</mo>
     </mover>
     <mo stretchy='false'>+</mo>
     <mn>2</mn>
     <msubsup>
      <mi>w</mi>
      <mn>2</mn>
      <mrow>
       <mo stretchy='false'>(</mo>
       <mi>t</mi>
       <mo stretchy='false'>)</mo>
      </mrow>
     </msubsup>
     <msubsup>
      <mi>x</mi>
      <msup>
       <mi>j</mi>
       <mo stretchy='false'>*</mo>
      </msup>
      <mn>2</mn>
     </msubsup>
     <mo stretchy='false'>-</mo>
     <mn>2</mn>
     <msub>
      <mi>y</mi>
      <msup>
       <mi>j</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </msub>
     <msub>
      <mi>x</mi>
      <msup>
       <mi>j</mi>
       <mo stretchy='false'>*</mo>
      </msup>
     </msub>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
 <mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='0.1666em'>)</mo>
</mrow>
</math>
 In Figures <a href="#fig_Example__1_1">A.0.7</a> &amp; <a href="#fig_Example__1_1_1">A.0.8</a>, we see that AdaGrad with <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B7;</mi>
 <mo stretchy='false'>=</mo>
 <mn>1</mn>
</mrow>
</math>
 works (I did not try to tune it), however to make vanilla SGD to work I have to tune <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B7;</mi>
 <mo stretchy='false'>=</mo>
 <mn>0.03</mn>
</mrow>
</math>
 otherwise for <math xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow>
 <mi>&#x3B7;</mi>
 <mo stretchy='false'>=</mo>
 <mn>1.0</mn>
</mrow>
</math>
 it did not work. </div>
</div>
</section>
</section>
<section>
<h2 class='section' id='magicparlabel-486'><span class="section_label">A</span> Plots</h2>
<div class='standard' id='magicparlabel-487'><div style='height:1em'></div></div>
<div class='float-figure'>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-495'><img style='width:33%;' src='e_bee9f4ec1a83_SGD_w_1.png' alt='image: e_bee9f4ec1a83_SGD_w_1.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure A.0.1:  <a id="fig_Example_" />batch SGD Example <a href="#exa_The_batch_SGD">33</a> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mn>1</mn>
</msub>
</math>
</span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-503'><img style='width:33%;' src='e_5c556249dc1a_projSGD_w_2.png' alt='image: e_5c556249dc1a_projSGD_w_2.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure A.0.2:  <a id="fig_Example__1" />online SGD with projection Example <a href="#exa_Consider_a__rather">34</a><math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mn>1</mn>
</msub>
</math>
</span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-511'><img style='width:33%;' src='e_8f94341bec1c_SVRG_w_1.png' alt='image: e_8f94341bec1c_SVRG_w_1.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure A.0.3:  <a id="fig_Example__2" />SVRG Example <a href="#exa_The_SVRG_with">42</a> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mn>1</mn>
</msub>
</math>
</span></div>
</div>



<div class='float-figure'><div class='plain_layout' id='magicparlabel-520'><img style='width:33%;' src='e_bee9f4ec1a83_SGD_w_1.png' alt='image: e_bee9f4ec1a83_SGD_w_1.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure A.0.4:  <a id="fig_Example__3" />batch SGD Example <a href="#exa_The_batch_SGD">33</a> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mn>2</mn>
</msub>
</math>
</span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-528'><img style='width:33%;' src='e_5c556249dc1a_projSGD_w_2.png' alt='image: e_5c556249dc1a_projSGD_w_2.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure A.0.5:  <a id="fig_Example__4" />online SGD with projection Example <a href="#exa_Consider_a__rather">34</a> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mn>2</mn>
</msub>
</math>
</span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-536'><img style='width:33%;' src='e_38bbeeab75f6_SVRG_w_2.png' alt='image: e_38bbeeab75f6_SVRG_w_2.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure A.0.6:  <a id="fig_Example__5" />SVRG Example <a href="#exa_The_SVRG_with">42</a> <math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mn>2</mn>
</msub>
</math>
</span></div>
</div>



<div class='float-figure'><div class='plain_layout' id='magicparlabel-545'><img style='width:33%;' src='e_4033c3c4d15e_AdaGrad_w_1.png' alt='image: e_4033c3c4d15e_AdaGrad_w_1.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure A.0.7:  <a id="fig_Example__1_1" />online AdaGrad Example <a href="#exa_The_AdaGrad_with">54</a><math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mn>1</mn>
</msub>
</math>
</span></div>
</div>
<div class='float-figure'><div class='plain_layout' id='magicparlabel-553'><img style='width:33%;' src='e_664f7eaa436a_AdaGrad_w_2.png' alt='image: e_664f7eaa436a_AdaGrad_w_2.png' /><span class='float-caption-Standard float-caption float-caption-standard'>Sub-Figure A.0.8:  <a id="fig_Example__1_1_1" />online AdaGrad Example <a href="#exa_The_AdaGrad_with">54</a><math xmlns='http://www.w3.org/1998/Math/MathML'>
<msub>
 <mi>w</mi>
 <mn>2</mn>
</msub>
</math>
</span></div>
</div>


<div class='plain_layout' id='magicparlabel-558'><span class='float-caption-Standard float-caption float-caption-standard'>Figure A.1:  Simulations of the Examples </span></div>


</div>

</section>
</body>
</html>
